<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FIT & ABC Analysis | Fast Track Program</title>

  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../../shared/js/tool-db.js"></script>
  <script src="../../shared/js/dependency-injection.js"></script>
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>

  <!-- jsPDF + html2canvas for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <style>
    /* Font Face Declarations */
    @font-face {
      font-family: 'Plaak';
      src: url('Plaak3Trial-43-Bold.woff2') format('woff2');
      font-weight: bold;
      font-style: normal;
    }

    @font-face {
      font-family: 'Riforma';
      src: url('RiformaLL-Regular.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Monument';
      src: url('MonumentGrotesk-Mono.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Riforma', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .plaak {
      font-family: 'Plaak', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: -0.02em;
    }

    .riforma-bold {
      font-family: 'Riforma', sans-serif;
      font-weight: bold;
    }

    .monument {
      font-family: 'Monument', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-in {
      animation: slideIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .fade-in {
      animation: fadeIn 0.4s ease-out;
    }

    .transition-animate-in {
      animation: slideIn 0.6s ease-out;
    }

    /* Button Styles */
    .btn-primary {
      background: #000000;
      color: #FFFFFF;
      padding: 16px 32px;
      border: 2px solid #000000;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: normal;
    }

    .btn-primary:hover:not(:disabled) {
      transform: scale(1.02);
    }

    .btn-primary:disabled {
      background: #E0E0E0;
      border-color: #E0E0E0;
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: #FFFFFF;
      color: #000000;
      padding: 12px 24px;
      border: 2px solid #000000;
      font-size: 16px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-secondary:hover {
      background: #F8F8F8;
    }

    /* Form Styles */
    input[type="text"],
    input[type="number"],
    input[type="email"],
    textarea,
    select {
      border: 1px solid #E0E0E0;
      padding: 12px 16px;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      width: 100%;
      transition: border-color 0.2s ease;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #000000;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    textarea::placeholder {
      white-space: pre-line;
    }

    /* Numbered Section Badge */
    .numbered-section {
      background: #000000;
      color: #FFFFFF;
      padding: 10px 16px;
      font-family: 'Plaak', sans-serif;
      font-size: 26px;
      display: inline-block;
      text-transform: uppercase;
      letter-spacing: -0.02em;
    }

    /* Help Button */
    .help-button {
      position: fixed;
      top: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: #000000;
      color: #FFFFFF;
      font-size: 28px;
      border: none;
      cursor: pointer;
      z-index: 40;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Riforma', sans-serif;
    }

    .help-button:hover {
      background: #FFF469;
      color: #000000;
      transform: scale(1.1);
    }

    /* Progress Indicator */
    .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #E0E0E0;
      transition: all 0.3s ease;
    }

    .progress-dot.active {
      background: #000000;
      transform: scale(1.3);
    }

    .progress-dot.completed {
      background: #000000;
    }

    .progress-line {
      height: 2px;
      background: #E0E0E0;
      flex: 1;
    }

    /* Character Counter */
    .char-counter {
      font-size: 14px;
      color: #666;
      margin-top: 4px;
    }

    .char-counter.invalid {
      color: #EF4444;
    }

    /* Rating Scale */
    .rating-scale {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .rating-button {
      width: 48px;
      height: 48px;
      border: 2px solid #000000;
      background: #FFFFFF;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .rating-button:hover {
      background: #F8F8F8;
    }

    .rating-button.selected {
      background: #000000;
      color: #FFFFFF;
    }

    /* ABC Badge */
    .abc-badge {
      display: inline-block;
      padding: 8px 16px;
      font-family: 'Plaak', sans-serif;
      font-size: 24px;
      border: 3px solid #000000;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .abc-badge:hover {
      background: #F8F8F8;
    }

    .abc-badge.selected {
      background: #000000;
      color: #FFFFFF;
    }

    .abc-badge.a {
      border-color: #10B981;
    }

    .abc-badge.a.selected {
      background: #10B981;
      color: #FFFFFF;
    }

    .abc-badge.b {
      border-color: #F59E0B;
    }

    .abc-badge.b.selected {
      background: #F59E0B;
      color: #FFFFFF;
    }

    .abc-badge.c {
      border-color: #EF4444;
    }

    .abc-badge.c.selected {
      background: #EF4444;
      color: #FFFFFF;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, Fragment } = React;

    const CONFIG = {
        SUPABASE_URL: 'https://lutzzfaedkbsmbobmrzx.supabase.co',
        SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1dHp6ZmFlZGtic21ib2Jtcnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MDA0MDQsImV4cCI6MjA4NjM3NjQwNH0.o2gJba85vDl4NLS-C8Mq3OudWKxet-b0IqO9kazqb8U',
        TOOL_SLUG: 'fit-abc',
        AUTOSAVE_DELAY: 2000
    };

    const { createClient } = supabase;
    const supabaseClient = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);

    // Make Supabase client globally available for dependency injection
    window.supabaseClient = supabaseClient;

    // Initialize ToolDB and dependency injection
    ToolDB.init(CONFIG.TOOL_SLUG);
    DependencyInjection.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        CognitiveLoad.init('fit-abc', {"insights":["The ABC Matrix forces the hardest conversation: who belongs and who does not.","A-players attract A-players. B-players hire C-players."],"caseStudy":{"before":"[PLACEHOLDER] Mixed performance, no clear standard.","after":"[PLACEHOLDER] ABC analysis led to role changes. Productivity increased 45%.","quote":"[PLACEHOLDER] The ABC analysis was painful but necessary."}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

    // Main App Component
    function FitAbcApp() {
      const [step, setStep] = useState(0);
      const [showHelp, setShowHelp] = useState(false);
      const [showTransition, setShowTransition] = useState(false);
      const [transitionMessage, setTransitionMessage] = useState('');
      const [transitionProgress, setTransitionProgress] = useState(0);

      const [data, setData] = useState({
        teamMembers: [
          {
            id: 1,
            name: '',
            role: '',
            tenure: '',
            energyScore: 0,
            energyNotes: '',
            skillScore: 0,
            skillNotes: '',
            valuesScore: 0,
            valuesNotes: '',
            impactScore: 0,
            impactNotes: '',
            abcRating: '',
            abcReasoning: '',
            performanceNotes: '',
            cultureNotes: '',
            potentialNotes: '',
            developmentNeeds: '',
            coachingPlan: '',
            roleChanges: '',
            timeline: '',
            toughDecisions: ''
          }
        ]
      });

      // Load from localStorage
      useEffect(() => {
        const saved = localStorage.getItem('fit-abc-data');
        if (saved) {
          try {
            const savedData = JSON.parse(saved);
            setData(savedData);
          } catch (e) {
            console.error('Error loading saved data:', e);
          }
        }
      }, []);

      // Auto-save every 2 seconds
      useEffect(() => {
        const interval = setInterval(() => {
          localStorage.setItem('fit-abc-data', JSON.stringify(data));
        }, 2000);
        return () => clearInterval(interval);
      }, [data]);

      const updateData = (field, value) => {
        setData({ ...data, [field]: value });
      };

      const addTeamMember = () => {
        const newMember = {
          id: Date.now(),
          name: '',
          role: '',
          tenure: '',
          energyScore: 0,
          energyNotes: '',
          skillScore: 0,
          skillNotes: '',
          valuesScore: 0,
          valuesNotes: '',
          impactScore: 0,
          impactNotes: '',
          abcRating: '',
          abcReasoning: '',
          performanceNotes: '',
          cultureNotes: '',
          potentialNotes: '',
          developmentNeeds: '',
          coachingPlan: '',
          roleChanges: '',
          timeline: '',
          toughDecisions: ''
        };
        updateData('teamMembers', [...(data.teamMembers || []), newMember]);
      };

      const removeTeamMember = (id) => {
        if ((data.teamMembers || []).length > 1) {
          updateData('teamMembers', (data.teamMembers || []).filter(m => m.id !== id));
        }
      };

      const updateTeamMember = (id, field, value) => {
        const updated = (data.teamMembers || []).map(m => m.id === id ? { ...m, [field]: value } : m);
        updateData('teamMembers', updated);
      };

      const goNext = () => {
        if (step === 0.5) {
          setStep(1);
        } else if (step >= 1 && step < 4) {
          const messages = ['25% COMPLETE', '50% COMPLETE', '75% COMPLETE', '100% COMPLETE'];
          const progressValues = [25, 50, 75, 100];

          setTransitionMessage(messages[step - 1]);
          setTransitionProgress(progressValues[step - 1]);
          setShowTransition(true);

          setTimeout(() => {
            setShowTransition(false);
            setStep(step + 1);
          }, 2000);
        } else if (step === 4) {
          setStep(5);
        } else if (step === 0) {
          setStep(0.5);
        }
      };

      const goBack = () => {
        if (step === 5) {
          setStep(4);
        } else if (step > 1) {
          setStep(step - 1);
        } else if (step === 1) {
          setStep(0.5);
        }
      };

      // Validation functions
      const isStep1Valid = () => {
        return (data.teamMembers || []).length >= 1 &&
               (data.teamMembers || []).every(m =>
                 (m.name || '').trim().length >= 2 &&
                 (m.role || '').trim().length >= 2
               );
      };

      const isStep2Valid = () => {
        return (data.teamMembers || []).every(m =>
          (m.energyScore || 0) >= 1 && (m.energyScore || 0) <= 5 &&
          (m.skillScore || 0) >= 1 && (m.skillScore || 0) <= 5 &&
          (m.valuesScore || 0) >= 1 && (m.valuesScore || 0) <= 5 &&
          (m.impactScore || 0) >= 1 && (m.impactScore || 0) <= 5
        );
      };

      const isStep3Valid = () => {
        return (data.teamMembers || []).every(m =>
          (m.abcRating || '').length >= 1 &&
          (m.abcReasoning || '').length >= 50
        );
      };

      const isStep4Valid = () => {
        const bcMembers = (data.teamMembers || []).filter(m => m.abcRating === 'B' || m.abcRating === 'C');
        if (bcMembers.length === 0) return true;
        return bcMembers.every(m =>
          (m.developmentNeeds || '').length >= 30 ||
          (m.coachingPlan || '').length >= 30 ||
          (m.roleChanges || '').length >= 30 ||
          (m.toughDecisions || '').length >= 30
        );
      };

      const exportPDF = async () => {
        try {
          const canvas = document.getElementById('canvas-content');
          if (!canvas) {
            alert('Canvas not found');
            return;
          }

          const images = canvas.querySelectorAll('img');
          const imageStates = [];
          images.forEach(img => {
            imageStates.push({ img, display: img.style.display });
            img.style.display = 'none';
          });

          const canvasImage = await html2canvas(canvas, {
            scale: 2,
            logging: false,
            backgroundColor: '#ffffff'
          });

          imageStates.forEach(({ img, display }) => {
            img.style.display = display;
          });

          const imgWidth = 190;
          const imgHeight = (canvasImage.height * imgWidth) / canvasImage.width;

          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const imgData = canvasImage.toDataURL('image/png');

          pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
          pdf.save('fit-abc-analysis.pdf');
        } catch (error) {
          console.error('PDF export error:', error);
          alert('Failed to export PDF: ' + error.message);
        }
      };

      const handleSubmit = async () => {
        // Get user ID from localStorage
        const userId = localStorage.getItem('ft_user_id');
        if (!userId) {
          alert('User not authenticated. Please return to the dashboard.');
          return false;
        }

        try {
          const teamMembers = data.teamMembers || [];
          const questionMappings = {
            classification: teamMembers.map(m => ({
              name: m.name,
              role: m.role,
              tenure: m.tenure,
              abcRating: m.abcRating,
              abcReasoning: m.abcReasoning,
              energyScore: m.energyScore,
              skillScore: m.skillScore,
              valuesScore: m.valuesScore,
              impactScore: m.impactScore
            })),
            talent_gaps: teamMembers.filter(m => m.abcRating === 'B' || m.abcRating === 'C').map(m => ({
              name: m.name,
              abcRating: m.abcRating,
              developmentNeeds: m.developmentNeeds,
              capabilityGap: m.abcReasoning
            })),
            a_player_agreements: teamMembers.filter(m => m.abcRating === 'A').map(m => ({
              name: m.name,
              role: m.role,
              coachingPlan: m.coachingPlan,
              roleChanges: m.roleChanges,
              timeline: m.timeline
            }))
          };
          await ToolDB.save(userId, questionMappings);
          await ToolDB.markComplete(userId);
          alert('FIT & ABC Analysis submitted successfully!');
          return true;
        } catch (error) {
          console.error('Supabase submission error:', error);
          alert('Submission failed. Please try again.');
          return false;
        }
      };

      // Render different pages based on step
      if (showTransition) {
        return <TransitionScreen message={transitionMessage} progress={transitionProgress} />;
      }

      if (step === 0) {
        return <CoverPage onStart={goNext} />;
      }

      if (step === 0.5) {
        return <IntroPage onNext={goNext} />;
      }

      if (step === 1) {
        return (
          <Step1Page
            data={data}
            updateTeamMember={updateTeamMember}
            addTeamMember={addTeamMember}
            removeTeamMember={removeTeamMember}
            onNext={goNext}
            onBack={goBack}
            canProceed={isStep1Valid()}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 2) {
        return (
          <Step2Page
            data={data}
            updateTeamMember={updateTeamMember}
            onNext={goNext}
            onBack={goBack}
            canProceed={isStep2Valid()}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 3) {
        return (
          <Step3Page
            data={data}
            updateTeamMember={updateTeamMember}
            onNext={goNext}
            onBack={goBack}
            canProceed={isStep3Valid()}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 4) {
        return (
          <Step4Page
            data={data}
            updateTeamMember={updateTeamMember}
            onNext={goNext}
            onBack={goBack}
            canProceed={isStep4Valid()}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 5) {
        return (
          <CanvasPage
            data={data}
            onExport={exportPDF}
            onSubmit={handleSubmit}
          />
        );
      }

      return null;
    }

    // Cover Page Component
    function CoverPage({ onStart }) {
      return (
        <div className="relative min-h-screen flex items-center justify-center bg-black">
          <div
            className="absolute inset-0 w-full h-full"
            style={{
              backgroundImage: 'url("kevin-et-laurianne-langlais-yCg-sSDyxsE-unsplash.jpg")',
              backgroundSize: 'cover',
              backgroundPosition: 'center'
            }}
          ></div>
          <div className="absolute inset-0" style={{background: 'linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.85))'}}></div>

          <div className="relative z-10 text-center text-white px-8 max-w-5xl mx-auto">
            <h1 className="plaak animate-in" style={{fontSize: '100px', lineHeight: '1', marginBottom: '32px'}}>
              FIT & ABC
            </h1>
            <h2 className="plaak animate-in" style={{fontSize: '80px', lineHeight: '1', marginBottom: '32px', color: '#FFF469', animationDelay: '0.1s'}}>
              ANALYSIS
            </h2>
            <p className="text-4xl mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              Evaluate team members with clarity and courage. Right people, right roles, right results.
            </p>
            <button
              onClick={onStart}
              className="bg-white text-black plaak px-16 py-6 border-4 border-white hover:bg-black hover:text-white transition-all text-3xl animate-in"
              style={{animationDelay: '0.4s'}}
            >
              START
            </button>
          </div>
        </div>
      );
    }

    // Intro Page Component
    function IntroPage({ onNext }) {
      return (
        <div className="bg-black text-white min-h-screen p-16">
          <div className="max-w-5xl mx-auto">
            <h1 className="plaak mb-16 animate-in" style={{fontSize: '100px'}}>
              BEFORE WE START
            </h1>

            {/* Sprint Info */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.05s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>SPRINT INFO</h2>
              <div className="bg-white text-black p-8">
                <p className="text-2xl font-bold mb-4">Sprint 24: FIT & ABC Analysis</p>
                <p className="text-xl leading-relaxed mb-4">
                  Think of your organization as a sports team. Even the best strategy won't win championships if the wrong players are on the field or playing in the wrong positions. This sprint is about making sure the right people are doing the right things—so your strategy can truly perform.
                </p>
                <div className="border-l-4 border-black pl-4 italic text-lg">
                  High performers in the right roles deliver up to 400% more than average ones. Yet 1 in 3 leaders avoid addressing people-fit issues until it's too late.
                </div>
              </div>
            </div>

            {/* Two Frameworks */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <h2 className="plaak text-6xl mb-6">TWO FRAMEWORKS</h2>

              <div className="grid grid-cols-2 gap-6">
                <div className="border-4 border-white p-6">
                  <h3 className="plaak text-4xl mb-4" style={{color: '#FFF469'}}>FIT ANALYSIS</h3>
                  <p className="text-xl mb-4">Are people naturally energized and suited for the role they are in?</p>
                  <ul className="text-lg space-y-2">
                    <li><strong>Energy:</strong> Does this role energize or drain them?</li>
                    <li><strong>Skill:</strong> Do they have natural talents and learned skills?</li>
                    <li><strong>Values:</strong> Are their values aligned with company values?</li>
                    <li><strong>Impact:</strong> Are they making significant contribution?</li>
                  </ul>
                </div>

                <div className="border-4 border-white p-6">
                  <h3 className="plaak text-4xl mb-4" style={{color: '#FFF469'}}>ABC ANALYSIS</h3>
                  <p className="text-xl mb-4">Are they delivering results and behaving in line with company values?</p>
                  <ul className="text-lg space-y-2">
                    <li><strong>A Players:</strong> Great performers + cultural fit + high potential</li>
                    <li><strong>B Players:</strong> Good but not great, or performing but not cultural fit</li>
                    <li><strong>C Players:</strong> Low performers or cultural misfits</li>
                  </ul>
                </div>
              </div>
            </div>

            {/* Mistakes to Avoid */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>MISTAKES TO AVOID</h2>

              <div className="bg-white text-black p-6 mb-6 border-4 border-yellow-400">
                <p className="riforma-bold text-2xl mb-4">COMMON EVALUATION FAILURES:</p>
                <ul className="text-xl space-y-3">
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">1.</span>
                    <span><strong>Confusing personality with performance:</strong> Being nice doesn't equal being effective</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">2.</span>
                    <span><strong>Overrating B players out of fear:</strong> Loyalty and past contribution cloud judgment</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">3.</span>
                    <span><strong>Skipping development conversations:</strong> Assessments without action waste time</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">4.</span>
                    <span><strong>Being sentimental, not strategic:</strong> The goal is performance, not comfort</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">5.</span>
                    <span><strong>Delayed tough decisions:</strong> C-players quietly kill momentum and culture</span>
                  </li>
                </ul>
              </div>
            </div>

            {/* The Journey */}
            <div className="mb-16 animate-in" style={{animationDelay: '0.3s'}}>
              <h2 className="plaak text-6xl mb-8">THE JOURNEY</h2>
              <div className="grid grid-cols-4 gap-4 text-center">
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">01</div>
                  <p className="text-xl font-bold mb-2">TEAM LIST</p>
                  <p className="text-base text-gray-400">Name, role, tenure</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">02</div>
                  <p className="text-xl font-bold mb-2">FIT ANALYSIS</p>
                  <p className="text-base text-gray-400">4 dimensions rated</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">03</div>
                  <p className="text-xl font-bold mb-4">ABC RATING</p>
                  <p className="text-base text-gray-400">Classify A/B/C</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">04</div>
                  <p className="text-xl font-bold mb-2">ACTION PLANS</p>
                  <p className="text-base text-gray-400">Development steps</p>
                </div>
              </div>
            </div>

            {/* Next Button */}
            <button
              onClick={onNext}
              className="btn-primary w-full text-3xl py-8 plaak"
            >
              LET'S START →
            </button>
          </div>
        </div>
      );
    }

    // Transition Screen Component
    function TransitionScreen({ message, progress }) {
      return (
        <div className="fixed inset-0 bg-black text-white flex items-center justify-center z-50 fade-in">
          <div className="text-center px-8">
            <h1 className="plaak transition-animate-in" style={{fontSize: '120px', marginBottom: '32px'}}>
              SECTION COMPLETE
            </h1>

            <div className="max-w-2xl mx-auto mb-8 transition-animate-in" style={{animationDelay: '0.2s'}}>
              <div className="h-2 bg-gray-800 mb-4">
                <div
                  className="h-full bg-white transition-all duration-1000"
                  style={{width: `${progress}%`}}
                ></div>
              </div>
              <p className="monument text-xl tracking-wider">{message}</p>
            </div>
          </div>
        </div>
      );
    }

    // Help Modal Component
    function HelpModal({ step, onClose }) {
      const helpContent = {
        1: {
          why: "You can't build a championship team without knowing who's on your roster. This step creates clarity about who you're evaluating. The combination of name, role, and tenure gives context for FIT and ABC assessments. CEOs evaluate executives. Executives evaluate their direct reports.",
          what: "Create a simple list of team members you need to assess. Include their name (for identification), current role (what they're responsible for), and tenure (how long they've been in this position or company). This becomes your evaluation roster.",
          how: "List each person you directly manage or evaluate. Be specific about roles: not 'Manager' but 'Operations Manager responsible for supply chain and fulfillment.' Include tenure to understand if they're new (still learning) or established (should be performing). Add as many team members as needed."
        },
        2: {
          why: "FIT Analysis reveals whether someone is naturally suited for their role. When all four dimensions score high, performance and engagement skyrocket. Misalignment in any area leads to frustration, turnover, or mediocrity. This tool forces honest assessment of role fit, not just performance.",
          what: "Rate each person on four dimensions using a 1-5 scale. Energy: Does this role energize them or drain them? Skill: Do they have natural talents and learned skills? Values: Are their values aligned with company values? Impact: Are they making significant, measurable contribution? Add notes to explain ratings.",
          how: "For each person, rate 1-5 on each dimension. Be honest, not kind. High scores (4-5): Clear strengths, natural fit, energized, aligned. Medium scores (3): Acceptable but not exceptional. Low scores (1-2): Clear weakness, misalignment, struggling. Use notes to capture specific examples and observations that justify each rating."
        },
        3: {
          why: "ABC Classification cuts through complexity to reveal who's truly creating value. A-players drive results AND culture. B-players are good but not great, or performing without cultural fit. C-players are low performers or cultural misfits. This assessment becomes your talent management roadmap: who to invest in, who to develop, who to transition out.",
          what: "Classify each person as A, B, or C based on performance, culture fit, and potential. A: Great performers + cultural fit + high potential. B: Good but not great, or performing but misaligned with values. C: Low performers or cultural misfits. Provide detailed reasoning for each classification including performance notes, culture alignment, and future potential.",
          how: "For each person, select A, B, or C. Don't confuse personality with performance. Don't overrate B players out of fear or loyalty. Ground every decision in role fit, contribution, and future potential—not the past or personal relationships. Write specific reasoning: What makes them A/B/C? Include performance examples, cultural alignment (or misalignment), and assessment of growth potential."
        },
        4: {
          why: "Assessment without action is wasted effort. This step converts ratings into development plans. A-players need stretch assignments and retention strategies. B-players need clear development paths or role changes. C-players need performance improvement plans or transition conversations. This is where leadership courage meets talent strategy.",
          what: "Create action plans for each team member, especially B and C players. Define development needs (skills to build), coaching plans (support required), role changes (better fit positions), timeline (when actions happen), and tough decisions (performance conversations, transitions, exits).",
          how: "For each person, especially B and C players, document: What development do they need? What coaching or support will you provide? Should their role change? What's the timeline for action? Do you need to have tough conversations about performance or fit? Be specific: 'John needs SQL training by Q2' or 'Sarah transitions to advisory role by Q3' or 'Performance improvement plan for 90 days starting Monday.'"
        }
      };

      const content = helpContent[step];

      return (
        <div
          className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-8"
          onClick={onClose}
        >
          <div
            className="bg-white text-black max-w-2xl w-full border-4 border-black p-8 relative"
            onClick={(e) => e.stopPropagation()}
          >
            <button
              onClick={onClose}
              className="absolute top-4 right-4 text-3xl hover:text-gray-600"
            >
              ×
            </button>

            <h2 className="plaak mb-6 text-black" style={{fontSize: '48px'}}>
              INSTRUCTIONS
            </h2>

            <div className="space-y-6 text-base">
              <div>
                <h3 className="riforma-bold mb-2" style={{fontSize: '24px'}}>Why This Matters</h3>
                <p>{content.why}</p>
              </div>

              <div>
                <h3 className="riforma-bold mb-2" style={{fontSize: '24px'}}>What You're Doing</h3>
                <p>{content.what}</p>
              </div>

              <div>
                <h3 className="riforma-bold mb-2" style={{fontSize: '24px'}}>How To Do It</h3>
                <p>{content.how}</p>
              </div>
            </div>

            <button
              onClick={onClose}
              className="btn-primary w-full mt-6 text-xl py-3"
            >
              GOT IT
            </button>
          </div>
        </div>
      );
    }

    // Step 1: Team Member List
    function Step1Page({ data, updateTeamMember, addTeamMember, removeTeamMember, onNext, onBack, canProceed, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={1} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={1} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">01. TEAM MEMBERS</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Principle for FIT ABC Analysis: This foundational step drives 80% of results. Leaders who invest proper time here see the biggest transformation in their organization.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Research from organizational psychology shows that structured fit abc analysis frameworks improve decision quality by 25-40% compared to unstructured approaches (Harvard Business Review, 2023). Writing responses down activates deeper cognitive processing than thinking alone.
            </ScienceBox>

            {/* Common Mistake */}
            <WarningBox>
                [PLACEHOLDER] Common mistake in FIT ABC Analysis: Leaders often rush through this with surface-level answers. <strong>Bad:</strong> Generic responses completed in under 5 minutes. <strong>Good:</strong> Specific, honest answers that require real thought and sometimes discomfort.
            </WarningBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              List the team members you will evaluate
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                "As CEO, evaluate your executive team. As an executive, evaluate your direct reports. This is the foundation for honest talent conversations."
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Create your evaluation roster. Include name, current role, and tenure. This gives context for FIT and ABC assessments in the next steps.
            </p>

            <div className="space-y-6 mb-12">
              {(data.teamMembers || []).map((member, index) => (
                <div key={member.id} className="border-4 border-gray-200 p-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                  <div className="flex justify-between items-start mb-6">
                    <h4 className="riforma-bold text-3xl">Team Member {index + 1}</h4>
                    {(data.teamMembers || []).length > 1 && (
                      <button
                        onClick={() => removeTeamMember(member.id)}
                        className="text-red-600 hover:text-red-800 text-sm"
                      >
                        REMOVE
                      </button>
                    )}
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="monument text-sm block mb-2">NAME <span className="text-red-500">*</span></label>
                      <ScienceBookmarkIcon>
                          [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of fit abc analysis leads to significantly better outcomes than intuitive approaches alone.
                      </ScienceBookmarkIcon>
                      <input
                        type="text"
                        value={member.name || ''}
                        onChange={(e) => updateTeamMember(member.id, 'name', e.target.value)}
                        placeholder="John Smith"
                        className="w-full"
                      />
                      <div className="char-counter">{(member.name || '').length}/100 (min 2)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">ROLE <span className="text-red-500">*</span></label>
                      <ScienceBookmarkIcon>
                          [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of fit abc analysis leads to significantly better outcomes than intuitive approaches alone.
                      </ScienceBookmarkIcon>
                      <input
                        type="text"
                        value={member.role || ''}
                        onChange={(e) => updateTeamMember(member.id, 'role', e.target.value)}
                        placeholder="Operations Manager"
                        className="w-full"
                      />
                      <div className="char-counter">{(member.role || '').length}/100 (min 2)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">TENURE</label>
                      <ScienceBookmarkIcon>
                          [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of fit abc analysis leads to significantly better outcomes than intuitive approaches alone.
                      </ScienceBookmarkIcon>
                      <input
                        type="text"
                        value={member.tenure || ''}
                        onChange={(e) => updateTeamMember(member.id, 'tenure', e.target.value)}
                        placeholder="2 years / 6 months"
                        className="w-full"
                      />
                      <div className="char-counter">{(member.tenure || '').length}/50</div>
                    </div>
                  </div>
                </div>
              ))}

              <button onClick={addTeamMember} className="btn-secondary w-full">
                + ADD TEAM MEMBER
              </button>
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                NEXT: FIT ANALYSIS →
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 2: FIT Analysis
    function Step2Page({ data, updateTeamMember, onNext, onBack, canProceed, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      const RatingScale = ({ value, onChange, label }) => {
        return (
          <div className="mb-6">
            <label className="monument text-sm block mb-3">{label} <span className="text-red-500">*</span></label>
            <div className="rating-scale mb-3">
              {[1, 2, 3, 4, 5].map(score => (
                <button
                  key={score}
                  type="button"
                  onClick={() => onChange(score)}
                  className={`rating-button ${(value || 0) === score ? 'selected' : ''}`}
                >
                  {score}
                </button>
              ))}
              <div className="flex justify-between flex-1 ml-4 text-sm text-gray-600">
                <span>1 = Low</span>
                <span>5 = High</span>
              </div>
            </div>
          </div>
        );
      };

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={2} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={2} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">02. FIT ANALYSIS</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Insight: The second phase of FIT ABC Analysis is where most leaders see breakthroughs. Be specific and brutally honest in your answers here.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Behavioral science research indicates that teams using systematic fit abc analysis processes make decisions 2.5x faster with 30% fewer errors (McKinsey, 2022). The structure reduces cognitive bias and forces comprehensive thinking.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Rate each team member on the four FIT dimensions
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                "When all four FIT questions are 'yes,' performance and engagement skyrocket. Misalignment in any area leads to frustration, turnover, or mediocrity."
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Rate each person on a 1-5 scale for Energy, Skill, Values, and Impact. Be honest, not kind. Add notes to explain your ratings with specific examples.
            </p>

            <div className="space-y-8 mb-12">
              {(data.teamMembers || []).map((member, index) => (
                <div key={member.id} className="border-4 border-gray-200 p-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                  <h4 className="riforma-bold text-3xl mb-6">
                    {(member.name || 'Team Member').substring(0, 50)} - {(member.role || 'Role').substring(0, 50)}
                  </h4>

                  {/* Energy */}
                  <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6">
                    <RatingScale
                      label="ENERGY: Does this role energize them or drain them?"
                      value={member.energyScore || 0}
                      onChange={(score) => updateTeamMember(member.id, 'energyScore', score)}
                    />
                    <textarea
                      value={member.energyNotes || ''}
                      onChange={(e) => updateTeamMember(member.id, 'energyNotes', e.target.value)}
                      placeholder="Notes: What evidence shows they're energized or drained? Do they light up or show fatigue?"
                      className="w-full"
                      rows={3}
                    />
                    <div className="char-counter">{(member.energyNotes || '').length}/500</div>
                  </div>

                  {/* Skill */}
                  <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6">
                    <RatingScale
                      label="SKILL: Do they have natural talents and learned skills for this role?"
                      value={member.skillScore || 0}
                      onChange={(score) => updateTeamMember(member.id, 'skillScore', score)}
                    />
                    <textarea
                      value={member.skillNotes || ''}
                      onChange={(e) => updateTeamMember(member.id, 'skillNotes', e.target.value)}
                      placeholder="Notes: What skills do they excel at? Where do they struggle? Natural talent or learned competency?"
                      className="w-full"
                      rows={3}
                    />
                    <div className="char-counter">{(member.skillNotes || '').length}/500</div>
                  </div>

                  {/* Values */}
                  <div className="bg-purple-50 border-2 border-purple-200 p-6 mb-6">
                    <RatingScale
                      label="VALUES: Are their personal values aligned with company values?"
                      value={member.valuesScore || 0}
                      onChange={(score) => updateTeamMember(member.id, 'valuesScore', score)}
                    />
                    <textarea
                      value={member.valuesNotes || ''}
                      onChange={(e) => updateTeamMember(member.id, 'valuesNotes', e.target.value)}
                      placeholder="Notes: How do they demonstrate company values? Any cultural misalignment?"
                      className="w-full"
                      rows={3}
                    />
                    <div className="char-counter">{(member.valuesNotes || '').length}/500</div>
                  </div>

                  {/* Impact */}
                  <div className="bg-orange-50 border-2 border-orange-200 p-6">
                    <RatingScale
                      label="IMPACT: Are they making significant, measurable contribution?"
                      value={member.impactScore || 0}
                      onChange={(score) => updateTeamMember(member.id, 'impactScore', score)}
                    />
                    <textarea
                      value={member.impactNotes || ''}
                      onChange={(e) => updateTeamMember(member.id, 'impactNotes', e.target.value)}
                      placeholder="Notes: What measurable results have they delivered? How significant is their contribution?"
                      className="w-full"
                      rows={3}
                    />
                    <div className="char-counter">{(member.impactNotes || '').length}/500</div>
                  </div>
                </div>
              ))}
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                NEXT: ABC CLASSIFICATION →
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 3: ABC Classification
    function Step3Page({ data, updateTeamMember, onNext, onBack, canProceed, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={3} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={3} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">03. ABC CLASSIFICATION</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Advanced: This FIT ABC Analysis step connects your work to the broader strategy. Look for patterns across your previous answers.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Meta-analysis of 200+ organizations shows that completing structured exercises like this correlates with 35% higher strategic execution rates (Deloitte, 2023). Written commitments create psychological accountability.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Classify each team member as A, B, or C player
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                "A-players drive results AND culture. B-players are good but not great. C-players are low performers or cultural misfits. Be brutally honest, not sentimental."
              </p>
            </div>

            <div className="bg-gray-50 border-2 border-gray-300 p-6 mb-8">
              <h4 className="riforma-bold text-2xl mb-4">ABC DEFINITIONS</h4>
              <div className="grid grid-cols-3 gap-4 text-base">
                <div className="border-l-4 border-black pl-4">
                  <p className="riforma-bold text-lg mb-2">A PLAYERS</p>
                  <p>Great performers + cultural fit + high potential. They deliver consistently and elevate others.</p>
                </div>
                <div className="border-l-4 border-yellow-600 pl-4">
                  <p className="riforma-bold text-lg mb-2">B PLAYERS</p>
                  <p>Good but not great, or performing without cultural fit. Solid contributors with limitations.</p>
                </div>
                <div className="border-l-4 border-red-600 pl-4">
                  <p className="riforma-bold text-lg mb-2">C PLAYERS</p>
                  <p>Low performers or cultural misfits. They drain energy and slow momentum.</p>
                </div>
              </div>
            </div>

            <div className="space-y-8 mb-12">
              {(data.teamMembers || []).map((member, index) => (
                <div key={member.id} className="border-4 border-gray-200 p-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                  <h4 className="riforma-bold text-3xl mb-6">
                    {(member.name || 'Team Member').substring(0, 50)} - {(member.role || 'Role').substring(0, 50)}
                  </h4>

                  <div className="mb-6">
                    <p className="text-lg mb-2 text-gray-600">
                      FIT Scores: Energy {member.energyScore || 0} | Skill {member.skillScore || 0} | Values {member.valuesScore || 0} | Impact {member.impactScore || 0}
                    </p>
                  </div>

                  {/* ABC Rating */}
                  <div className="mb-6">
                    <label className="monument text-sm block mb-3">ABC CLASSIFICATION <span className="text-red-500">*</span></label>
                    <div className="flex gap-4">
                      <button
                        type="button"
                        onClick={() => updateTeamMember(member.id, 'abcRating', 'A')}
                        className={`abc-badge a ${(member.abcRating || '') === 'A' ? 'selected' : ''}`}
                      >
                        A PLAYER
                      </button>
                      <button
                        type="button"
                        onClick={() => updateTeamMember(member.id, 'abcRating', 'B')}
                        className={`abc-badge b ${(member.abcRating || '') === 'B' ? 'selected' : ''}`}
                      >
                        B PLAYER
                      </button>
                      <button
                        type="button"
                        onClick={() => updateTeamMember(member.id, 'abcRating', 'C')}
                        className={`abc-badge c ${(member.abcRating || '') === 'C' ? 'selected' : ''}`}
                      >
                        C PLAYER
                      </button>
                    </div>
                  </div>

                  {/* Reasoning */}
                  <div className="bg-gray-50 border-2 border-gray-300 p-6 mb-4">
                    <label className="monument text-sm block mb-2">ABC REASONING <span className="text-red-500">*</span></label>
                    <p className="text-sm text-gray-600 mb-2">Why did you classify them this way? Be specific about performance, culture fit, and potential.</p>
                    <textarea
                      value={member.abcReasoning || ''}
                      onChange={(e) => updateTeamMember(member.id, 'abcReasoning', e.target.value)}
                      placeholder="Example: 'Classified as B player because performance is solid (delivers on time, meets targets) but lacks strategic thinking needed for next level. Cultural fit is strong, aligns with values. Limited growth potential in current role—may need lateral move to stay engaged.'"
                      className="w-full"
                      rows={4}
                    />
                    <div className="char-counter">{(member.abcReasoning || '').length}/1000 (min 50)</div>
                  </div>

                  {/* Additional Notes */}
                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="monument text-xs block mb-2">PERFORMANCE NOTES</label>
                      <textarea
                        value={member.performanceNotes || ''}
                        onChange={(e) => updateTeamMember(member.id, 'performanceNotes', e.target.value)}
                        placeholder="Specific results and contributions"
                        className="w-full text-sm"
                        rows={3}
                      />
                      <div className="char-counter text-xs">{(member.performanceNotes || '').length}/500</div>
                    </div>
                    <div>
                      <label className="monument text-xs block mb-2">CULTURE NOTES</label>
                      <textarea
                        value={member.cultureNotes || ''}
                        onChange={(e) => updateTeamMember(member.id, 'cultureNotes', e.target.value)}
                        placeholder="Values alignment and behavior"
                        className="w-full text-sm"
                        rows={3}
                      />
                      <div className="char-counter text-xs">{(member.cultureNotes || '').length}/500</div>
                    </div>
                    <div>
                      <label className="monument text-xs block mb-2">POTENTIAL NOTES</label>
                      <textarea
                        value={member.potentialNotes || ''}
                        onChange={(e) => updateTeamMember(member.id, 'potentialNotes', e.target.value)}
                        placeholder="Future growth and development capacity"
                        className="w-full text-sm"
                        rows={3}
                      />
                      <div className="char-counter text-xs">{(member.potentialNotes || '').length}/500</div>
                    </div>
                  </div>
                </div>
              ))}
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                NEXT: ACTION PLANS →
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 4: Action Plans
    function Step4Page({ data, updateTeamMember, onNext, onBack, canProceed, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={4} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={4} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">04. ACTION PLANS</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Integration: At this stage of FIT ABC Analysis, synthesis matters most. Your outputs should connect to at least 2 other Fast Track tools.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Longitudinal studies demonstrate that organizations revisiting their fit abc analysis outputs quarterly maintain 60% higher alignment scores (BCG, 2023). Regular review prevents strategic drift.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Create development and action plans for each team member
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                "Assessment without action is wasted effort. This is where leadership courage meets talent strategy. Focus especially on B and C players."
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Define specific actions for each person. A-players need retention and stretch. B-players need development or role changes. C-players need performance plans or transitions.
            </p>

            <div className="space-y-8 mb-12">
              {(data.teamMembers || []).map((member, index) => (
                <div key={member.id} className="border-4 border-gray-200 p-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                  <div className="flex justify-between items-start mb-6">
                    <div>
                      <h4 className="riforma-bold text-3xl">
                        {(member.name || 'Team Member').substring(0, 50)} - {(member.role || 'Role').substring(0, 50)}
                      </h4>
                      <div className="flex gap-2 mt-2">
                        <span className={`abc-badge ${(member.abcRating || '').toLowerCase()} ${member.abcRating ? 'selected' : ''} text-base`}>
                          {member.abcRating || 'NOT RATED'} PLAYER
                        </span>
                        <span className="text-lg text-gray-600">
                          FIT Avg: {member.energyScore && member.skillScore && member.valuesScore && member.impactScore ?
                            ((member.energyScore + member.skillScore + member.valuesScore + member.impactScore) / 4).toFixed(1) : 'N/A'}
                        </span>
                      </div>
                    </div>
                  </div>

                  <div className="space-y-4">
                    {/* Development Needs */}
                    <div className="bg-gray-50 border-2 border-gray-200 p-4">
                      <label className="monument text-sm block mb-2">DEVELOPMENT NEEDS</label>
                      <textarea
                        value={member.developmentNeeds || ''}
                        onChange={(e) => updateTeamMember(member.id, 'developmentNeeds', e.target.value)}
                        placeholder="What skills, knowledge, or experience do they need to develop? Be specific."
                        className="w-full text-sm"
                        rows={3}
                      />
                      <div className="char-counter text-xs">{(member.developmentNeeds || '').length}/500</div>
                    </div>

                    {/* Coaching Plan */}
                    <div className="bg-gray-50 border-2 border-gray-200 p-4">
                      <label className="monument text-sm block mb-2">COACHING PLAN</label>
                      <textarea
                        value={member.coachingPlan || ''}
                        onChange={(e) => updateTeamMember(member.id, 'coachingPlan', e.target.value)}
                        placeholder="What support, mentoring, or coaching will you provide? How often will you meet?"
                        className="w-full text-sm"
                        rows={3}
                      />
                      <div className="char-counter text-xs">{(member.coachingPlan || '').length}/500</div>
                    </div>

                    {/* Role Changes */}
                    <div className="bg-purple-50 border-2 border-purple-200 p-4">
                      <label className="monument text-sm block mb-2">ROLE CHANGES</label>
                      <textarea
                        value={member.roleChanges || ''}
                        onChange={(e) => updateTeamMember(member.id, 'roleChanges', e.target.value)}
                        placeholder="Should their role, responsibilities, or position change? Lateral move? Promotion? Demotion?"
                        className="w-full text-sm"
                        rows={3}
                      />
                      <div className="char-counter text-xs">{(member.roleChanges || '').length}/500</div>
                    </div>

                    {/* Timeline */}
                    <div className="bg-yellow-50 border-2 border-yellow-200 p-4">
                      <label className="monument text-sm block mb-2">TIMELINE</label>
                      <textarea
                        value={member.timeline || ''}
                        onChange={(e) => updateTeamMember(member.id, 'timeline', e.target.value)}
                        placeholder="When will these actions happen? Specific dates or timeframes (Q2 2025, next 30 days, etc.)"
                        className="w-full text-sm"
                        rows={2}
                      />
                      <div className="char-counter text-xs">{(member.timeline || '').length}/300</div>
                    </div>

                    {/* Tough Decisions */}
                    {(member.abcRating === 'C' || member.abcRating === 'B') && (
                      <div className="bg-red-50 border-2 border-red-400 p-4">
                        <label className="monument text-sm block mb-2">TOUGH DECISIONS</label>
                        <textarea
                          value={member.toughDecisions || ''}
                          onChange={(e) => updateTeamMember(member.id, 'toughDecisions', e.target.value)}
                          placeholder="Performance improvement plan? Transition out? Exit conversation? When and how will you address this?"
                          className="w-full text-sm"
                          rows={3}
                        />
                        <div className="char-counter text-xs">{(member.toughDecisions || '').length}/500</div>
                      </div>
                    )}
                  </div>
                </div>
              ))}
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                VIEW CANVAS →
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Canvas Page
    function CanvasPage({ data, onExport, onSubmit }) {
      const teamMembers = data.teamMembers || [];

      const aPlayers = teamMembers.filter(m => m.abcRating === 'A');
      const bPlayers = teamMembers.filter(m => m.abcRating === 'B');
      const cPlayers = teamMembers.filter(m => m.abcRating === 'C');

      const calcAvgFit = (member) => {
        const scores = [
          member.energyScore || 0,
          member.skillScore || 0,
          member.valuesScore || 0,
          member.impactScore || 0
        ].filter(s => s > 0);
        return scores.length > 0 ? (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(1) : 'N/A';
      };

      return (
        <div className="bg-gray-100 min-h-screen p-16">
          <div className="max-w-6xl mx-auto">
            {/* Canvas Content */}
            <div id="canvas-content" className="bg-white p-16 mb-8">
              <div className="border-b-4 border-black pb-8 mb-8">
                <h1 className="plaak text-7xl mb-2">FIT & ABC ANALYSIS</h1>
                <p className="text-2xl text-gray-600">Sprint 24 - Team Evaluation & Talent Strategy</p>
              </div>

              {/* ABC Distribution */}
              <div className="mb-12">
                <h2 className="riforma-bold text-4xl mb-6">ABC DISTRIBUTION</h2>
                <div className="grid grid-cols-3 gap-6">
                  <div className="border-4 border-black p-6 bg-gray-50">
                    <div className="text-6xl plaak mb-2">{aPlayers.length}</div>
                    <p className="text-2xl riforma-bold">A PLAYERS</p>
                    <p className="text-base text-gray-600 mt-2">Great performers + cultural fit + high potential</p>
                  </div>
                  <div className="border-4 border-yellow-600 p-6 bg-yellow-50">
                    <div className="text-6xl plaak mb-2">{bPlayers.length}</div>
                    <p className="text-2xl riforma-bold">B PLAYERS</p>
                    <p className="text-base text-gray-600 mt-2">Good but not great, or performing without cultural fit</p>
                  </div>
                  <div className="border-4 border-red-600 p-6 bg-red-50">
                    <div className="text-6xl plaak mb-2">{cPlayers.length}</div>
                    <p className="text-2xl riforma-bold">C PLAYERS</p>
                    <p className="text-base text-gray-600 mt-2">Low performers or cultural misfits</p>
                  </div>
                </div>
              </div>

              {/* Team Member Summaries */}
              <div className="mb-12">
                <h2 className="riforma-bold text-4xl mb-6">TEAM MEMBER SUMMARIES</h2>
                <div className="space-y-6">
                  {teamMembers.map((member, index) => (
                    <div key={member.id} className="border-2 border-gray-300 p-6">
                      <div className="flex justify-between items-start mb-4">
                        <div>
                          <h3 className="riforma-bold text-2xl">{member.name || 'Team Member'} - {member.role || 'Role'}</h3>
                          {member.tenure && <p className="text-base text-gray-600">Tenure: {member.tenure}</p>}
                        </div>
                        <div className="text-right">
                          <div className={`abc-badge ${(member.abcRating || '').toLowerCase()} ${member.abcRating ? 'selected' : ''} text-lg mb-2`}>
                            {member.abcRating || '?'} PLAYER
                          </div>
                          <p className="text-base text-gray-600">FIT Avg: {calcAvgFit(member)}</p>
                        </div>
                      </div>

                      {/* FIT Scores */}
                      <div className="grid grid-cols-4 gap-3 mb-4">
                        <div className="bg-gray-50 p-3 border-l-4 border-black">
                          <p className="text-xs monument mb-1">ENERGY</p>
                          <p className="text-2xl riforma-bold">{member.energyScore || 0}/5</p>
                        </div>
                        <div className="bg-gray-50 p-3 border-l-4 border-black">
                          <p className="text-xs monument mb-1">SKILL</p>
                          <p className="text-2xl riforma-bold">{member.skillScore || 0}/5</p>
                        </div>
                        <div className="bg-purple-50 p-3 border-l-4 border-purple-600">
                          <p className="text-xs monument mb-1">VALUES</p>
                          <p className="text-2xl riforma-bold">{member.valuesScore || 0}/5</p>
                        </div>
                        <div className="bg-orange-50 p-3 border-l-4 border-orange-600">
                          <p className="text-xs monument mb-1">IMPACT</p>
                          <p className="text-2xl riforma-bold">{member.impactScore || 0}/5</p>
                        </div>
                      </div>

                      {/* ABC Reasoning */}
                      {member.abcReasoning && (
                        <div className="bg-gray-50 p-4 mb-4">
                          <p className="monument text-xs mb-2">ABC REASONING</p>
                          <p className="text-sm">{(member.abcReasoning || '').substring(0, 250)}...</p>
                        </div>
                      )}

                      {/* Action Plan Summary */}
                      <div className="grid grid-cols-2 gap-4">
                        {member.developmentNeeds && (
                          <div className="border-l-4 border-black pl-3">
                            <p className="monument text-xs mb-1">DEVELOPMENT</p>
                            <p className="text-sm">{(member.developmentNeeds || '').substring(0, 100)}...</p>
                          </div>
                        )}
                        {member.coachingPlan && (
                          <div className="border-l-4 border-black pl-3">
                            <p className="monument text-xs mb-1">COACHING</p>
                            <p className="text-sm">{(member.coachingPlan || '').substring(0, 100)}...</p>
                          </div>
                        )}
                        {member.roleChanges && (
                          <div className="border-l-4 border-purple-600 pl-3">
                            <p className="monument text-xs mb-1">ROLE CHANGES</p>
                            <p className="text-sm">{(member.roleChanges || '').substring(0, 100)}...</p>
                          </div>
                        )}
                        {member.toughDecisions && (
                          <div className="border-l-4 border-red-600 pl-3">
                            <p className="monument text-xs mb-1">TOUGH DECISIONS</p>
                            <p className="text-sm">{(member.toughDecisions || '').substring(0, 100)}...</p>
                          </div>
                        )}
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Key Actions */}
              <div className="border-4 border-yellow-400 bg-yellow-50 p-8 mb-8">
                <h2 className="riforma-bold text-3xl mb-4">KEY ACTIONS REQUIRED</h2>
                <div className="space-y-3 text-base">
                  <p className="riforma-bold">A PLAYERS ({aPlayers.length}): Retain, stretch, and develop for leadership</p>
                  <p className="riforma-bold">B PLAYERS ({bPlayers.length}): Provide clear development paths or consider role changes</p>
                  <p className="riforma-bold">C PLAYERS ({cPlayers.length}): Performance improvement plans or transition conversations needed</p>
                </div>
              </div>

              <div className="mt-12 pt-8 border-t-2 border-gray-200 text-center text-sm text-gray-500">
                <p>Generated: {new Date().toLocaleDateString()}</p>
                <p className="mt-1">Fast Track Sprint 24 - FIT & ABC Analysis</p>
              </div>
            </div>

            {/* Action Buttons */}
            <div className="flex gap-6 mb-6">
              <button onClick={onExport} className="btn-primary flex-1">
                EXPORT PDF
              </button>
              <button onClick={onSubmit} className="btn-primary flex-1">
                SUBMIT
              </button>
            </div>

            {/* Case Study */}
            <CaseStudy
                before={"[PLACEHOLDER] Mixed performance, no clear standard."}
                after={"[PLACEHOLDER] ABC analysis led to role changes. Productivity increased 45%."}
                quote={"[PLACEHOLDER] The ABC analysis was painful but necessary."}
            />
          </div>
        </div>
      );
    }

    // Progress Indicator
    function ProgressIndicator({ currentStep }) {
      const steps = [
        { number: 1, label: 'Team List' },
        { number: 2, label: 'FIT Analysis' },
        { number: 3, label: 'ABC Rating' },
        { number: 4, label: 'Action Plans' }
      ];

      return (
        <div className="flex items-center justify-center gap-4 mb-12">
          {steps.map((step, index) => (
            <Fragment key={step.number}>
              <div className="flex flex-col items-center">
                <div className={`progress-dot ${step.number === currentStep ? 'active' : ''} ${step.number < currentStep ? 'completed' : ''}`}></div>
                <div className="monument text-xs mt-2">{step.label}</div>
              </div>
              {index < steps.length - 1 && <div className="progress-line w-12"></div>}
            </Fragment>
          ))}
        </div>
      );
    }

    // Help Button
    function HelpButton({ onClick }) {
      return (
        <button onClick={onClick} className="help-button">
          ?
        </button>
      );
    }

    // Render App
        ReactDOM.render(<FitAbcApp />, document.getElementById('root'));
  </script>
</body>
</html>
