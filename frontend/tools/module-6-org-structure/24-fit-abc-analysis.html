<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FIT & ABC Analysis | Fast Track Program</title>

  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase -->
  <script src="../../shared/js/tool-db.js"></script>
  <script src="../../shared/js/ai-challenge.js"></script>
  <script src="../../shared/js/dependency-injection.js"></script>
  <script src="../../shared/js/transition-screen.js"></script>
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>
    <script src="../../js/tool-access-control.js"></script>

  <!-- jsPDF + html2canvas for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <style>
    /* Font Face Declarations */
    @font-face {
      font-family: 'Plaak';
      src: url('Plaak3Trial-43-Bold.woff2') format('woff2');
      font-weight: bold;
      font-style: normal;
    }

    @font-face {
      font-family: 'Riforma';
      src: url('RiformaLL-Regular.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Monument';
      src: url('MonumentGrotesk-Mono.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Riforma', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .plaak {
      font-family: 'Plaak', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: -0.02em;
    }

    .riforma-bold {
      font-family: 'Riforma', sans-serif;
      font-weight: bold;
    }

    .monument {
      font-family: 'Monument', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-in {
      animation: slideIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .fade-in {
      animation: fadeIn 0.4s ease-out;
    }

    .transition-animate-in {
      animation: slideIn 0.6s ease-out;
    }

    /* Button Styles */
    .btn-primary {
      background: #000000;
      color: #FFFFFF;
      padding: 16px 32px;
      border: 2px solid #000000;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: normal;
    }

    .btn-primary:hover:not(:disabled) {
      transform: scale(1.02);
    }

    .btn-primary:disabled {
      background: #E0E0E0;
      border-color: #E0E0E0;
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: #FFFFFF;
      color: #000000;
      padding: 12px 24px;
      border: 2px solid #000000;
      font-size: 16px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-secondary:hover {
      background: #F8F8F8;
    }

    /* Form Styles */
    input[type="text"],
    input[type="number"],
    input[type="email"],
    textarea,
    select {
      border: 1px solid #E0E0E0;
      padding: 12px 16px;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      width: 100%;
      transition: border-color 0.2s ease;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #000000;
    }

    textarea {
      min-height: 120px;
      resize: none !important;
    }

    textarea::placeholder {
      white-space: pre-line;
    }

    /* Numbered Section Badge */
    .numbered-section {
      background: #000000;
      color: #FFFFFF;
      padding: 10px 16px;
      font-family: 'Plaak', sans-serif;
      font-size: 26px;
      display: inline-block;
      text-transform: uppercase;
      letter-spacing: -0.02em;
    }

    /* Progress Indicator */
    .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #E0E0E0;
      transition: all 0.3s ease;
    }

    .progress-dot.active {
      background: #000000;
      transform: scale(1.3);
    }

    .progress-dot.completed {
      background: #000000;
    }

    .progress-line {
      height: 2px;
      background: #E0E0E0;
      flex: 1;
    }

    /* Character Counter */
    .char-counter {
      font-size: 14px;
      color: #666;
      margin-top: 4px;
    }

    .char-counter.invalid {
      color: #EF4444;
    }

    /* Rating Scale */
    .rating-scale {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .rating-button {
      width: 48px;
      height: 48px;
      border: 2px solid #000000;
      background: #FFFFFF;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .rating-button:hover {
      background: #F8F8F8;
    }

    .rating-button.selected {
      background: #000000;
      color: #FFFFFF;
    }

    /* ABC Badge */
    .abc-badge {
      display: inline-block;
      padding: 8px 16px;
      font-family: 'Plaak', sans-serif;
      font-size: 24px;
      border: 3px solid #000000;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .abc-badge:hover {
      background: #F8F8F8;
    }

    .abc-badge.selected {
      background: #000000;
      color: #FFFFFF;
    }

    .abc-badge.a {
      border-color: #000;
    }

    .abc-badge.a.selected {
      background: #000;
      color: #FFF469;
    }

    .abc-badge.b {
      border-color: #555;
    }

    .abc-badge.b.selected {
      background: #555;
      color: #FFFFFF;
    }

    .abc-badge.c {
      border-color: #DC2626;
    }

    .abc-badge.c.selected {
      background: #DC2626;
      color: #FFFFFF;
    }
    /* ── Wizard layout ── */
    .wizard-layout { display: flex; min-height: 100vh; }
    .wizard-main { flex: 1; display: flex; flex-direction: column; min-height: 100vh; background: #fff; padding: 0 48px; }
    .wizard-content { flex: 1; padding: 40px 0; }
    .wizard-sidebar { width: 280px; background: #1a1a1a; min-height: 100vh; padding: 48px 32px; display: flex; flex-direction: column; position: sticky; top: 0; align-self: flex-start; height: 100vh; overflow-y: auto; flex-shrink: 0; }
    .wizard-footer { display: flex; justify-content: space-between; align-items: center; padding: 24px 48px; border-top: 1px solid #e5e7eb; background: #fff; }
    .btn-wiz-back { background: transparent; border: 2px solid #d1d5db; color: #6b7280; padding: 12px 28px; font-family: 'Monument', monospace; font-size: 12px; letter-spacing: 0.06em; text-transform: uppercase; cursor: pointer; transition: all 0.2s; }
    .btn-wiz-back:hover { border-color: #000; color: #000; }
    .btn-wiz-next { background: #000; color: #fff; border: 2px solid #000; padding: 12px 36px; font-family: 'Monument', monospace; font-size: 12px; letter-spacing: 0.06em; text-transform: uppercase; cursor: pointer; transition: all 0.2s; }
    .btn-wiz-next:hover:not(:disabled) { background: #FFF469; color: #000; border-color: #FFF469; }
    .btn-wiz-next:disabled { background: #E0E0E0; color: #9CA3AF; border-color: #E0E0E0; cursor: not-allowed; }

    /* ── Step content ── */
    .step-content { max-width: 100%; padding: 40px 0; flex: 1; }
    .step-indicator { font-family: 'Monument', monospace; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em; color: #666; margin-bottom: 8px; }
    .opening-box { margin-bottom: 32px; }
    .opening-box .step-heading { font-family: 'Plaak', sans-serif; font-weight: bold; font-size: 32px; letter-spacing: -0.01em; line-height: 1.2; color: #000; margin-bottom: 6px; }
    .opening-box .step-hint { font-size: 14px; color: #666; line-height: 1.5; margin: 0; }

    /* ── Fields ── */
    .field-group { margin-bottom: 40px; }
    .field-label { font-weight: 600; font-size: 16px; color: #000; margin-bottom: 8px; display: block; }
    .field-help  { font-size: 13px; color: #666; margin-top: 4px; }
    .field-error { font-size: 13px; color: #DC2626; margin-top: 4px; }

    /* ── Closing box ── */
    .closing-box { border-top: 1px solid #E0E0E0; padding: 20px 0 0 0; margin-top: 8px; text-align: center; }
    .closing-box p { font-size: 14px; color: #666; }
    .closing-box .closing-title { font-family: 'Monument', monospace; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em; color: #000; margin-bottom: 6px; }

    /* ── Sidebar CSS classes ── */
    .sidebar-tool-num { font-family: 'Monument', monospace; font-size: 10px; color: #555; letter-spacing: 0.12em; text-transform: uppercase; margin-bottom: 8px; }
    .sidebar-tool-title { font-family: 'Plaak', sans-serif; font-size: 22px; color: #fff; margin-bottom: 32px; line-height: 1.1; }
    .sidebar-step { padding: 8px 0; border-bottom: 1px solid #2a2a2a; cursor: default; display: flex; align-items: center; gap: 8px; transition: opacity 0.2s; }
    .sidebar-step:last-child { border-bottom: none; }
    .sidebar-step-dot { width: 6px; height: 6px; border-radius: 50%; background: #555; flex-shrink: 0; transition: background 0.2s; }
    .sidebar-step-dot.active { background: #FFF469; }
    .sidebar-step-dot.done   { background: #4ade80; }
    .sidebar-step-label { font-family: 'Monument', monospace; font-size: 10px; letter-spacing: 0.08em; color: #555; text-transform: uppercase; transition: color 0.2s; }
    .sidebar-step-label.active { color: #FFF469; }
    .sidebar-step-label.done   { color: #4ade80; }

    /* ── Dependency context ── */
    .dep-context { border: 1px solid #E0E0E0; margin-bottom: 24px; }
    .dep-context-header { background: #F5F5F5; padding: 10px 16px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
    .dep-context-label { font-family: 'Monument', monospace; font-size: 10px; letter-spacing: 0.1em; color: #666; text-transform: uppercase; }
    .dep-context-body { padding: 14px 16px; font-size: 14px; color: #333; line-height: 1.6; }

    /* ── AI message ── */
    .ai-message { background: #FFF9C4; border: 1px solid #FFF469; border-left: 4px solid #FFF469; padding: 12px 16px; font-size: 14px; color: #333; margin-bottom: 16px; line-height: 1.6; }

    /* ── Animations ── */
    .animate-in { animation: fadeSlideIn 0.4s ease both; }
    @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }

    /* ── Submit success ── */
    .submit-success { background: #f0fdf4; border: 1px solid #86efac; padding: 32px; text-align: center; margin-top: 24px; }

    /* ── Mobile ── */
    @media (max-width: 768px) {
        .wizard-sidebar { display: none; }
        .wizard-main { padding: 0 24px; }
        .wizard-footer { padding: 16px 24px; }
    }

  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, Fragment } = React;

    const CONFIG = {
        TOOL_SLUG: 'fit-abc-analysis',
        AUTOSAVE_DELAY: 2000,
        TRANSITION_CONTENT: {
            1: {
                brutalTruth: 'Most companies keep C-players 18 months longer than they should. The cost is not just salary — it is the A-players who leave or disengage because standards are not held.',
                peerProof: '"A €20M firm ran the ABC analysis and addressed 3 C-players in critical roles. After 60 days — 2 moved on, 1 improved — team productivity increased 25% and voluntary A-player turnover dropped to zero."'
            },
            2: {
                brutalTruth: 'Role clarity is not an HR formality — it is a performance multiplier. When A-players do not know what winning looks like in their role, they default to activity over impact. Clarity unlocks discretionary effort.',
                peerProof: '"A scale-up rewrote job scorecards for their top 12 roles. Within 2 months, 3 people self-selected out (they no longer fit the role they thought they had), and performance reviews became conversations about outcomes, not feelings."'
            },
            3: {
                brutalTruth: 'Talent density — not headcount — is the true performance lever. One A-player in a key role consistently outperforms three B-players. The question is not how many people you have, but how aligned each one is to where value is created.',
                peerProof: '"After implementing ABC analysis company-wide, a €50M firm reduced headcount by 8% while revenue grew 22%. They stopped backfilling B-player exits and rebuilt roles around A-player strengths instead."'
            },
            4: {
                brutalTruth: 'Action plans without deadlines are wishes. B and C players do not improve without specific commitments, clear timelines, and named consequences. Vague coaching conversations are the most expensive HR activity in your company.',
                peerProof: '"A tech firm built 90-day development plans for every B-player. Within one quarter, 4 of 6 improved to A-player performance. The other 2 self-selected out. Net result: the team performed at 40% higher output with the same headcount."'
            }
        },
        CLOSING_MESSAGES: {
            1: { title: 'TEAM MAPPED', text: 'Your team is visible. Now score each person on energy, skills, values, and impact.' },
            2: { title: 'FIT SCORED', text: 'The scores are in. Now classify each person as A, B, or C — and defend it.' },
            3: { title: 'ABC CLASSIFIED', text: 'Classification complete. Now build the action plans that change the outcomes.' },
            4: { title: 'PLANS COMPLETE', text: 'Your talent strategy is built. Review the canvas and submit.' }
        }
    };

    // Make Supabase client globally available for dependency injection
    // Initialize ToolDB and dependency injection
    ToolDB.init(CONFIG.TOOL_SLUG);
        ToolAccessControl.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        window.CognitiveLoad && CognitiveLoad.init('fit-abc', {"insights":["The ABC Matrix forces the hardest conversation: who belongs and who does not.","A-players attract A-players. B-players hire C-players."],"caseStudy":{"before":"A 120-person manufacturing company had no formal talent evaluation. Managers promoted based on tenure, not performance. Three underperforming directors held executive seats for years while high-potential leaders left for competitors. Team morale was low, execution was slow, and the CEO avoided hard conversations about fit.","after":"After implementing FIT and ABC Analysis across all departments, the CEO reclassified the executive team within 90 days. Two C-players were transitioned out, one B-player was moved to a better-fit role, and two high-potential A-players were promoted. Within six months, execution speed improved 40%, voluntary turnover of top talent dropped to near zero, and the leadership team reported the highest engagement scores in company history.","quote":"We knew who our A-players were all along. What the ABC framework gave us was the courage and the structure to act on what we already knew but were afraid to confront. -- CEO, mid-market manufacturing firm"}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

        function DependencyContext({ deps }) {
            const [open, setOpen] = React.useState(false);
            if (!deps || deps.length === 0) return null;
            return (
                <div className="dep-context">
                    <div className="dep-context-header" onClick={() => setOpen(o => !o)}>
                        <span className="dep-context-label">Context from previous tools ({deps.length})</span>
                        <span style={{ fontSize: 12, color: '#999' }}>{open ? '▲' : '▼'}</span>
                    </div>
                    {open && (
                        <div className="dep-context-body">
                            {deps.map((dep, i) => (
                                <div key={i} style={{ marginBottom: 8 }}>
                                    <span style={{ fontFamily: "'Monument', monospace", fontSize: 10, color: '#999', textTransform: 'uppercase', letterSpacing: '0.08em' }}>{dep.label}: </span>
                                    <span>{dep.value}</span>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

    // Main App Component
    function FitAbcApp() {
            const [deps, setDeps] = useState([]);
      const [step, setStep] = useState(0);
      const [aiReviewing, setAiReviewing] = useState(false);
      const [submitted, setSubmitted] = useState(false);
      const [abcIdx, setAbcIdx] = useState(0);

      const [data, setData] = useState({
        teamMembers: [
          {
            id: 1,
            name: '',
            role: '',
            tenure: '',
            energyScore: 0,
            energyNotes: '',
            skillScore: 0,
            skillNotes: '',
            valuesScore: 0,
            valuesNotes: '',
            impactScore: 0,
            impactNotes: '',
            abcRating: '',
            abcReasoning: '',
            performanceNotes: '',
            cultureNotes: '',
            potentialNotes: '',
            developmentNeeds: '',
            coachingPlan: '',
            roleChanges: '',
            timeline: '',
            toughDecisions: ''
          }
        ]
      });

            useEffect(() => {
                async function loadDeps() {
                    const userId = localStorage.getItem('ft_user_id');
                    if (!userId || !window.ToolDB || !window.DependencyInjection) return;
                    try {
                        await ToolDB.whenReady();
                        const config = DependencyInjection.getDependenciesConfig();
                        const toolConfig = config[CONFIG.TOOL_SLUG];
                        if (!toolConfig || !toolConfig.fields) return;
                        const loaded = [];
                        for (const field of toolConfig.fields) {
                            const val = await ToolDB.getDependency(userId, field.source_field);
                            if (val) {
                                loaded.push({ label: field.display_label || field.source_field, value: window.DependencyInjection ? DependencyInjection.formatValue(val) : (typeof val === 'object' ? JSON.stringify(val, null, 2) : String(val)) });
                            }
                        }
                        setDeps(loaded);
                    } catch (err) {
                        console.warn('[' + CONFIG.TOOL_SLUG + '] Failed to load dependencies:', err);
                    }
                }
                loadDeps();
            }, []);

      // Reset abcIdx when entering step 3
      useEffect(() => { if (step === 3) setAbcIdx(0); }, [step]);

      // Load from localStorage
      useEffect(() => {
        const saved = localStorage.getItem('fit-abc-data');
        if (saved) {
          try {
            const savedData = JSON.parse(saved);
            setData(savedData);
          } catch (e) {
            console.error('Error loading saved data:', e);
          }
        }
      }, []);

      // Auto-save every 2 seconds
      useEffect(() => {
        const interval = setInterval(() => {
          localStorage.setItem('fit-abc-data', JSON.stringify(data));
        }, 2000);
        return () => clearInterval(interval);
      }, [data]);

      const updateData = (field, value) => {
        setData({ ...data, [field]: value });
      };

      const addTeamMember = () => {
        const newMember = {
          id: Date.now(),
          name: '',
          role: '',
          tenure: '',
          energyScore: 0,
          energyNotes: '',
          skillScore: 0,
          skillNotes: '',
          valuesScore: 0,
          valuesNotes: '',
          impactScore: 0,
          impactNotes: '',
          abcRating: '',
          abcReasoning: '',
          performanceNotes: '',
          cultureNotes: '',
          potentialNotes: '',
          developmentNeeds: '',
          coachingPlan: '',
          roleChanges: '',
          timeline: '',
          toughDecisions: ''
        };
        updateData('teamMembers', [...(data.teamMembers || []), newMember]);
      };

      const removeTeamMember = (id) => {
        if ((data.teamMembers || []).length > 1) {
          updateData('teamMembers', (data.teamMembers || []).filter(m => m.id !== id));
        }
      };

      const updateTeamMember = (id, field, value) => {
        const updated = (data.teamMembers || []).map(m => m.id === id ? { ...m, [field]: value } : m);
        updateData('teamMembers', updated);
      };

      const goNext = async () => {
        if (step === 0.5) {
          setStep(1);
        } else if (step >= 1 && step <= 4) {
          // Step 2 (FIT Analysis) handles its own per-question AI reviews — skip here
          if (step !== 2) {
            const userId = localStorage.getItem('ft_user_id');
            if (userId) {
              setAiReviewing(true);
              try {
                let stepAnswers = {};
                let stepName = '';
                const teamMembers = data.teamMembers || [];
                if (step === 1) {
                  stepName = 'Team Members';
                  stepAnswers = { team_list: teamMembers.map(m => ({ name: m.name, role: m.role, tenure: m.tenure })) };
                } else if (step === 3) {
                  stepName = 'ABC Classification';
                  stepAnswers = { classification: teamMembers.map(m => ({ name: m.name, abcRating: m.abcRating, abcReasoning: m.abcReasoning })) };
                } else if (step === 4) {
                  stepName = 'Action Plans';
                  stepAnswers = { action_plans: teamMembers.filter(m => m.abcRating === 'B' || m.abcRating === 'C').map(m => ({ name: m.name, abcRating: m.abcRating, developmentNeeds: m.developmentNeeds, coachingPlan: m.coachingPlan, roleChanges: m.roleChanges, toughDecisions: m.toughDecisions })) };
                }
                const canProceed = await window.AIChallenge.reviewStep(userId, CONFIG.TOOL_SLUG, stepAnswers, stepName);
                if (!canProceed) { setAiReviewing(false); return; }
              } catch (err) {
                console.warn('[AIChallenge] Error, allowing passage:', err);
              } finally {
                setAiReviewing(false);
              }
            }
          }

          setStep(step + 0.5);
        } else if (step === 0) {
          setStep(0.5);
        }
      };

      const goBack = () => {
        if (step === 5) {
          setStep(4);
        } else if (step === 3) {
          if (abcIdx > 0) { setAbcIdx(i => i - 1); return; }
          setStep(2);
        } else if (step > 1) {
          setStep(step - 1);
        } else if (step === 1) {
          setStep(0.5);
        }
      };

      // Validation functions
      const isStep1Valid = () => {
        return (data.teamMembers || []).length >= 1 &&
               (data.teamMembers || []).every(m =>
                 (m.name || '').trim().length >= 2 &&
                 (m.role || '').trim().length >= 2
               );
      };

      const isStep2Valid = () => {
        return (data.teamMembers || []).every(m =>
          (m.energyScore || 0) >= 1 && (m.energyScore || 0) <= 5 &&
          (m.skillScore || 0) >= 1 && (m.skillScore || 0) <= 5 &&
          (m.valuesScore || 0) >= 1 && (m.valuesScore || 0) <= 5 &&
          (m.impactScore || 0) >= 1 && (m.impactScore || 0) <= 5
        );
      };

      const isStep3Valid = () => {
        return (data.teamMembers || []).every(m =>
          (m.abcRating || '').length >= 1 &&
          (m.abcReasoning || '').length >= 50
        );
      };

      const isStep4Valid = () => {
        const bcMembers = (data.teamMembers || []).filter(m => m.abcRating === 'B' || m.abcRating === 'C');
        if (bcMembers.length === 0) return true;
        return bcMembers.every(m =>
          (m.developmentNeeds || '').length >= 30 ||
          (m.coachingPlan || '').length >= 30 ||
          (m.roleChanges || '').length >= 30 ||
          (m.toughDecisions || '').length >= 30
        );
      };

      const exportPDF = async () => {
        try {
          const canvas = document.getElementById('canvas-content');
          if (!canvas) {
            alert('Canvas not found');
            return;
          }

          const images = canvas.querySelectorAll('img');
          const imageStates = [];
          images.forEach(img => {
            imageStates.push({ img, display: img.style.display });
            img.style.display = 'none';
          });

          const canvasImage = await html2canvas(canvas, {
            scale: 2,
            logging: false,
            backgroundColor: '#ffffff'
          });

          imageStates.forEach(({ img, display }) => {
            img.style.display = display;
          });

          const imgWidth = 190;
          const imgHeight = (canvasImage.height * imgWidth) / canvasImage.width;

          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const imgData = canvasImage.toDataURL('image/png');

          pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
          pdf.save('fit-abc-analysis.pdf');
        } catch (error) {
          console.error('PDF export error:', error);
          alert('Failed to export PDF: ' + error.message);
        }
      };

      const handleSubmit = async () => {
        const userId = localStorage.getItem('ft_user_id');
        if (!userId) {
          alert('User not authenticated. Please return to the dashboard.');
          return false;
        }

        try {
          const teamMembers = data.teamMembers || [];
          const questionMappings = {
            classification: teamMembers.map(m => ({
              name: m.name,
              role: m.role,
              tenure: m.tenure,
              abcRating: m.abcRating,
              abcReasoning: m.abcReasoning,
              energyScore: m.energyScore,
              skillScore: m.skillScore,
              valuesScore: m.valuesScore,
              impactScore: m.impactScore
            })),
            talent_gaps: teamMembers.filter(m => m.abcRating === 'B' || m.abcRating === 'C').map(m => ({
              name: m.name,
              abcRating: m.abcRating,
              developmentNeeds: m.developmentNeeds,
              capabilityGap: m.abcReasoning
            })),
            a_player_agreements: teamMembers.filter(m => m.abcRating === 'A').map(m => ({
              name: m.name,
              role: m.role,
              coachingPlan: m.coachingPlan,
              roleChanges: m.roleChanges,
              timeline: m.timeline
            }))
          };
          await ToolDB.save(userId, questionMappings);
          setSubmitted(true);
          return true;
        } catch (error) {
          console.error('Supabase submission error:', error);
          alert('Submission failed. Please try again.');
          return false;
        }
      };

      // Render different pages based on step
      if (submitted) {
        return (
          <div style={{ minHeight: '100vh', background: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '48px 32px' }}>
            <div className="submit-success" style={{ maxWidth: 480, width: '100%' }}>
              <div style={{ fontSize: 40, marginBottom: 8 }}>✓</div>
              <h2 className="plaak" style={{ fontSize: 28, marginBottom: 8 }}>SUBMITTED</h2>
              <p style={{ color: '#555', marginBottom: 16 }}>Your FIT & ABC Analysis has been saved.</p>
              <a href="\dashboard" style={{ fontFamily: "'Monument', monospace", fontSize: 11, color: '#000', letterSpacing: '0.08em', textTransform: 'uppercase', textDecoration: 'none', borderBottom: '2px solid #000' }}>← Back to Dashboard</a>
            </div>
          </div>
        );
      }

      if ([1.5, 2.5, 3.5, 4.5].includes(step)) {
        return window.renderTransitionScreen(step, CONFIG, 4, setStep);
      }

      if (step === 0) {
        return <CoverPage onStart={goNext} />;
      }

      if (step === 0.5) {
        return <IntroPage onNext={goNext} />;
      }

      // Steps 1-4: Wizard layout
      if (step >= 1 && step <= 4) {
        const stepLabels = ['Team Members', 'FIT Analysis', 'ABC Classification', 'Action Plans'];
        // Step 2 uses internal navigation — footer shows only Back
        let isValid, nextLabel, onNextOverride;
        if (step === 3) {
          const members = data.teamMembers || [];
          const cur = members[abcIdx];
          const curFilled = cur && (cur.abcRating || '').length >= 1 && (cur.abcReasoning || '').length >= 50;
          const isLast = abcIdx === members.length - 1;
          isValid = curFilled && (!isLast || isStep3Valid());
          if (isLast) {
            nextLabel = aiReviewing ? 'AI COACH REVIEWING...' : 'NEXT: ACTION PLANS →';
            onNextOverride = goNext;
          } else {
            nextLabel = 'NEXT MEMBER →';
            onNextOverride = () => setAbcIdx(i => i + 1);
          }
        } else {
          isValid = step === 1 ? isStep1Valid() : step === 2 ? true : isStep4Valid();
          nextLabel = aiReviewing ? 'AI COACH REVIEWING...' : ({ 1: 'NEXT: FIT ANALYSIS →', 4: 'VIEW CANVAS →' }[step] || 'NEXT →');
          onNextOverride = goNext;
        }
        const canProceed = !aiReviewing && isValid;
        return (
          <div className="wizard-layout">
            <div className="wizard-main">
              <div className="step-content animate-in">
                <DependencyContext deps={deps} />
                {step === 1 && <Step1Page data={data} updateTeamMember={updateTeamMember} addTeamMember={addTeamMember} removeTeamMember={removeTeamMember} />}
                {step === 2 && <Step2Page data={data} updateTeamMember={updateTeamMember} onAdvanceStep={goNext} />}
                {step === 3 && <Step3Page data={data} updateTeamMember={updateTeamMember} abcIdx={abcIdx} setAbcIdx={setAbcIdx} />}
                {step === 4 && <Step4Page data={data} updateTeamMember={updateTeamMember} />}
              </div>
              {step !== 2 && (
                <div className="wizard-footer">
                  <button className="btn-wiz-back" onClick={goBack}>← BACK</button>
                  <button className="btn-wiz-next" disabled={!canProceed} onClick={onNextOverride}>
                    {nextLabel}
                  </button>
                </div>
              )}
              {step === 2 && (
                <div className="wizard-footer">
                  <button className="btn-wiz-back" onClick={goBack}>← BACK TO TEAM LIST</button>
                </div>
              )}
            </div>
            <WizardSidebar currentStep={step} stepLabels={stepLabels} totalSteps={4} />
          </div>
        );
      }

      if (step === 5) {
        return (
          <CanvasPage
            data={data}
            onExport={exportPDF}
            onSubmit={handleSubmit}
          />
        );
      }

      return null;
    }

    // Cover Page Component
    function CoverPage({ onStart }) {
      return (
        <div style={{ position: 'relative', width: '100%', minHeight: '100vh', background: '#000', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', overflow: 'hidden' }}>
          <div style={{ position: 'absolute', inset: 0, backgroundImage: 'url("https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=1920&q=80")', backgroundSize: 'cover', backgroundPosition: 'center', opacity: 0.35 }} />
          <div style={{ position: 'relative', zIndex: 2, textAlign: 'center', padding: '0 32px', maxWidth: 800 }}>
            <div style={{ fontFamily: "'Monument', monospace", fontSize: 11, color: '#FFF469', letterSpacing: '0.15em', textTransform: 'uppercase', marginBottom: 24 }}>SPRINT 24</div>
            <h1 className="plaak animate-in" style={{ fontSize: 'clamp(48px, 8vw, 96px)', color: '#fff', marginBottom: 24, lineHeight: 1 }}>
              FIT & ABC ANALYSIS
            </h1>
            <p style={{ fontSize: 18, color: '#ccc', marginBottom: 48, lineHeight: 1.6 }} className="animate-in">
              Evaluate team members with clarity and courage. Right people, right roles, right results.
            </p>
            <button onClick={onStart} className="plaak animate-in"
              style={{ background: '#FFF469', color: '#000', border: 'none', padding: '20px 56px', fontSize: 20, cursor: 'pointer', letterSpacing: '0.02em' }}>
              START →
            </button>
          </div>
        </div>
      );
    }

    // Intro Page Component
    function IntroPage({ onNext }) {
      return (
        <div style={{ background: '#000', color: '#fff', minHeight: '100vh', padding: '64px' }}>
          <div style={{ maxWidth: '1000px', margin: '0 auto' }}>
            <h1 className="plaak animate-in" style={{ fontSize: '100px', marginBottom: '64px' }}>
              BEFORE WE START
            </h1>

            {/* Sprint Info */}
            <div className="animate-in" style={{ marginBottom: '48px', animationDelay: '0.08s' }}>
              <h2 className="plaak" style={{ fontSize: '48px', color: '#FFF469', marginBottom: '24px' }}>SPRINT INFO</h2>
              <div style={{ background: '#fff', color: '#000', padding: '32px' }}>
                <p style={{ fontSize: '22px', fontWeight: 'bold', marginBottom: '16px' }}>Sprint 24: FIT & ABC Analysis</p>
                <p style={{ fontSize: '18px', lineHeight: 1.6, marginBottom: '16px' }}>
                  Think of your organisation as a sports team. Even the best strategy won't win if the wrong players are in the wrong positions. This sprint makes sure the right people are doing the right things — so your strategy can truly perform.
                </p>
                <div style={{ borderLeft: '4px solid #000', paddingLeft: '16px', fontStyle: 'italic', fontSize: '16px' }}>
                  High performers in the right roles deliver up to 400% more than average ones. Yet 1 in 3 leaders avoid addressing people-fit issues until it's too late.
                </div>
              </div>
            </div>

            {/* Two Frameworks */}
            <div className="animate-in" style={{ marginBottom: '48px', animationDelay: '0.1s' }}>
              <h2 className="plaak" style={{ fontSize: '48px', marginBottom: '24px' }}>TWO FRAMEWORKS</h2>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                <div style={{ border: '2px solid #fff', padding: '24px' }}>
                  <h3 className="plaak" style={{ fontSize: '28px', color: '#FFF469', marginBottom: '12px' }}>FIT ANALYSIS</h3>
                  <p style={{ fontSize: '16px', marginBottom: '12px', color: '#ccc' }}>Are people naturally energised and suited for the role?</p>
                  <ul style={{ fontSize: '15px', listStyle: 'none', padding: 0, lineHeight: 2 }}>
                    <li><strong>Energy:</strong> Does this role energise or drain them?</li>
                    <li><strong>Skill:</strong> Do they have the natural talents and learned skills?</li>
                    <li><strong>Values:</strong> Are their values aligned with company values?</li>
                    <li><strong>Impact:</strong> Are they making a significant contribution?</li>
                  </ul>
                </div>
                <div style={{ border: '2px solid #fff', padding: '24px' }}>
                  <h3 className="plaak" style={{ fontSize: '28px', color: '#FFF469', marginBottom: '12px' }}>ABC ANALYSIS</h3>
                  <p style={{ fontSize: '16px', marginBottom: '12px', color: '#ccc' }}>Are they delivering results and behaving in line with values?</p>
                  <ul style={{ fontSize: '15px', listStyle: 'none', padding: 0, lineHeight: 2 }}>
                    <li><strong>A Players:</strong> Great performance + cultural fit + high potential</li>
                    <li><strong>B Players:</strong> Good but not great, or performing without cultural fit</li>
                    <li><strong>C Players:</strong> Low performers or cultural misfits</li>
                  </ul>
                </div>
              </div>
            </div>

            {/* Mistakes to Avoid */}
            <div className="animate-in" style={{ marginBottom: '48px', animationDelay: '0.2s' }}>
              <h2 className="plaak" style={{ fontSize: '48px', color: '#FFF469', marginBottom: '24px' }}>MISTAKES TO AVOID</h2>
              <ul style={{ fontSize: '20px', listStyle: 'none', padding: 0 }}>
                {[
                  'Confusing personality with performance — being nice does not equal being effective.',
                  'Overrating B players out of fear — loyalty and past contribution cloud judgment.',
                  'Skipping development conversations — assessments without action waste time.',
                  'Being sentimental, not strategic — the goal is performance, not comfort.',
                  'Delayed tough decisions — C-players quietly kill momentum and culture.',
                ].map((item, i) => (
                  <li key={i} style={{ display: 'flex', alignItems: 'flex-start', marginBottom: '16px' }}>
                    <span style={{ fontSize: '32px', marginRight: '16px', lineHeight: 1, flexShrink: 0 }}>•</span>
                    <span>{item}</span>
                  </li>
                ))}
              </ul>
            </div>

            {/* The Journey */}
            <div className="animate-in" style={{ marginBottom: '64px', animationDelay: '0.3s' }}>
              <h2 className="plaak" style={{ fontSize: '48px', marginBottom: '32px' }}>THE JOURNEY</h2>
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', textAlign: 'center' }}>
                {[
                  ['01', 'TEAM LIST',     'Name, role, tenure'],
                  ['02', 'FIT ANALYSIS',  '4 dimensions rated'],
                  ['03', 'ABC RATING',    'Classify A / B / C'],
                  ['04', 'ACTION PLANS',  'Development steps'],
                ].map(([num, title, sub]) => (
                  <div key={num} style={{ border: '2px solid #fff', padding: '20px 12px' }}>
                    <div className="plaak" style={{ fontSize: '52px', marginBottom: '12px' }}>{num}</div>
                    <p style={{ fontWeight: 'bold', marginBottom: '6px', fontSize: '13px' }}>{title}</p>
                    <p style={{ fontSize: '12px', color: '#999' }}>{sub}</p>
                  </div>
                ))}
              </div>
            </div>

            <button onClick={onNext} className="plaak"
              style={{ width: '100%', padding: '32px', background: '#FFF469', color: '#000', border: 'none', fontSize: '28px', cursor: 'pointer', letterSpacing: '0.05em' }}>
              LET'S START →
            </button>
          </div>
        </div>
      );
    }

    // Wizard Sidebar Component
    function WizardSidebar({ currentStep, stepLabels, totalSteps }) {
      const canvasStep = 'canvas';
      const allSteps = [...stepLabels.map((label, i) => ({ num: i + 1, label })), { num: canvasStep, label: 'Canvas' }];
      return (
        <div className="wizard-sidebar">
          <div className="sidebar-tool-num">SPRINT 24</div>
          <div className="sidebar-tool-title">FIT & ABC ANALYSIS</div>
          {allSteps.map(s => {
            const isCanvas = s.num === canvasStep;
            const isDone   = isCanvas ? false : currentStep > s.num;
            const isActive = isCanvas ? currentStep === canvasStep : Math.floor(currentStep) === s.num;
            const isFuture = isCanvas ? false : currentStep < s.num;
            return (
              <div key={s.num} className="sidebar-step" style={{ opacity: isFuture ? 0.35 : 1 }}>
                <div className={`sidebar-step-dot ${isActive ? 'active' : isDone ? 'done' : ''}`} />
                <span className={`sidebar-step-label ${isActive ? 'active' : isDone ? 'done' : ''}`}>{s.label}</span>
              </div>
            );
          })}
        </div>
      );
    }

    // Step 1: Team Member List
    function Step1Page({ data, updateTeamMember, addTeamMember, removeTeamMember }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">01. TEAM MEMBERS</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            

            {/* Common Mistake */}


            <h3 className="plaak animate-in" style={{ fontSize: 32, marginBottom: 8, animationDelay: '0.05s' }}>
              List the team members you will evaluate
            </h3>

            <div style={{ borderLeft: '4px solid #FFF469', paddingLeft: 24, marginBottom: 32, background: '#F9F9F9', padding: '16px 24px', borderLeft: '4px solid #FFF469' }} className="animate-in">
              <p style={{ fontSize: 16, fontStyle: 'italic', color: '#333', lineHeight: 1.6 }}>
                "As CEO, evaluate your executive team. As an executive, evaluate your direct reports. This is the foundation for honest talent conversations."
              </p>
            </div>

            <p style={{ fontSize: 14, marginBottom: 24, color: '#666', lineHeight: 1.6 }}>
              Create your evaluation roster. Include name, current role, and tenure. This gives context for FIT and ABC assessments in the next steps.
            </p>

            <div style={{ marginBottom: 32 }}>
              {(data.teamMembers || []).map((member, index) => (
                <div key={member.id} style={{ border: '1px solid #E0E0E0', padding: 24, marginBottom: 16 }} className="animate-in">
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: 20 }}>
                    <div style={{ fontFamily: "'Monument', monospace", fontSize: 11, color: '#666', letterSpacing: '0.08em', textTransform: 'uppercase' }}>TEAM MEMBER {index + 1}</div>
                    {(data.teamMembers || []).length > 1 && (
                      <button
                        onClick={() => removeTeamMember(member.id)}
                        style={{ background: 'none', border: 'none', color: '#DC2626', cursor: 'pointer', fontFamily: "'Monument', monospace", fontSize: 11, letterSpacing: '0.06em' }}
                      >
                        REMOVE
                      </button>
                    )}
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: 16 }}>
                    <div>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 6, letterSpacing: '0.06em' }}>NAME <span style={{ color: '#DC2626' }}>*</span></label>
                      <input
                        type="text"
                        value={member.name || ''}
                        onChange={(e) => updateTeamMember(member.id, 'name', e.target.value)}
                        placeholder="John Smith"
                        style={{ width: '100%' }}
                      />
                    </div>

                    <div>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 6, letterSpacing: '0.06em' }}>ROLE <span style={{ color: '#DC2626' }}>*</span></label>
                      <input
                        type="text"
                        value={member.role || ''}
                        onChange={(e) => updateTeamMember(member.id, 'role', e.target.value)}
                        placeholder="Operations Manager"
                        style={{ width: '100%' }}
                      />
                    </div>

                    <div>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 6, letterSpacing: '0.06em' }}>TENURE</label>
                      <input
                        type="text"
                        value={member.tenure || ''}
                        onChange={(e) => updateTeamMember(member.id, 'tenure', e.target.value)}
                        placeholder="2 years / 6 months"
                        style={{ width: '100%' }}
                      />
                    </div>
                  </div>
                </div>
              ))}

              <button onClick={addTeamMember} className="btn-secondary" style={{ width: '100%' }}>
                + ADD TEAM MEMBER
              </button>
            </div>

        </div>
      );
    }

    // Step 2: FIT Analysis — typeform-style, one member at a time
    function Step2Page({ data, updateTeamMember, onAdvanceStep }) {
      const members = data.teamMembers || [];
      const [fitMemberIndex, setFitMemberIndex] = useState(0);
      const [fitQuestionIndex, setFitQuestionIndex] = useState(0);
      const [aiReviewingQ, setAiReviewingQ] = useState(false);
      const [transitioning, setTransitioning] = useState(false);

      const FIT_QUESTIONS = [
        {
          key: 'energyScore',
          notesKey: 'energyNotes',
          label: 'ENERGY',
          question: 'Does this role energize them or drain them?',
          context: 'Energy is the most underrated dimension of FIT. A-players in the wrong role will still underperform because the work depletes rather than fuels them. Look for: Do they light up when talking about this work? Do they stay late by choice or obligation?',
          placeholder: 'What evidence shows they\'re energized or drained? Do they light up or show fatigue?',
          bg: null
        },
        {
          key: 'skillScore',
          notesKey: 'skillNotes',
          label: 'SKILL',
          question: 'Do they have the natural talents and learned skills for this role?',
          context: 'Skill FIT asks: can they do this job with excellence? Consider both natural aptitude (hard to train) and learned competency (can be developed). Low skill + high energy = teachable. High skill + low energy = misplaced.',
          placeholder: 'What skills do they excel at? Where do they struggle? Natural talent or learned competency?',
          bg: null
        },
        {
          key: 'valuesScore',
          notesKey: 'valuesNotes',
          label: 'VALUES',
          question: 'Are their personal values aligned with company values?',
          context: 'Values misalignment is the silent killer of team performance. You can\'t train values. A person who doesn\'t share the company\'s core values will create cultural friction even if they are a high performer. Be honest here — it\'s the hardest dimension to confront.',
          placeholder: 'How do they demonstrate company values? Any cultural misalignment?',
          bg: 'bg-purple-50 border-purple-200'
        },
        {
          key: 'impactScore',
          notesKey: 'impactNotes',
          label: 'IMPACT',
          question: 'Are they making a significant, measurable contribution?',
          context: 'Impact is the output dimension. Not effort, not intention — results. Ask: what would be measurably different if this person were not in the role? If the answer is "not much," that\'s your score. Look for concrete numbers, outcomes, and decisions with real consequences.',
          placeholder: 'What measurable results have they delivered? How significant is their contribution?',
          bg: 'bg-orange-50 border-orange-200'
        }
      ];

      const currentMember = members[fitMemberIndex];
      const currentQuestion = FIT_QUESTIONS[fitQuestionIndex];
      const totalMembers = members.length;
      const totalQuestions = FIT_QUESTIONS.length;

      // Compute global question number for progress display
      const globalCurrent = fitMemberIndex * totalQuestions + fitQuestionIndex + 1;
      const globalTotal = totalMembers * totalQuestions;

      if (!currentMember || !currentQuestion) return null;

      const currentScore = currentMember[currentQuestion.key] || 0;
      const currentNotes = currentMember[currentQuestion.notesKey] || '';

      const RatingScale = ({ value, onChange }) => (
        <div className="rating-scale mb-3">
          {[1, 2, 3, 4, 5].map(score => (
            <button
              key={score}
              type="button"
              onClick={() => onChange(score)}
              className={`rating-button ${value === score ? 'selected' : ''}`}
            >
              {score}
            </button>
          ))}
          <div className="flex justify-between flex-1 ml-4 text-sm text-gray-400">
            <span>1 = Low</span>
            <span>5 = High</span>
          </div>
        </div>
      );

      const advanceQuestion = async () => {
        if (transitioning) return;
        setTransitioning(true);

        // AI review for this question answer
        const userId = localStorage.getItem('ft_user_id');
        if (userId && currentScore >= 1) {
          setAiReviewingQ(true);
          try {
            const stepAnswers = {
              member_name: currentMember.name || `Team Member ${fitMemberIndex + 1}`,
              dimension: currentQuestion.label,
              score: currentScore,
              notes: currentNotes
            };
            const canProceed = await window.AIChallenge.reviewStep(
              userId,
              CONFIG.TOOL_SLUG,
              stepAnswers,
              `FIT Analysis - ${currentMember.name || 'Member'} - ${currentQuestion.label}`
            );
            if (!canProceed) {
              setAiReviewingQ(false);
              setTransitioning(false);
              return;
            }
          } catch (err) {
            console.warn('[AIChallenge] Error, allowing passage:', err);
          } finally {
            setAiReviewingQ(false);
          }
        }

        // Move to next question or next member
        if (fitQuestionIndex < totalQuestions - 1) {
          setFitQuestionIndex(fitQuestionIndex + 1);
        } else if (fitMemberIndex < totalMembers - 1) {
          setFitMemberIndex(fitMemberIndex + 1);
          setFitQuestionIndex(0);
        } else {
          // All done — advance wizard step
          if (onAdvanceStep) onAdvanceStep();
        }
        setTransitioning(false);
      };

      const goBackQuestion = () => {
        if (fitQuestionIndex > 0) {
          setFitQuestionIndex(fitQuestionIndex - 1);
        } else if (fitMemberIndex > 0) {
          setFitMemberIndex(fitMemberIndex - 1);
          setFitQuestionIndex(totalQuestions - 1);
        }
      };

      const isLastQuestion = fitMemberIndex === totalMembers - 1 && fitQuestionIndex === totalQuestions - 1;
      const canAdvance = currentScore >= 1;

      return (
        <div>
          <div className="numbered-section mb-6 animate-in">02. FIT ANALYSIS</div>

          {/* Progress bar */}
          <div style={{ display: 'flex', alignItems: 'center', gap: 12, marginBottom: 32 }}>
            <div style={{ flex: 1, height: 4, background: '#E0E0E0', borderRadius: 2 }}>
              <div style={{ height: '100%', background: '#000', borderRadius: 2, width: `${(globalCurrent / globalTotal) * 100}%`, transition: 'width 0.4s ease' }} />
            </div>
            <span className="monument" style={{ fontSize: 11, color: '#666', whiteSpace: 'nowrap' }}>
              {globalCurrent} / {globalTotal}
            </span>
          </div>

          {/* Member indicator */}
          <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 24 }}>
            <span className="monument" style={{ fontSize: 11, color: '#999', letterSpacing: '0.08em' }}>
              MEMBER {fitMemberIndex + 1} OF {totalMembers}
            </span>
            <span style={{ color: '#E0E0E0' }}>·</span>
            <span className="monument" style={{ fontSize: 11, color: '#999', letterSpacing: '0.08em' }}>
              QUESTION {fitQuestionIndex + 1} OF {totalQuestions}
            </span>
          </div>

          {/* Question card */}
          <div key={`${fitMemberIndex}-${fitQuestionIndex}`} className="animate-in">
            {/* Member name header */}
            <div style={{ marginBottom: 24, padding: '12px 16px', background: '#F8F8F8', borderLeft: '4px solid #000' }}>
              <div className="monument" style={{ fontSize: 10, color: '#999', marginBottom: 4 }}>EVALUATING</div>
              <div className="riforma-bold" style={{ fontSize: 22 }}>
                {(currentMember.name || `Team Member ${fitMemberIndex + 1}`).substring(0, 60)}
                {currentMember.role && <span style={{ fontWeight: 'normal', color: '#666', fontSize: 18 }}> — {currentMember.role.substring(0, 50)}</span>}
              </div>
            </div>

            {/* Dimension badge */}
            <div className="monument" style={{ fontSize: 11, letterSpacing: '0.1em', color: '#666', marginBottom: 12 }}>
              DIMENSION: {currentQuestion.label}
            </div>

            {/* Question */}
            <h3 className="riforma-bold" style={{ fontSize: 32, lineHeight: 1.3, marginBottom: 20 }}>
              {currentQuestion.question}
            </h3>

            {/* Context */}
            <div style={{ background: '#FFFBEB', borderLeft: '3px solid #F59E0B', padding: '12px 16px', marginBottom: 28, fontSize: 15, color: '#555', lineHeight: 1.6 }}>
              {currentQuestion.context}
            </div>

            {/* Rating */}
            <div className={`p-6 mb-4 border-2 ${currentQuestion.bg || 'border-gray-200'}`} style={{ background: currentQuestion.bg ? undefined : '#fff' }}>
              <label className="monument text-sm block mb-3">
                RATE {currentQuestion.label} <span style={{ color: '#EF4444' }}>*</span>
              </label>
              <RatingScale
                value={currentScore}
                onChange={(score) => updateTeamMember(currentMember.id, currentQuestion.key, score)}
              />

              <label className="monument text-xs block mb-2" style={{ marginTop: 16, color: '#666' }}>
                NOTES (OPTIONAL)
              </label>
              <textarea
                value={currentNotes}
                onChange={(e) => updateTeamMember(currentMember.id, currentQuestion.notesKey, e.target.value)}
                placeholder={currentQuestion.placeholder}
                className="w-full"
                rows={3}
              />
              <div className="char-counter">{currentNotes.length}/500</div>
            </div>

            {/* Navigation */}
            <div style={{ display: 'flex', gap: 12, marginTop: 8 }}>
              {(fitMemberIndex > 0 || fitQuestionIndex > 0) && (
                <button
                  className="btn-wiz-back"
                  onClick={goBackQuestion}
                  style={{ flexShrink: 0 }}
                >
                  ← BACK
                </button>
              )}
              <button
                className="btn-wiz-next"
                disabled={!canAdvance || aiReviewingQ}
                onClick={advanceQuestion}
                style={{ flex: 1 }}
              >
                {aiReviewingQ
                  ? 'AI COACH REVIEWING...'
                  : isLastQuestion
                    ? 'COMPLETE FIT ANALYSIS →'
                    : fitQuestionIndex < totalQuestions - 1
                      ? `NEXT QUESTION →`
                      : `NEXT MEMBER →`}
              </button>
            </div>

            {!canAdvance && (
              <p className="monument" style={{ fontSize: 10, color: '#999', marginTop: 8, textAlign: 'center' }}>
                SELECT A RATING TO CONTINUE
              </p>
            )}
          </div>
        </div>
      );
    }

    // Step 3: ABC Classification
    function Step3Page({ data, updateTeamMember, abcIdx, setAbcIdx }) {
      const members = data.teamMembers || [];
      const member = members[abcIdx];
      const hasFilled = (i) => {
        const m = members[i];
        return m && (m.abcRating || '').length >= 1 && (m.abcReasoning || '').length >= 50;
      };

      if (!member) return null;

      return (
        <div key={abcIdx} className="animate-in">
            <div className="numbered-section mb-8">03. ABC CLASSIFICATION</div>

            <h3 className="riforma-bold text-5xl mb-8">
              Classify each team member as A, B, or C player
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12">
              <p className="text-2xl italic">
                "A-players drive results AND culture. B-players are good but not great. C-players are low performers or cultural misfits. Be brutally honest, not sentimental."
              </p>
            </div>

            <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-8">
              <h4 className="riforma-bold text-2xl mb-4">ABC DEFINITIONS</h4>
              <div className="grid grid-cols-3 gap-4 text-base">
                <div className="border-l-4 border-black pl-4">
                  <p className="riforma-bold text-lg mb-2">A PLAYERS</p>
                  <p>Great performers + cultural fit + high potential. They deliver consistently and elevate others.</p>
                </div>
                <div className="border-l-4 border-yellow-600 pl-4">
                  <p className="riforma-bold text-lg mb-2">B PLAYERS</p>
                  <p>Good but not great, or performing without cultural fit. Solid contributors with limitations.</p>
                </div>
                <div className="border-l-4 border-red-600 pl-4">
                  <p className="riforma-bold text-lg mb-2">C PLAYERS</p>
                  <p>Low performers or cultural misfits. They drain energy and slow momentum.</p>
                </div>
              </div>
            </div>

            <div style={{ display: 'flex', gap: 8, marginBottom: 24, flexWrap: 'wrap' }}>
              {members.map((_, i) => (
                <button key={i} onClick={() => setAbcIdx(i)} style={{
                  width: 44, height: 44, border: `2px solid ${abcIdx === i ? '#000' : hasFilled(i) ? '#000' : '#E5E7EB'}`,
                  background: abcIdx === i ? '#000' : hasFilled(i) ? '#F0F0F0' : '#fff',
                  color: abcIdx === i ? '#FFF469' : hasFilled(i) ? '#000' : '#999',
                  fontFamily: "'Monument', monospace", fontSize: 14, fontWeight: 700, cursor: 'pointer', transition: 'all 0.2s'
                }}>{String(i + 1).padStart(2, '0')}</button>
              ))}
            </div>

            <div className="border-4 border-gray-200 p-6 mb-12">
              <h4 className="riforma-bold text-3xl mb-6">
                {(member.name || 'Team Member').substring(0, 50)} - {(member.role || 'Role').substring(0, 50)}
              </h4>

              <div className="mb-6">
                <p className="text-lg mb-2 text-gray-500">
                  FIT Scores: Energy {member.energyScore || 0} | Skill {member.skillScore || 0} | Values {member.valuesScore || 0} | Impact {member.impactScore || 0}
                </p>
              </div>

              {/* ABC Rating */}
              <div className="mb-6">
                <label className="monument text-sm block mb-3">ABC CLASSIFICATION <span className="text-red-500">*</span></label>
                <div className="flex gap-4">
                  <button
                    type="button"
                    onClick={() => updateTeamMember(member.id, 'abcRating', 'A')}
                    className={`abc-badge a ${(member.abcRating || '') === 'A' ? 'selected' : ''}`}
                  >
                    A PLAYER
                  </button>
                  <button
                    type="button"
                    onClick={() => updateTeamMember(member.id, 'abcRating', 'B')}
                    className={`abc-badge b ${(member.abcRating || '') === 'B' ? 'selected' : ''}`}
                  >
                    B PLAYER
                  </button>
                  <button
                    type="button"
                    onClick={() => updateTeamMember(member.id, 'abcRating', 'C')}
                    className={`abc-badge c ${(member.abcRating || '') === 'C' ? 'selected' : ''}`}
                  >
                    C PLAYER
                  </button>
                </div>
              </div>

              {/* Reasoning */}
              <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-4">
                <label className="monument text-sm block mb-2">ABC REASONING <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-500 mb-2">Why did you classify them this way? Be specific about performance, culture fit, and potential.</p>
                <textarea
                  value={member.abcReasoning || ''}
                  onChange={(e) => updateTeamMember(member.id, 'abcReasoning', e.target.value)}
                  placeholder="Example: 'Classified as B player because performance is solid (delivers on time, meets targets) but lacks strategic thinking needed for next level. Cultural fit is strong, aligns with values. Limited growth potential in current role—may need lateral move to stay engaged.'"
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{(member.abcReasoning || '').length}/1000 (min 50)</div>
              </div>

              {/* Additional Notes */}
              <div className="grid grid-cols-3 gap-4">
                <div>
                  <label className="monument text-xs block mb-2">PERFORMANCE NOTES</label>
                  <textarea
                    value={member.performanceNotes || ''}
                    onChange={(e) => updateTeamMember(member.id, 'performanceNotes', e.target.value)}
                    placeholder="Specific results and contributions"
                    className="w-full text-sm"
                    rows={3}
                  />
                  <div className="char-counter text-xs">{(member.performanceNotes || '').length}/500</div>
                </div>
                <div>
                  <label className="monument text-xs block mb-2">CULTURE NOTES</label>
                  <textarea
                    value={member.cultureNotes || ''}
                    onChange={(e) => updateTeamMember(member.id, 'cultureNotes', e.target.value)}
                    placeholder="Values alignment and behavior"
                    className="w-full text-sm"
                    rows={3}
                  />
                  <div className="char-counter text-xs">{(member.cultureNotes || '').length}/500</div>
                </div>
                <div>
                  <label className="monument text-xs block mb-2">POTENTIAL NOTES</label>
                  <textarea
                    value={member.potentialNotes || ''}
                    onChange={(e) => updateTeamMember(member.id, 'potentialNotes', e.target.value)}
                    placeholder="Future growth and development capacity"
                    className="w-full text-sm"
                    rows={3}
                  />
                  <div className="char-counter text-xs">{(member.potentialNotes || '').length}/500</div>
                </div>
              </div>
            </div>

        </div>
      );
    }

    // Step 4: Action Plans
    function Step4Page({ data, updateTeamMember }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">04. ACTION PLANS</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Create development and action plans for each team member
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                "Assessment without action is wasted effort. This is where leadership courage meets talent strategy. Focus especially on B and C players."
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-300">
              Define specific actions for each person. A-players need retention and stretch. B-players need development or role changes. C-players need performance plans or transitions.
            </p>

            <div className="space-y-8 mb-12">
              {(data.teamMembers || []).map((member, index) => (
                <div key={member.id} style={{ border: '1px solid #E0E0E0', padding: 24, marginBottom: 16 }} className="animate-in">
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: 20 }}>
                    <div>
                      <div className="plaak" style={{ fontSize: 20, marginBottom: 8 }}>
                        {(member.name || 'Team Member').substring(0, 50)} — {(member.role || 'Role').substring(0, 50)}
                      </div>
                      <div style={{ display: 'flex', gap: 12, alignItems: 'center' }}>
                        <span className={`abc-badge ${(member.abcRating || '').toLowerCase()} ${member.abcRating ? 'selected' : ''}`} style={{ fontSize: 13 }}>
                          {member.abcRating || 'NOT RATED'} PLAYER
                        </span>
                        <span style={{ fontFamily: "'Monument', monospace", fontSize: 11, color: '#666' }}>
                          FIT Avg: {member.energyScore && member.skillScore && member.valuesScore && member.impactScore ?
                            ((member.energyScore + member.skillScore + member.valuesScore + member.impactScore) / 4).toFixed(1) : 'N/A'}
                        </span>
                      </div>
                    </div>
                  </div>

                  <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>
                    <div style={{ border: '1px solid #E0E0E0', padding: 16 }}>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 8, letterSpacing: '0.06em' }}>DEVELOPMENT NEEDS</label>
                      <textarea
                        value={member.developmentNeeds || ''}
                        onChange={(e) => updateTeamMember(member.id, 'developmentNeeds', e.target.value)}
                        placeholder="What skills, knowledge, or experience do they need to develop? Be specific."
                        style={{ width: '100%' }}
                        rows={3}
                      />
                    </div>

                    <div style={{ border: '1px solid #E0E0E0', padding: 16 }}>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 8, letterSpacing: '0.06em' }}>COACHING PLAN</label>
                      <textarea
                        value={member.coachingPlan || ''}
                        onChange={(e) => updateTeamMember(member.id, 'coachingPlan', e.target.value)}
                        placeholder="What support, mentoring, or coaching will you provide? How often will you meet?"
                        style={{ width: '100%' }}
                        rows={3}
                      />
                    </div>

                    <div style={{ border: '1px solid #E0E0E0', padding: 16 }}>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 8, letterSpacing: '0.06em' }}>ROLE CHANGES</label>
                      <textarea
                        value={member.roleChanges || ''}
                        onChange={(e) => updateTeamMember(member.id, 'roleChanges', e.target.value)}
                        placeholder="Should their role, responsibilities, or position change? Lateral move? Promotion? Demotion?"
                        style={{ width: '100%' }}
                        rows={3}
                      />
                    </div>

                    <div style={{ border: '1px solid #E0E0E0', borderLeft: '4px solid #000', padding: 16 }}>
                      <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 8, letterSpacing: '0.06em' }}>TIMELINE</label>
                      <textarea
                        value={member.timeline || ''}
                        onChange={(e) => updateTeamMember(member.id, 'timeline', e.target.value)}
                        placeholder="When will these actions happen? Specific dates or timeframes (Q2 2025, next 30 days, etc.)"
                        style={{ width: '100%' }}
                        rows={2}
                      />
                    </div>

                    {(member.abcRating === 'C' || member.abcRating === 'B') && (
                      <div style={{ border: '1px solid #FECACA', borderLeft: '4px solid #DC2626', padding: 16, background: '#FEF2F2' }}>
                        <label style={{ fontFamily: "'Monument', monospace", fontSize: 11, display: 'block', marginBottom: 8, letterSpacing: '0.06em', color: '#DC2626' }}>TOUGH DECISIONS</label>
                        <textarea
                          value={member.toughDecisions || ''}
                          onChange={(e) => updateTeamMember(member.id, 'toughDecisions', e.target.value)}
                          placeholder="Performance improvement plan? Transition out? Exit conversation? When and how will you address this?"
                          style={{ width: '100%' }}
                          rows={3}
                        />
                      </div>
                    )}
                  </div>
                </div>
              ))}
            </div>

        </div>
      );
    }

    // Canvas Page
    function CanvasPage({ data, onExport, onSubmit }) {
      const teamMembers = data.teamMembers || [];

      const aPlayers = teamMembers.filter(m => m.abcRating === 'A');
      const bPlayers = teamMembers.filter(m => m.abcRating === 'B');
      const cPlayers = teamMembers.filter(m => m.abcRating === 'C');

      const calcAvgFit = (member) => {
        const scores = [
          member.energyScore || 0,
          member.skillScore || 0,
          member.valuesScore || 0,
          member.impactScore || 0
        ].filter(s => s > 0);
        return scores.length > 0 ? (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(1) : 'N/A';
      };

      return (
        <div style={{ background: '#fff', minHeight: '100vh' }}>
          <div className="step-content" style={{ maxWidth: 960, margin: '0 auto', padding: '40px 48px' }}>
            <p className="step-indicator">CANVAS</p>
            <div className="opening-box">
              <h1 className="step-heading">FIT & ABC Analysis Canvas</h1>
              <p className="step-hint">Review your complete team evaluation. Export PDF for your records, then submit.</p>
            </div>

            {/* ABC Distribution */}
            <div style={{ marginBottom: 40 }}>
              <div style={{ fontFamily: "'Monument', monospace", fontSize: 10, color: '#999', letterSpacing: '0.12em', textTransform: 'uppercase', marginBottom: 12, paddingBottom: 8, borderBottom: '2px solid #000' }}>ABC DISTRIBUTION</div>
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 16 }}>
                <div style={{ background: '#000', color: '#FFF469', padding: '24px', border: '2px solid #000' }}>
                  <div className="plaak" style={{ fontSize: 64, lineHeight: 1, marginBottom: 8 }}>{aPlayers.length}</div>
                  <p style={{ fontWeight: 700, fontSize: 16, marginBottom: 4 }}>A PLAYERS</p>
                  <p style={{ fontSize: 13, color: '#ccc' }}>Great performance + cultural fit + high potential</p>
                </div>
                <div style={{ background: '#F5F5F5', color: '#333', padding: '24px', border: '2px solid #666' }}>
                  <div className="plaak" style={{ fontSize: 64, lineHeight: 1, marginBottom: 8, color: '#333' }}>{bPlayers.length}</div>
                  <p style={{ fontWeight: 700, fontSize: 16, marginBottom: 4 }}>B PLAYERS</p>
                  <p style={{ fontSize: 13, color: '#666' }}>Good but not great, or performing without cultural fit</p>
                </div>
                <div style={{ background: '#FEF2F2', color: '#333', padding: '24px', border: '2px solid #DC2626' }}>
                  <div className="plaak" style={{ fontSize: 64, lineHeight: 1, marginBottom: 8, color: '#DC2626' }}>{cPlayers.length}</div>
                  <p style={{ fontWeight: 700, fontSize: 16, marginBottom: 4 }}>C PLAYERS</p>
                  <p style={{ fontSize: 13, color: '#666' }}>Low performers or cultural misfits</p>
                </div>
              </div>
            </div>

            {/* Team Member Summaries */}
            <div style={{ marginBottom: 40 }}>
              <div style={{ fontFamily: "'Monument', monospace", fontSize: 10, color: '#999', letterSpacing: '0.12em', textTransform: 'uppercase', marginBottom: 12, paddingBottom: 8, borderBottom: '2px solid #000' }}>TEAM MEMBER SUMMARIES</div>
              <div id="canvas-content">
                {teamMembers.map((member) => (
                  <div key={member.id} style={{ border: '1px solid #E0E0E0', padding: 24, marginBottom: 16 }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: 16 }}>
                      <div>
                        <div style={{ fontWeight: 700, fontSize: 20 }}>{member.name || 'Team Member'} — {member.role || 'Role'}</div>
                        {member.tenure && <div style={{ fontSize: 13, color: '#666', marginTop: 2 }}>Tenure: {member.tenure}</div>}
                      </div>
                      <div style={{ textAlign: 'right' }}>
                        <div className={`abc-badge ${(member.abcRating || '').toLowerCase()} ${member.abcRating ? 'selected' : ''}`} style={{ fontSize: 16, marginBottom: 4 }}>
                          {member.abcRating || '?'}
                        </div>
                        <div style={{ fontSize: 12, color: '#666', fontFamily: "'Monument', monospace" }}>FIT AVG: {calcAvgFit(member)}</div>
                      </div>
                    </div>
                    {/* FIT Scores */}
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: 8, marginBottom: 16 }}>
                      {[['ENERGY', member.energyScore], ['SKILL', member.skillScore], ['VALUES', member.valuesScore], ['IMPACT', member.impactScore]].map(([label, score]) => (
                        <div key={label} style={{ background: '#F5F5F5', padding: '10px 12px', borderLeft: '4px solid #000' }}>
                          <div style={{ fontFamily: "'Monument', monospace", fontSize: 9, color: '#999', textTransform: 'uppercase', marginBottom: 4 }}>{label}</div>
                          <div style={{ fontSize: 22, fontWeight: 700 }}>{score || 0}/5</div>
                        </div>
                      ))}
                    </div>
                    {/* ABC Reasoning */}
                    {member.abcReasoning && (
                      <div style={{ background: '#F9F9F9', borderLeft: '4px solid #000', padding: '12px 16px', marginBottom: 12 }}>
                        <div style={{ fontFamily: "'Monument', monospace", fontSize: 9, color: '#999', textTransform: 'uppercase', marginBottom: 4 }}>ABC REASONING</div>
                        <div style={{ fontSize: 13, color: '#333', lineHeight: 1.6 }}>{(member.abcReasoning || '').substring(0, 300)}</div>
                      </div>
                    )}
                    {/* Action Plan */}
                    {(member.developmentNeeds || member.coachingPlan || member.toughDecisions) && (
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 12 }}>
                        {member.developmentNeeds && <div style={{ borderLeft: '4px solid #000', paddingLeft: 12 }}><div style={{ fontFamily: "'Monument', monospace", fontSize: 9, color: '#999', textTransform: 'uppercase', marginBottom: 4 }}>DEVELOPMENT</div><div style={{ fontSize: 13 }}>{(member.developmentNeeds || '').substring(0, 120)}</div></div>}
                        {member.coachingPlan && <div style={{ borderLeft: '4px solid #000', paddingLeft: 12 }}><div style={{ fontFamily: "'Monument', monospace", fontSize: 9, color: '#999', textTransform: 'uppercase', marginBottom: 4 }}>COACHING</div><div style={{ fontSize: 13 }}>{(member.coachingPlan || '').substring(0, 120)}</div></div>}
                        {member.toughDecisions && <div style={{ borderLeft: '4px solid #DC2626', paddingLeft: 12 }}><div style={{ fontFamily: "'Monument', monospace", fontSize: 9, color: '#DC2626', textTransform: 'uppercase', marginBottom: 4 }}>TOUGH DECISIONS</div><div style={{ fontSize: 13 }}>{(member.toughDecisions || '').substring(0, 120)}</div></div>}
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </div>

            {/* Key Actions */}
            <div style={{ border: '2px solid #000', padding: 24, marginBottom: 32 }}>
              <div className="plaak" style={{ fontSize: 16, marginBottom: 12 }}>KEY ACTIONS REQUIRED</div>
              <div style={{ display: 'flex', flexDirection: 'column', gap: 6, fontSize: 14 }}>
                <p><strong>A PLAYERS ({aPlayers.length}):</strong> Retain, stretch, and develop for leadership</p>
                <p><strong>B PLAYERS ({bPlayers.length}):</strong> Provide clear development paths or consider role changes</p>
                <p><strong>C PLAYERS ({cPlayers.length}):</strong> Performance improvement plans or transition conversations needed</p>
              </div>
            </div>

            {/* Action Buttons */}
            <div style={{ display: 'flex', gap: 16, marginBottom: 24 }}>
              <button onClick={onExport} className="btn-wiz-next" style={{ flex: 1 }}>EXPORT PDF</button>
              <button onClick={onSubmit} className="btn-wiz-next" style={{ flex: 1, background: '#FFF469', color: '#000', borderColor: '#FFF469' }}>SUBMIT ANSWERS</button>
            </div>
          </div>
        </div>
      );
    }

    // Progress Indicator
    function ProgressIndicator({ currentStep }) {
      const steps = [
        { number: 1, label: 'Team List' },
        { number: 2, label: 'FIT Analysis' },
        { number: 3, label: 'ABC Rating' },
        { number: 4, label: 'Action Plans' }
      ];

      return (
        <div className="flex items-center justify-center gap-4 mb-12">
          {steps.map((step, index) => (
            <Fragment key={step.number}>
              <div className="flex flex-col items-center">
                <div className={`progress-dot ${step.number === currentStep ? 'active' : ''} ${step.number < currentStep ? 'completed' : ''}`}></div>
                <div className="monument text-xs mt-2">{step.label}</div>
              </div>
              {index < steps.length - 1 && <div className="progress-line w-12"></div>}
            </Fragment>
          ))}
        </div>
      );
    }

    // Render App
        ReactDOM.render(<FitAbcApp />, document.getElementById('root'));
  </script>
</body>
</html>
