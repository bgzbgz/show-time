<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5 Dysfunctions of a Team | Fast Track</title>
    <meta name="description" content="Interactive workshop tool for analyzing and improving team dynamics using Lencioni's 5 Dysfunctions model">

    <!-- React 18 -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Chart.js for radar visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>

    <!-- PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- ToolDB shared library -->
    <script src="../../shared/js/tool-db.js"></script>
    <script src="../../shared/js/ai-challenge.js"></script>
    <!-- Dependency Injection -->
    <script src="../../shared/js/dependency-injection.js"></script>

    <!-- Cognitive Load Components -->
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>
    <script src="../../js/tool-access-control.js"></script>

    <style>
        /* Font Face Declarations */
        @font-face {
            font-family: 'Plaak';
            src: url('Plaak3Trial-43-Bold.woff2') format('woff2');
            font-weight: bold;
        }

        @font-face {
            font-family: 'Riforma';
            src: url('RiformaLL-Regular.woff2') format('woff2');
            font-weight: normal;
        }

        @font-face {
            font-family: 'RiformaMedium';
            src: url('RangleRiformaWeb-Medium.woff2') format('woff2');
            font-weight: 500;
        }

        @font-face {
            font-family: 'Monument';
            src: url('MonumentGrotesk-Mono.woff2') format('woff2');
            font-weight: normal;
        }

        /* CSS Custom Properties */
        :root {
            --ft-yellow: #FFF469;
            --ft-black: #000000;
            --ft-white: #FFFFFF;
            --ft-grey-light: #F3F4F6;
            --ft-grey-dark: #9CA3AF;
            --ft-green: #10B981;
            --ft-red: #EF4444;
        }

        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Riforma', -apple-system, sans-serif;
            font-size: 16px;
            color: var(--ft-black);
            background: var(--ft-white);
            -webkit-font-smoothing: antialiased;
            line-height: 1.6;
        }

        /* Typography Classes */
        .plaak {
            font-family: 'Plaak', sans-serif;
            font-weight: bold;
            letter-spacing: -0.01em;
            line-height: 1.2;
        }

        .riforma {
            font-family: 'Riforma', sans-serif;
        }

        .monument {
            font-family: 'Monument', monospace;
            letter-spacing: 0.02em;
        }

        /* Button Styles */
        .btn-primary {
            background: var(--ft-black);
            color: var(--ft-white);
            padding: 12px 24px;
            border: 2px solid var(--ft-black);
            font-family: 'Riforma', sans-serif;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .btn-primary:hover:not(:disabled) {
            transform: scale(1.02);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-primary:disabled {
            background: #E0E0E0;
            border-color: #E0E0E0;
            color: var(--ft-grey-dark);
            cursor: not-allowed;
            opacity: 0.5;
        }

        .btn-secondary {
            background: var(--ft-white);
            color: var(--ft-black);
            padding: 12px 24px;
            border: 2px solid var(--ft-black);
            font-family: 'Riforma', sans-serif;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--ft-black);
            color: var(--ft-white);
        }

        .btn-secondary:disabled {
            border-color: #E0E0E0;
            color: var(--ft-grey-dark);
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* Input Styles */
        .worksheet-input {
            border: 1px solid #E0E0E0;
            padding: 12px 16px;
            font-family: 'Riforma', sans-serif;
            font-size: 16px;
            transition: border-color 0.2s ease;
            background: var(--ft-white);
            width: 100%;
            border-radius: 4px;
        }

        .worksheet-input:focus {
            outline: none;
            border-color: var(--ft-black);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }

        .worksheet-input.error {
            border-color: var(--ft-red);
        }

        /* Progress Dots */
        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #E0E0E0;
            transition: all 0.3s ease;
        }

        .progress-dot.filled {
            background: var(--ft-black);
        }

        .progress-dot.current {
            background: var(--ft-yellow);
            border: 2px solid var(--ft-black);
            width: 16px;
            height: 16px;
        }

        .progress-dot.clickable {
            cursor: pointer;
        }

        .progress-dot.clickable:hover {
            transform: scale(1.2);
        }

        /* Sticky Footer */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--ft-white);
            border-top: 1px solid #E0E0E0;
            padding: 16px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
            z-index: 100;
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid #E0E0E0;
            border-top: 4px solid var(--ft-black);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Badge Styles */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
        }

        .badge-green {
            background: #D1FAE5;
            color: #065F46;
        }

        .badge-yellow {
            background: var(--ft-yellow);
            color: var(--ft-black);
        }

        .badge-red {
            background: #FEE2E2;
            color: #991B1B;
        }

        /* Committed Row */
        .committed-row {
            background: #F0FDF4;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Configuration
        const CONFIG = {
            SUPABASE_URL: 'https://lutzzfaedkbsmbobmrzx.supabase.co',
            SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1dHp6ZmFlZGtic21ib2Jtcnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MDA0MDQsImV4cCI6MjA4NjM3NjQwNH0.o2gJba85vDl4NLS-C8Mq3OudWKxet-b0IqO9kazqb8U',
            TOOL_SLUG: 'team',
            AUTOSAVE_DELAY: 2000
        };

        const supabase = window.supabase.createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);

        const TOOL_SLUG = CONFIG.TOOL_SLUG;
        const STORAGE_KEY = 'fasttrack_team_tool';

        // Make Supabase client globally available for dependency injection
        window.supabaseClient = supabase;

        // Initialize ToolDB and dependency injection
        ToolDB.init(CONFIG.TOOL_SLUG);
        ToolAccessControl.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        CognitiveLoad.init('team', {"insights":["A team is only as strong as its weakest dysfunction. Identify and address the top 3.","Accountability without trust is tyranny. Trust without accountability is negligence."],"caseStudy":{"before":"[PLACEHOLDER] Team meetings were polite but unproductive.","after":"[PLACEHOLDER] Dysfunction scores improved from 3/10 to 7/10.","quote":"[PLACEHOLDER] The dysfunction assessment was uncomfortable but transformative."}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

        // Alias ScienceBox as TheScience for backward compatibility with existing JSX
        const TheScience = ({ children }) => (
            <ScienceBox collapsible={true}>{children}</ScienceBox>
        );

        // Progress Dots Component
        const ProgressDots = ({ currentStep, onDotClick }) => {
            const steps = [0, 1, 2, 3, 4, 5, 6];

            return (
                <div className="flex items-center justify-center gap-3 mb-8">
                    {steps.map(stepIndex => {
                        const isCurrent = stepIndex === currentStep;
                        const isFilled = stepIndex < currentStep;
                        const isClickable = stepIndex < currentStep;

                        return (
                            <div
                                key={stepIndex}
                                className={`progress-dot ${isFilled ? 'filled' : ''} ${isCurrent ? 'current' : ''} ${isClickable ? 'clickable' : ''}`}
                                onClick={() => isClickable && onDotClick(stepIndex)}
                                title={`Step ${stepIndex}`}
                            />
                        );
                    })}
                </div>
            );
        };

        // Utility Functions
        const trimText = (text) => text?.trim() || '';

        const calculateDysfunctionScores = (teamMembers) => {
            if (!teamMembers || teamMembers.length === 0) return null;

            const membersWithAssessments = teamMembers.filter(m => m.assessment);
            if (membersWithAssessments.length === 0) return null;

            const dysfunctions = ['trust', 'conflict', 'commitment', 'accountability', 'results'];
            const scores = {};

            dysfunctions.forEach(d => {
                const total = membersWithAssessments.reduce((sum, member) => {
                    return sum + (member.assessment[d] || 0);
                }, 0);
                scores[d] = Math.round((total / membersWithAssessments.length) * 100) / 100;
            });

            return scores;
        };

        const getSeverityBadge = (score) => {
            if (score >= 1 && score < 4) {
                return { color: 'green', label: 'Strength' };
            } else if (score >= 4 && score < 7) {
                return { color: 'yellow', label: 'Opportunity' };
            } else if (score >= 7 && score <= 10) {
                return { color: 'red', label: 'Priority' };
            }
            return { color: 'grey', label: 'Unknown' };
        };

        const sortDysfunctionsByScore = (scores) => {
            if (!scores) return [];

            const dysfunctionNames = {
                trust: 'Absence of Trust',
                conflict: 'Fear of Conflict',
                commitment: 'Lack of Commitment',
                accountability: 'Avoidance of Accountability',
                results: 'Inattention to Results'
            };

            return Object.entries(scores)
                .map(([key, score]) => ({ key, name: dysfunctionNames[key], score }))
                .sort((a, b) => b.score - a.score);
        };

        // Step 0: Cover Page
        const Step0 = ({ onNext }) => (
            <div className="max-w-2xl mx-auto px-4 py-12 text-center space-y-8 min-h-screen flex flex-col justify-center">
                <h1 className="plaak text-5xl md:text-6xl mb-4">5 Dysfunctions of a Team</h1>
                <p className="riforma text-2xl text-gray-700 mb-6">Workshop Tool</p>
                <p className="riforma text-lg text-gray-600 max-w-xl mx-auto mb-8">
                    Transform your team dynamics with this interactive tool based on Patrick Lencioni's groundbreaking model.
                    Auto-calculate scores, visualize results, and create concrete action plans with digital commitment tracking.
                </p>
                <div className="space-y-4">
                    <button onClick={onNext} className="btn-primary text-lg px-8 py-4">
                        Start Workshop
                    </button>
                    <p className="text-sm text-gray-500">Fast Track Leadership Development</p>
                </div>
            </div>
        );

        // Step 1: Team Setup
        const Step1 = ({ teamData, setTeamData, userEmail, setUserEmail }) => {
            const [memberName, setMemberName] = useState('');

            const addTeamMember = () => {
                if (!memberName.trim()) return;

                const newMember = {
                    id: Date.now().toString(),
                    name: memberName.trim(),
                    assessment: null
                };

                setTeamData(prev => ({
                    ...prev,
                    teamMembers: [...prev.teamMembers, newMember]
                }));
                setMemberName('');
            };

            const removeMember = (id) => {
                setTeamData(prev => ({
                    ...prev,
                    teamMembers: prev.teamMembers.filter(m => m.id !== id)
                }));
            };

            const updateAssessment = (memberId, dysfunction, value) => {
                setTeamData(prev => ({
                    ...prev,
                    teamMembers: prev.teamMembers.map(m => {
                        if (m.id === memberId) {
                            return {
                                ...m,
                                assessment: {
                                    ...m.assessment,
                                    [dysfunction]: parseInt(value) || 0
                                }
                            };
                        }
                        return m;
                    })
                }));
            };

            return (
                <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                    <h2 className="plaak text-3xl mb-6">Team Setup</h2>

                    <FastTrackInsight>
                        Start by naming your team and adding all members. Then enter individual dysfunction scores (1-10 scale)
                        for each member. The tool will automatically calculate team averages.
                    </FastTrackInsight>

                    {/* Team Name */}
                    <div>
                        <label className="block text-sm font-medium mb-2">Team Name *</label>
                        <input
                            type="text"
                            value={teamData.teamName}
                            onChange={(e) => setTeamData(prev => ({ ...prev, teamName: e.target.value }))}
                            placeholder="Product Team, Engineering, Marketing..."
                            className="worksheet-input"
                        />
                    </div>

                    {/* Add Team Members */}
                    <div>
                        <label className="block text-sm font-medium mb-2">Add Team Members *</label>
                        <div className="flex gap-2">
                            <input
                                type="text"
                                value={memberName}
                                onChange={(e) => setMemberName(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && addTeamMember()}
                                placeholder="Member name"
                                className="worksheet-input"
                            />
                            <button onClick={addTeamMember} className="btn-primary whitespace-nowrap">
                                Add Member
                            </button>
                        </div>
                    </div>

                    {/* Team Members List */}
                    {teamData.teamMembers.length > 0 && (
                        <div className="space-y-4">
                            <h3 className="font-medium text-lg">Team Members ({teamData.teamMembers.length})</h3>
                            {teamData.teamMembers.map(member => (
                                <div key={member.id} className="border border-gray-200 p-4 rounded space-y-3">
                                    <div className="flex justify-between items-center">
                                        <span className="font-medium">{member.name}</span>
                                        <button
                                            onClick={() => removeMember(member.id)}
                                            className="text-red-600 hover:text-red-800 text-sm"
                                        >
                                            Remove
                                        </button>
                                    </div>

                                    <div className="text-sm text-gray-600 mb-2">
                                        Individual Assessment Scores (1=Low dysfunction, 10=High dysfunction)
                                    </div>

                                    <div className="grid grid-cols-1 gap-2">
                                        {[
                                            { key: 'trust', label: 'Absence of Trust' },
                                            { key: 'conflict', label: 'Fear of Conflict' },
                                            { key: 'commitment', label: 'Lack of Commitment' },
                                            { key: 'accountability', label: 'Avoidance of Accountability' },
                                            { key: 'results', label: 'Inattention to Results' }
                                        ].map(({ key, label }) => (
                                            <div key={key} className="flex items-center gap-2">
                                                <label className="text-sm flex-1">{label}:</label>
                                                <input
                                                    type="number"
                                                    min="1"
                                                    max="10"
                                                    value={member.assessment?.[key] || ''}
                                                    onChange={(e) => updateAssessment(member.id, key, e.target.value)}
                                                    className="worksheet-input w-20"
                                                    placeholder="1-10"
                                                />
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // Step 2: Team Summary & Radar Chart
        const Step2 = ({ teamData }) => {
            const chartRef = useRef(null);
            const chartInstanceRef = useRef(null);

            const scores = calculateDysfunctionScores(teamData.teamMembers);

            useEffect(() => {
                if (scores && chartRef.current) {
                    // Destroy existing chart
                    if (chartInstanceRef.current) {
                        chartInstanceRef.current.destroy();
                    }

                    const ctx = chartRef.current.getContext('2d');
                    chartInstanceRef.current = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: [
                                'Absence of Trust',
                                'Fear of Conflict',
                                'Lack of Commitment',
                                'Avoidance of Accountability',
                                'Inattention to Results'
                            ],
                            datasets: [{
                                label: 'Team Scores',
                                data: [
                                    scores.trust,
                                    scores.conflict,
                                    scores.commitment,
                                    scores.accountability,
                                    scores.results
                                ],
                                backgroundColor: 'rgba(255, 244, 105, 0.2)',
                                borderColor: '#000000',
                                borderWidth: 2,
                                pointBackgroundColor: '#000000',
                                pointBorderColor: '#000000',
                                pointRadius: 4
                            }]
                        },
                        options: {
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    min: 0,
                                    max: 10,
                                    ticks: {
                                        stepSize: 2
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }

                return () => {
                    if (chartInstanceRef.current) {
                        chartInstanceRef.current.destroy();
                    }
                };
            }, [scores]);

            if (!scores) {
                return (
                    <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                        <h2 className="plaak text-3xl mb-6">Team Summary</h2>
                        <div className="bg-yellow-50 border border-yellow-200 p-4 rounded">
                            <p className="text-yellow-800">
                                Add team members and enter their assessment scores in Step 1 to see the team summary and radar chart.
                            </p>
                        </div>
                    </div>
                );
            }

            const sorted = sortDysfunctionsByScore(scores);

            return (
                <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                    <h2 className="plaak text-3xl mb-6">Team Summary</h2>

                    <TheScience>
                        Patrick Lencioni's model shows how team dysfunctions build on each other like a pyramid.
                        Without trust, teams can't have productive conflict. Without conflict, there's no real commitment.
                        And so on. Focus on your highest-scoring dysfunctions first.
                    </TheScience>

                    {/* Scores Table */}
                    <div>
                        <h3 className="font-medium text-lg mb-4">Dysfunction Scores</h3>
                        <div className="border border-gray-200 rounded overflow-hidden">
                            <table className="w-full">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-4 py-2 text-left text-sm font-medium">Dysfunction</th>
                                        <th className="px-4 py-2 text-center text-sm font-medium">Score</th>
                                        <th className="px-4 py-2 text-center text-sm font-medium">Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {sorted.map(({ key, name, score }) => {
                                        const badge = getSeverityBadge(score);
                                        return (
                                            <tr key={key} className="border-t border-gray-200">
                                                <td className="px-4 py-3 text-sm">{name}</td>
                                                <td className="px-4 py-3 text-center font-medium">{score.toFixed(1)}</td>
                                                <td className="px-4 py-3 text-center">
                                                    <span className={`badge badge-${badge.color}`}>
                                                        {badge.label}
                                                    </span>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {/* Radar Chart */}
                    <div>
                        <h3 className="font-medium text-lg mb-4">Team Dysfunction Profile</h3>
                        <div className="bg-white p-6 border border-gray-200 rounded">
                            <canvas ref={chartRef} id="radarChart" />
                        </div>
                    </div>
                </div>
            );
        };

        // Step 3: Improvement Plan
        const Step3 = ({ teamData, setTeamData }) => {
            const scores = calculateDysfunctionScores(teamData.teamMembers);
            const topDysfunctions = scores ? sortDysfunctionsByScore(scores).slice(0, 3) : [];

            const updateImprovementNote = (dysfunctionKey, note) => {
                setTeamData(prev => {
                    const existing = prev.improvementPlan.find(p => p.dysfunction === dysfunctionKey);
                    if (existing) {
                        return {
                            ...prev,
                            improvementPlan: prev.improvementPlan.map(p =>
                                p.dysfunction === dysfunctionKey ? { ...p, note } : p
                            )
                        };
                    } else {
                        return {
                            ...prev,
                            improvementPlan: [...prev.improvementPlan, { dysfunction: dysfunctionKey, note }]
                        };
                    }
                });
            };

            return (
                <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                    <h2 className="plaak text-3xl mb-6">Improvement Plan</h2>

                    <FastTrackInsight>
                        Focus on your top 3 dysfunctions. Trying to fix everything at once leads to overwhelm and inaction.
                        Write specific improvement strategies for each priority area.
                    </FastTrackInsight>

                    <div className="space-y-6">
                        {topDysfunctions.map(({ key, name, score }, index) => {
                            const badge = getSeverityBadge(score);
                            const existingNote = teamData.improvementPlan.find(p => p.dysfunction === key)?.note || '';

                            return (
                                <div key={key} className="border border-gray-200 p-6 rounded space-y-4">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <h3 className="font-medium text-lg">#{index + 1} Priority: {name}</h3>
                                            <div className="flex items-center gap-2 mt-1">
                                                <span className="text-sm text-gray-600">Score: {score.toFixed(1)}</span>
                                                <span className={`badge badge-${badge.color} text-xs`}>
                                                    {badge.label}
                                                </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium mb-2">
                                            How will your team improve in this area?
                                        </label>
                                        <textarea
                                            value={existingNote}
                                            onChange={(e) => updateImprovementNote(key, e.target.value)}
                                            placeholder="Describe specific strategies, behaviors to change, or practices to implement..."
                                            className="worksheet-input min-h-[100px]"
                                        />
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        // Step 4: Action Plan with Validation
        const Step4 = ({ teamData, setTeamData }) => {
            const updateAction = (index, field, value) => {
                setTeamData(prev => {
                    const actions = [...prev.actionPlan];
                    if (!actions[index]) {
                        actions[index] = { what: '', who: '', when: '' };
                    }
                    actions[index] = { ...actions[index], [field]: value };
                    return { ...prev, actionPlan: actions };
                });
            };

            const validateAction = (action) => {
                if (!action) return false;
                return (
                    trimText(action.what).length >= 30 &&
                    action.who &&
                    action.who !== '' &&
                    action.when &&
                    action.when !== ''
                );
            };

            const actions = [0, 1, 2].map(i => teamData.actionPlan[i] || { what: '', who: '', when: '' });
            const validActions = actions.filter(validateAction).length;

            const today = new Date().toISOString().split('T')[0];

            // Check for duplicate assignments
            const getDuplicateWarning = (index) => {
                const action = actions[index];
                if (!action.who || !action.when) return null;

                const duplicates = actions.filter((a, i) =>
                    i !== index && a.who === action.who && a.when === action.when
                );

                if (duplicates.length > 0) {
                    return `‚ö†Ô∏è ${action.who} has multiple actions due ${action.when}`;
                }
                return null;
            };

            return (
                <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                    <h2 className="plaak text-3xl mb-6">Action Plan</h2>

                    <FastTrackInsight>
                        Create 3 concrete actions. Each must have: (1) a specific description (30+ characters),
                        (2) a single owner (no "All" or "Everyone"), and (3) a specific deadline (no "Ongoing").
                        Vague commitments fail.
                    </FastTrackInsight>

                    <div className="bg-gray-50 p-4 rounded mb-6">
                        <p className="text-sm font-medium">
                            Progress: {validActions} of 3 actions complete
                        </p>
                    </div>

                    <div className="space-y-8">
                        {[0, 1, 2].map(index => {
                            const action = actions[index];
                            const isValid = validateAction(action);
                            const whatLength = trimText(action.what).length;
                            const duplicateWarning = getDuplicateWarning(index);

                            return (
                                <div key={index} className={`border-2 rounded p-6 space-y-4 ${isValid ? 'border-green-500' : 'border-gray-200'}`}>
                                    <div className="flex items-center justify-between">
                                        <h3 className="font-medium text-lg">Action #{index + 1}</h3>
                                        {isValid && <span className="text-green-600 font-medium">‚úì Complete</span>}
                                    </div>

                                    {/* What */}
                                    <div>
                                        <label className="block text-sm font-medium mb-2">
                                            What specific action will be taken? *
                                        </label>
                                        <textarea
                                            value={action.what}
                                            onChange={(e) => updateAction(index, 'what', e.target.value)}
                                            placeholder="Be specific: What exactly will happen? What's the desired outcome?"
                                            className={`worksheet-input min-h-[80px] ${whatLength > 0 && whatLength < 30 ? 'error' : ''}`}
                                        />
                                        <div className="flex justify-between mt-1">
                                            <span className={`text-sm ${whatLength >= 30 ? 'text-green-600' : 'text-gray-500'}`}>
                                                {whatLength} / 30 minimum characters
                                            </span>
                                            {whatLength > 0 && whatLength < 30 && (
                                                <span className="text-sm text-red-600">Add {30 - whatLength} more characters</span>
                                            )}
                                        </div>
                                    </div>

                                    {/* Who */}
                                    <div>
                                        <label className="block text-sm font-medium mb-2">
                                            Who is responsible? *
                                        </label>
                                        <select
                                            value={action.who}
                                            onChange={(e) => updateAction(index, 'who', e.target.value)}
                                            className="worksheet-input"
                                        >
                                            <option value="">Select person...</option>
                                            {teamData.teamMembers.map(member => (
                                                <option key={member.id} value={member.name}>
                                                    {member.name}
                                                </option>
                                            ))}
                                        </select>
                                        <p className="text-xs text-gray-500 mt-1">
                                            Single-person ownership only (no "All" option)
                                        </p>
                                    </div>

                                    {/* When */}
                                    <div>
                                        <label className="block text-sm font-medium mb-2">
                                            When will it be done? *
                                        </label>
                                        <input
                                            type="date"
                                            value={action.when}
                                            onChange={(e) => updateAction(index, 'when', e.target.value)}
                                            min={today}
                                            className="worksheet-input"
                                        />
                                        <p className="text-xs text-gray-500 mt-1">
                                            Specific date required (no "Ongoing" allowed)
                                        </p>
                                    </div>

                                    {duplicateWarning && (
                                        <div className="bg-yellow-50 border border-yellow-200 p-3 rounded text-sm text-yellow-800">
                                            {duplicateWarning} - ensure workload is realistic
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        // Step 5: Commitment Lock
        const Step5 = ({ teamData, setTeamData }) => {
            const [commitments, setCommitments] = useState({});

            useEffect(() => {
                // Load existing commitments from teamData
                if (teamData.commitments && teamData.commitments.length > 0) {
                    const commitmentsMap = {};
                    teamData.commitments.forEach(c => {
                        commitmentsMap[c.memberId] = c.timestamp;
                    });
                    setCommitments(commitmentsMap);
                }
            }, []);

            const handleCommit = (memberId, memberName) => {
                const timestamp = new Date().toISOString();
                setCommitments(prev => ({ ...prev, [memberId]: timestamp }));

                // Update teamData
                setTeamData(prev => ({
                    ...prev,
                    commitments: [
                        ...prev.commitments.filter(c => c.memberId !== memberId),
                        { memberId, memberName, timestamp }
                    ]
                }));
            };

            const committedCount = Object.keys(commitments).length;
            const totalCount = teamData.teamMembers.length;
            const allCommitted = committedCount === totalCount && totalCount > 0;

            if (teamData.teamMembers.length === 0) {
                return (
                    <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                        <h2 className="plaak text-3xl mb-6">Commitment Lock</h2>
                        <div className="bg-red-50 border border-red-200 p-4 rounded">
                            <p className="text-red-800">
                                Cannot proceed: No team members added. Return to Step 1 to add team members.
                            </p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                    <h2 className="plaak text-3xl mb-6">Commitment Check</h2>

                    <FastTrackInsight>
                        Each team member must digitally sign off on these actions. The session cannot be marked complete
                        until 100% commit. This creates accountability and ensures everyone is aligned on next steps.
                    </FastTrackInsight>

                    <div className="bg-gray-50 p-4 rounded mb-6">
                        <p className="text-lg font-medium text-center">
                            {committedCount} of {totalCount} committed
                        </p>
                        <div className="w-full bg-gray-200 h-2 rounded mt-2">
                            <div
                                className="bg-green-500 h-2 rounded transition-all duration-300"
                                style={{ width: `${(committedCount / totalCount) * 100}%` }}
                            />
                        </div>
                    </div>

                    <div className="space-y-3">
                        {teamData.teamMembers.map(member => {
                            const isCommitted = !!commitments[member.id];

                            return (
                                <div
                                    key={member.id}
                                    className={`flex items-center justify-between p-4 border rounded ${
                                        isCommitted ? 'committed-row border-green-500' : 'border-gray-200'
                                    }`}
                                >
                                    <div className="flex items-center gap-3">
                                        {isCommitted && <span className="text-green-600 text-xl">‚úì</span>}
                                        <span className="font-medium">{member.name}</span>
                                    </div>
                                    <button
                                        onClick={() => handleCommit(member.id, member.name)}
                                        disabled={isCommitted}
                                        className={isCommitted ? 'btn-primary' : 'btn-secondary'}
                                    >
                                        {isCommitted ? '‚úì Committed' : 'I Commit'}
                                    </button>
                                </div>
                            );
                        })}
                    </div>

                    {allCommitted && (
                        <div className="bg-green-50 border border-green-200 p-4 rounded text-center">
                            <p className="text-green-800 font-medium">
                                üéâ 100% Team Commitment Achieved! Proceed to final review and export.
                            </p>
                        </div>
                    )}
                </div>
            );
        };

        // Step 6: Final Review & PDF Export
        const Step6 = ({ teamData }) => {
            const [isExporting, setIsExporting] = useState(false);
            const [exportStatus, setExportStatus] = useState('');

            const scores = calculateDysfunctionScores(teamData.teamMembers);
            const sorted = scores ? sortDysfunctionsByScore(scores) : [];

            const generatePDF = async () => {
                try {
                    setIsExporting(true);
                    setExportStatus('Generating PDF... this may take 30 seconds');

                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF();

                    // Page 1: Cover
                    pdf.setFontSize(24);
                    pdf.text('5 Dysfunctions of a Team', 20, 40);
                    pdf.setFontSize(16);
                    pdf.text('Workshop Results', 20, 55);
                    pdf.setFontSize(12);
                    pdf.text(`Team: ${teamData.teamName}`, 20, 75);
                    pdf.text(`Date: ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`, 20, 85);
                    pdf.text('Fast Track Leadership Development', 20, 100);

                    // Page 2: Team Summary
                    pdf.addPage();
                    pdf.setFontSize(18);
                    pdf.text('Team Summary', 20, 20);

                    pdf.setFontSize(12);
                    let yPos = 35;
                    pdf.text('Team Members:', 20, yPos);
                    yPos += 10;
                    teamData.teamMembers.forEach(member => {
                        pdf.text(`‚Ä¢ ${member.name}`, 25, yPos);
                        yPos += 7;
                    });

                    yPos += 10;
                    pdf.text('Dysfunction Scores:', 20, yPos);
                    yPos += 10;
                    sorted.forEach(({ name, score }) => {
                        const badge = getSeverityBadge(score);
                        pdf.text(`${name}: ${score.toFixed(1)} (${badge.label})`, 25, yPos);
                        yPos += 7;
                    });

                    // Page 3: Radar Chart
                    const chartCanvas = document.getElementById('radarChart');
                    if (chartCanvas) {
                        try {
                            const chartImage = await html2canvas(chartCanvas, { scale: 2 });
                            const chartDataUrl = chartImage.toDataURL('image/png');

                            pdf.addPage();
                            pdf.setFontSize(18);
                            pdf.text('Team Dysfunction Profile', 20, 20);
                            pdf.addImage(chartDataUrl, 'PNG', 20, 35, 170, 170);
                        } catch (err) {
                            console.error('Chart capture failed:', err);
                            setExportStatus('Chart could not be included in PDF');
                        }
                    }

                    // Page 4: Improvement Plan
                    pdf.addPage();
                    pdf.setFontSize(18);
                    pdf.text('Improvement Plan', 20, 20);

                    yPos = 35;
                    teamData.improvementPlan.slice(0, 3).forEach((plan, index) => {
                        const dysfunction = sorted.find(d => d.key === plan.dysfunction);
                        pdf.setFontSize(14);
                        pdf.text(`#${index + 1}: ${dysfunction?.name || plan.dysfunction}`, 20, yPos);
                        yPos += 8;
                        pdf.setFontSize(11);
                        const lines = pdf.splitTextToSize(plan.note || 'No notes provided', 170);
                        pdf.text(lines, 25, yPos);
                        yPos += lines.length * 6 + 10;
                    });

                    // Page 5: Action Plan
                    pdf.addPage();
                    pdf.setFontSize(18);
                    pdf.text('Action Plan', 20, 20);

                    yPos = 35;
                    teamData.actionPlan.forEach((action, index) => {
                        if (action.what && action.who && action.when) {
                            pdf.setFontSize(14);
                            pdf.text(`Action #${index + 1}`, 20, yPos);
                            yPos += 8;

                            pdf.setFontSize(11);
                            pdf.text('What:', 25, yPos);
                            const whatLines = pdf.splitTextToSize(action.what, 160);
                            pdf.text(whatLines, 45, yPos);
                            yPos += whatLines.length * 6;

                            pdf.text(`Who: ${action.who}`, 25, yPos);
                            yPos += 7;

                            const formattedDate = new Date(action.when).toLocaleDateString('en-US', {
                                year: 'numeric', month: 'short', day: 'numeric'
                            });
                            pdf.text(`When: ${formattedDate}`, 25, yPos);
                            yPos += 15;
                        }
                    });

                    // Page 6: Commitments
                    pdf.addPage();
                    pdf.setFontSize(18);
                    pdf.text('Team Commitment', 20, 20);

                    yPos = 35;
                    teamData.commitments.forEach(commitment => {
                        const date = new Date(commitment.timestamp);
                        const formatted = date.toLocaleDateString('en-US', {
                            year: 'numeric', month: 'short', day: 'numeric',
                            hour: 'numeric', minute: '2-digit'
                        });
                        pdf.text(`‚úì ${commitment.memberName} - Committed on ${formatted}`, 20, yPos);
                        yPos += 8;
                    });

                    yPos += 10;
                    pdf.setFontSize(12);
                    pdf.text('100% Team Commitment Achieved', 20, yPos);

                    // Save PDF
                    const filename = `FastTrack_Team_${teamData.teamName.replace(/\s+/g, '')}_${new Date().toISOString().split('T')[0]}.pdf`;
                    pdf.save(filename);

                    setExportStatus('PDF downloaded successfully');
                    setTimeout(() => setExportStatus(''), 3000);
                } catch (error) {
                    console.error('PDF generation error:', error);
                    setExportStatus('Error generating PDF. Please try again.');
                } finally {
                    setIsExporting(false);
                }
            };

            return (
                <div className="max-w-2xl mx-auto px-4 py-8 space-y-8 pb-32">
                    <h2 className="plaak text-3xl mb-6">Final Review</h2>

                    <div className="space-y-6">
                        {/* Team Overview */}
                        <div className="border border-gray-200 p-6 rounded">
                            <h3 className="font-medium text-lg mb-4">Team: {teamData.teamName}</h3>
                            <p className="text-sm text-gray-600">
                                {teamData.teamMembers.length} members ‚Ä¢ {teamData.actionPlan.filter(a => a.what).length} actions ‚Ä¢
                                {teamData.commitments.length} commitments
                            </p>
                        </div>

                        {/* Top Dysfunctions */}
                        {scores && (
                            <div className="border border-gray-200 p-6 rounded">
                                <h3 className="font-medium text-lg mb-4">Top 3 Dysfunctions</h3>
                                <ol className="space-y-2">
                                    {sorted.slice(0, 3).map(({ name, score }) => {
                                        const badge = getSeverityBadge(score);
                                        return (
                                            <li key={name} className="flex items-center justify-between">
                                                <span>{name}</span>
                                                <div className="flex items-center gap-2">
                                                    <span className="font-medium">{score.toFixed(1)}</span>
                                                    <span className={`badge badge-${badge.color} text-xs`}>
                                                        {badge.label}
                                                    </span>
                                                </div>
                                            </li>
                                        );
                                    })}
                                </ol>
                            </div>
                        )}

                        {/* Actions Summary */}
                        <div className="border border-gray-200 p-6 rounded">
                            <h3 className="font-medium text-lg mb-4">Action Plan Summary</h3>
                            <div className="space-y-3">
                                {teamData.actionPlan.filter(a => a.what).map((action, index) => (
                                    <div key={index} className="text-sm border-l-4 border-black pl-3">
                                        <p className="font-medium">{action.what.substring(0, 80)}...</p>
                                        <p className="text-gray-600">
                                            {action.who} ‚Ä¢ {new Date(action.when).toLocaleDateString()}
                                        </p>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Export PDF */}
                        <div className="border-2 border-black p-8 rounded text-center space-y-4">
                            <h3 className="font-medium text-xl">Ready to Export</h3>
                            <p className="text-gray-600">
                                Download a comprehensive PDF with all results, charts, and commitments.
                            </p>

                            {isExporting ? (
                                <div className="flex flex-col items-center gap-4">
                                    <div className="spinner" />
                                    <p className="text-sm text-gray-600">{exportStatus}</p>
                                </div>
                            ) : (
                                <button
                                    onClick={generatePDF}
                                    disabled={!teamData.teamName || teamData.commitments.length === 0}
                                    className="btn-primary text-lg px-8 py-4"
                                >
                                    Export PDF
                                </button>
                            )}

                            {exportStatus && !isExporting && (
                                <p className={`text-sm ${exportStatus.includes('success') ? 'text-green-600' : 'text-red-600'}`}>
                                    {exportStatus}
                                </p>
                            )}
                            {/* Case Study */}
                            <CaseStudy
                                before={"[PLACEHOLDER] Team meetings were polite but unproductive."}
                                after={"[PLACEHOLDER] Dysfunction scores improved from 3/10 to 7/10."}
                                quote={"[PLACEHOLDER] The dysfunction assessment was uncomfortable but transformative."}
                            />
                        </div>
                    </div>
                </div>
            );
        };

        function DependencyContext({ deps }) {
            if (!deps || deps.length === 0) return null;
            return (
                <div style={{ marginBottom: '24px' }}>
                    <div style={{ fontFamily: "'Monument', monospace", fontSize: '11px', textTransform: 'uppercase', letterSpacing: '0.05em', color: '#666', marginBottom: '8px' }}>
                        CONTEXT FROM PREVIOUS TOOLS
                    </div>
                    {deps.map((dep, i) => (
                        <div key={i} style={{ background: '#FFF9E0', border: '1px solid #F0E68C', borderLeft: '3px solid #DAA520', padding: '12px 16px', marginBottom: '8px', fontSize: '14px' }}>
                            <div style={{ fontWeight: 600, marginBottom: '4px', color: '#333' }}>{dep.label}</div>
                            <div style={{ color: '#555', whiteSpace: 'pre-wrap' }}>{dep.value}</div>
                        </div>
                    ))}
                </div>
            );
        }

        // Main TeamTool Component
        const TeamTool = () => {
            const [deps, setDeps] = useState([]);
            const [step, setStep] = useState(0);
            const [userEmail, setUserEmail] = useState('');
            const [aiReviewing, setAiReviewing] = useState(false);
            const [teamData, setTeamData] = useState({
                teamName: '',
                teamMembers: [],
                dysfunctionScores: {},
                improvementPlan: [],
                actionPlan: [{}, {}, {}],
                commitments: []
            });

            useEffect(() => {
                async function loadDeps() {
                    const userId = localStorage.getItem('ft_user_id');
                    if (!userId || !window.ToolDB || !window.DependencyInjection) return;
                    try {
                        await ToolDB.whenReady();
                        const config = DependencyInjection.getDependenciesConfig();
                        const toolConfig = config[CONFIG.TOOL_SLUG];
                        if (!toolConfig || !toolConfig.fields) return;
                        const loaded = [];
                        for (const field of toolConfig.fields) {
                            const val = await ToolDB.getDependency(userId, field.source_field);
                            if (val) {
                                loaded.push({ label: field.display_label || field.source_field, value: typeof val === 'object' ? JSON.stringify(val, null, 2) : String(val) });
                            }
                        }
                        setDeps(loaded);
                    } catch (err) {
                        console.warn('[' + CONFIG.TOOL_SLUG + '] Failed to load dependencies:', err);
                    }
                }
                loadDeps();
            }, []);

            // Load from localStorage on mount
            useEffect(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    if (saved) {
                        const parsed = JSON.parse(saved);
                        setTeamData(parsed.teamData || teamData);
                        setUserEmail(parsed.userEmail || '');
                        setStep(parsed.step || 0);
                    }
                } catch (error) {
                    console.error('Error loading from localStorage:', error);
                }

                // Check for email in URL params
                const urlParams = new URLSearchParams(window.location.search);
                const emailParam = urlParams.get('email');
                if (emailParam) {
                    setUserEmail(emailParam);
                    loadFromSupabase(emailParam);
                }
            }, []);

            // Save to localStorage
            useEffect(() => {
                const timer = setTimeout(() => {
                    try {
                        localStorage.setItem(STORAGE_KEY, JSON.stringify({
                            teamData,
                            userEmail,
                            step
                        }));
                    } catch (error) {
                        console.error('Error saving to localStorage:', error);
                    }
                }, 300);

                return () => clearTimeout(timer);
            }, [teamData, userEmail, step]);

            // Sync to Supabase via ToolDB (auto-save only, no markComplete)
            useEffect(() => {
                const timer = setTimeout(async () => {
                    if (userEmail && teamData.teamName) {
                        try {
                            const userId = localStorage.getItem('ft_user_id');
                            if (!userId) return;

                            const questionMappings = {
                                dysfunction_scorecard: teamData.dysfunctionScores,
                                trust_action_plan: teamData.actionPlan,
                                conflict_norms: teamData.improvementPlan,
                                conflict_resolution_strategies: teamData.commitments,
                                accountability_tracker: { teamName: teamData.teamName, teamMembers: teamData.teamMembers }
                            };
                            await ToolDB.save(userId, questionMappings);
                        } catch (error) {
                            console.error('ToolDB sync error:', error);
                        }
                    }
                }, 2000);

                return () => clearTimeout(timer);
            }, [teamData, userEmail]);

            // Build question mappings helper
            const getQuestionMappings = () => ({
                dysfunction_scorecard: teamData.dysfunctionScores,
                trust_action_plan: teamData.actionPlan,
                conflict_norms: teamData.improvementPlan,
                conflict_resolution_strategies: teamData.commitments,
                accountability_tracker: { teamName: teamData.teamName, teamMembers: teamData.teamMembers }
            });

            const loadFromSupabase = async (email) => {
                try {
                    const { data, error } = await supabase
                        .from('sprint_04_team')
                        .select('data')
                        .eq('user_email', email)
                        .eq('tool_slug', TOOL_SLUG)
                        .single();

                    if (data && !error) {
                        setTeamData(data.data);
                    }
                } catch (error) {
                    console.error('Error loading from Supabase:', error);
                }
            };

            // Validation functions
            const validateStep1 = () => {
                return teamData.teamName.trim() !== '' && teamData.teamMembers.length > 0;
            };

            const validateStep4 = () => {
                return teamData.actionPlan.filter(action =>
                    action.what && trimText(action.what).length >= 30 &&
                    action.who && action.who !== '' &&
                    action.when && action.when !== ''
                ).length === 3;
            };

            const validateStep5 = () => {
                return teamData.commitments.length === teamData.teamMembers.length &&
                       teamData.teamMembers.length > 0;
            };

            const canProceed = () => {
                if (step === 1) return validateStep1();
                if (step === 4) return validateStep4();
                if (step === 5) return validateStep5();
                return true;
            };

            const handleNext = async () => {
                if (!canProceed() || step >= 6) return;

                // Determine step-specific answers for AI review
                const stepDataMap = {
                    1: { accountability_tracker: { teamName: teamData.teamName, teamMembers: teamData.teamMembers } },
                    3: { conflict_norms: teamData.improvementPlan },
                    4: { trust_action_plan: teamData.actionPlan },
                    5: { conflict_resolution_strategies: teamData.commitments }
                };

                const stepNameMap = {
                    1: 'Team Setup',
                    3: 'Improvement Plan',
                    4: 'Action Plan',
                    5: 'Commitments'
                };

                const stepAnswers = stepDataMap[step];
                if (stepAnswers) {
                    const userId = localStorage.getItem('ft_user_id');
                    if (userId) {
                        setAiReviewing(true);
                        try {
                            const canGo = await window.AIChallenge.reviewStep(userId, 'team', stepAnswers, stepNameMap[step]);
                            if (!canGo) {
                                setAiReviewing(false);
                                return;
                            }
                        } catch (err) {
                            console.warn('AI review error, allowing passage:', err);
                        } finally {
                            setAiReviewing(false);
                        }
                    }
                }

                // If moving to final step (6), do the AI challenge final submit
                if (step === 5) {
                    const userId = localStorage.getItem('ft_user_id');
                    if (userId) {
                        setAiReviewing(true);
                        try {
                            await window.AIChallenge.submitWithChallenge(userId, 'team', getQuestionMappings(), {
                                onReviewStart: () => {},
                                onRevise: () => { setAiReviewing(false); },
                                onSubmitAnyway: () => { setStep(6); window.scrollTo(0, 0); setAiReviewing(false); },
                                onError: (err) => { console.error('Submit error:', err); setAiReviewing(false); }
                            });
                        } catch (err) {
                            console.warn('AI challenge error:', err);
                            setStep(6);
                            window.scrollTo(0, 0);
                            setAiReviewing(false);
                        }
                        return;
                    }
                }

                setStep(step + 1);
                window.scrollTo(0, 0);
            };

            const handleBack = () => {
                if (step > 0) {
                    setStep(step - 1);
                    window.scrollTo(0, 0);
                }
            };

            const handleDotClick = (stepIndex) => {
                setStep(stepIndex);
                window.scrollTo(0, 0);
            };

            return (
                <div className="min-h-screen pb-24">
                    {step > 0 && (
                        <div className="py-6">
                            <ProgressDots currentStep={step} onDotClick={handleDotClick} />
                        </div>
                    )}

                    {step === 0 && <Step0 onNext={handleNext} />}
                    {step === 1 && <><DependencyContext deps={deps} /><Step1 teamData={teamData} setTeamData={setTeamData} userEmail={userEmail} setUserEmail={setUserEmail} /></>}
                    {step === 2 && <Step2 teamData={teamData} />}
                    {step === 3 && <Step3 teamData={teamData} setTeamData={setTeamData} />}
                    {step === 4 && <Step4 teamData={teamData} setTeamData={setTeamData} />}
                    {step === 5 && <Step5 teamData={teamData} setTeamData={setTeamData} />}
                    {step === 6 && <Step6 teamData={teamData} />}

                    {step > 0 && (
                        <div className="sticky-footer">
                            <div className="max-w-2xl mx-auto flex justify-between items-center">
                                {step > 0 && (
                                    <button onClick={handleBack} className="btn-secondary">
                                        ‚Üê Back
                                    </button>
                                )}
                                {step < 6 && (
                                    <button
                                        onClick={handleNext}
                                        disabled={!canProceed() || aiReviewing}
                                        className="btn-primary ml-auto"
                                    >
                                        {aiReviewing ? 'AI Coach Reviewing...' : 'Next ‚Üí'}
                                    </button>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Mount React app
        ReactDOM.render(<TeamTool />, document.getElementById('root'));
    </script>
</body>
</html>