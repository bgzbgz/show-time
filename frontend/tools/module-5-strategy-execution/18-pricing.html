<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Strategy Driven Pricing | Fast Track Program</title>

  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../../shared/js/tool-db.js"></script>
  <script src="../../shared/js/ai-challenge.js"></script>
  <script src="../../shared/js/dependency-injection.js"></script>
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>
    <script src="../../js/tool-access-control.js"></script>

  <!-- jsPDF + html2canvas for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Font preloading to prevent FOUT -->
  <link rel="preload" href="Plaak3Trial-43-Bold.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="RiformaLL-Regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="MonumentGrotesk-Mono.woff2" as="font" type="font/woff2" crossorigin>

  <style>
    /* === FONT FACES === */
    @font-face { font-family: 'Plaak'; src: url('Plaak3Trial-43-Bold.woff2') format('woff2'); font-weight: bold; font-display: swap; }
    @font-face { font-family: 'Riforma'; src: url('RiformaLL-Regular.woff2') format('woff2'); font-weight: normal; font-display: swap; }
    @font-face { font-family: 'Riforma'; src: url('RiformaLL-Regular.woff2') format('woff2'); font-weight: 600; font-display: swap; }
    @font-face { font-family: 'Monument'; src: url('MonumentGrotesk-Mono.woff2') format('woff2'); font-display: swap; }

    /* === BASE RESET === */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Riforma', -apple-system, sans-serif;
      font-size: 16px;
      color: #000;
      background: #000;
      -webkit-font-smoothing: antialiased;
    }

    /* === CUSTOM SCROLLBAR === */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #000; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #333; }
    * { scrollbar-width: thin; scrollbar-color: #000 transparent; }

    /* === TYPOGRAPHY HELPERS === */
    .plaak { font-family: 'Plaak', sans-serif; font-weight: bold; letter-spacing: -0.01em; line-height: 1.2; }
    .monument { font-family: 'Monument', monospace; letter-spacing: 0.05em; }
    .riforma-bold { font-family: 'Riforma', sans-serif; font-weight: bold; }

    /* === LAYOUT FRAME === */
    .tool-frame { background: #fff; min-height: 100vh; }
    .tool-inner { background: #fff; min-height: 100vh; }

    /* === WIZARD LAYOUT === */
    .wizard-layout { display: flex; min-height: 100vh; }
    .wizard-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      background: #fff;
    }
    .wizard-content {
      max-width: 640px;
      width: 100%;
      margin: 0 auto;
      padding: 48px 32px;
      flex: 1;
    }

    /* === SIDEBAR === */
    .wizard-sidebar {
      width: 280px;
      background: #000;
      border-left: 1px solid #000;
      flex-shrink: 0;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow: hidden;
    }
    .wizard-sidebar-inner {
      padding: 32px 24px;
      height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
    }
    .sidebar-step-item {
      padding: 12px;
      margin-bottom: 8px;
      border-left: 3px solid transparent;
      transition: all 0.2s ease;
    }
    .sidebar-step-item.active { border-left-color: #FFF469; background: #222; }
    .sidebar-step-item.completed { background: #fff; color: #000; border-left-color: #fff; cursor: pointer; }
    .sidebar-step-item.completed:hover { background: #E0E0E0; }
    .sidebar-step-item.locked { opacity: 0.5; }
    .sidebar-step-item .step-num { font-family: 'Riforma', sans-serif; font-size: 14px; }
    .sidebar-step-item .step-name { font-family: 'Riforma', sans-serif; font-size: 14px; }
    .sidebar-snippet { font-size: 12px; margin-top: 4px; opacity: 0.7; line-height: 1.3; }

    /* === STEP HEADER === */
    .step-indicator {
      font-family: 'Monument', monospace;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #6B7280;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .step-time {
      font-family: 'Monument', monospace;
      font-size: 11px;
      color: #6B7280;
    }
    .step-heading {
      font-family: 'Plaak', sans-serif;
      font-weight: bold;
      font-size: 32px;
      text-transform: uppercase;
      letter-spacing: -0.01em;
      line-height: 1.2;
      color: #000;
      margin-bottom: 6px;
    }
    .step-hint {
      font-size: 16px;
      color: #6B7280;
      line-height: 1.5;
      margin: 0 0 32px 0;
    }

    /* === FORM ELEMENTS === */
    .ft-label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: 'Monument', monospace;
      font-size: 14px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #000;
      margin-bottom: 8px;
    }
    .ft-required { color: #DC2626; font-weight: 700; }

    .ft-input {
      width: 100%;
      height: 44px;
      padding: 8px 16px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      color: #000;
      background: #fff;
      border: 1px solid #E5E7EB;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .ft-input:focus {
      outline: none;
      border-color: #000;
      box-shadow: 0 0 0 3px #FFF469;
    }
    .ft-input.has-error {
      border: 2px solid #DC2626;
      padding-right: 40px;
    }
    .ft-input.has-error:focus {
      border-color: #DC2626;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.2);
    }

    .ft-textarea {
      width: 100%;
      min-height: 120px;
      padding: 12px 16px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      color: #000;
      background: #fff;
      border: 1px solid #E5E7EB;
      resize: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .ft-textarea:focus {
      outline: none;
      border-color: #000;
      box-shadow: 0 0 0 3px #FFF469;
    }
    .ft-textarea.has-error {
      border: 2px solid #DC2626;
    }
    .ft-textarea.has-error:focus {
      border-color: #DC2626;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.2);
    }

    .ft-help {
      font-size: 14px;
      color: #6B7280;
      margin-top: 4px;
      line-height: 1.5;
    }
    .ft-error-msg {
      font-size: 14px;
      font-weight: 600;
      color: #DC2626;
      margin-top: 4px;
      line-height: 1.4;
    }
    .ft-field-group {
      margin-bottom: 24px;
    }
    .ft-field-group:last-child { margin-bottom: 0; }
    .ft-section { margin-bottom: 32px; }

    /* === YELLOW INSIGHT BOX === */
    .ft-insight {
      background: #FFF469;
      border: 3px solid #000;
      padding: 16px;
      margin-bottom: 32px;
    }

    /* === EXAMPLE BOX === */
    .ft-example {
      background: #F3F4F6;
      padding: 16px;
      margin-bottom: 8px;
      font-size: 14px;
      line-height: 1.6;
      color: #1F2937;
    }

    /* === ERROR SUMMARY === */
    .ft-error-summary {
      border: 2px solid #DC2626;
      background: #fff;
      padding: 16px;
      margin-bottom: 24px;
    }
    .ft-error-summary a {
      color: #DC2626;
      text-decoration: underline;
      cursor: pointer;
    }
    .ft-error-summary a:hover { text-decoration: none; }

    /* === BUTTON FOOTER === */
    .btn-footer {
      position: sticky;
      bottom: 0;
      z-index: 10;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 32px;
      border-top: 1px solid #E5E7EB;
      background: #fff;
      width: 100%;
    }
    .btn-back {
      background: #fff;
      color: #000;
      border: 2px solid #000;
      padding: 12px 24px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 44px;
    }
    .btn-back:hover { background: #F3F4F6; }
    .btn-next {
      background: #000;
      color: #fff;
      border: 2px solid #000;
      padding: 12px 24px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 44px;
    }
    .btn-next:hover:not(:disabled) { transform: scale(1.02); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .btn-next:disabled { background: #E5E7EB; color: #9CA3AF; border-color: #E5E7EB; cursor: not-allowed; }

    /* === CLOSING MESSAGE === */
    .closing-box {
      border-top: 1px solid #E5E7EB;
      padding: 20px 0 0 0;
      margin-top: 8px;
      text-align: center;
    }
    .closing-box p { font-size: 14px; color: #6B7280; }
    .closing-box .closing-title {
      font-family: 'Monument', monospace;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #000;
      margin-bottom: 6px;
    }

    /* === MOBILE STEP BAR === */
    .mobile-step-bar { display: none; padding: 12px 16px; border-bottom: 1px solid #E5E7EB; background: #F3F4F6; }
    .mobile-step-bar .bar-text { font-family: 'Monument', monospace; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em; color: #6B7280; margin-bottom: 6px; }
    .mobile-progress { height: 3px; background: #E5E7EB; width: 100%; }
    .mobile-progress-fill { height: 100%; background: #000; transition: width 0.3s ease; }

    /* === CANVAS STYLES === */
    .numbered-section { background: #000; color: #fff; padding: 8px 14px; font-size: 14px; font-weight: bold; letter-spacing: 0.5px; display: inline-block; font-family: 'Monument', monospace; }

    /* === ANIMATIONS === */
    @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .animate-in { animation: fadeSlideIn 0.3s ease-out; }

    /* === PRINT === */
    @media print { .no-print { display: none !important; } }

    /* === RESPONSIVE === */
    @media (min-width: 769px) and (max-width: 1024px) {
      .wizard-sidebar { width: 220px; }
      .wizard-sidebar-inner { padding: 24px 16px; }
    }
    @media (max-width: 768px) {
      .wizard-sidebar { display: none; }
      .mobile-step-bar { display: block; }
      .wizard-content { padding: 24px 16px; }
      .step-heading { font-size: 24px; }
      .btn-footer { padding: 12px 16px; }
    }
    @media (max-width: 480px) {
      .step-heading { font-size: 20px; }
      .wizard-content { padding: 20px 12px; }
    }

    /* === TOOL-SPECIFIC: Character Counter === */
    .char-counter {
      font-size: 14px;
      color: #666;
      margin-top: 4px;
    }
    .char-counter.invalid {
      color: #EF4444;
    }
    textarea::placeholder {
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, Fragment } = React;

    // Configuration
    const CONFIG = {
      SUPABASE_URL: 'https://lutzzfaedkbsmbobmrzx.supabase.co',
      SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1dHp6ZmFlZGtic21ib2Jtcnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MDA0MDQsImV4cCI6MjA4NjM3NjQwNH0.o2gJba85vDl4NLS-C8Mq3OudWKxet-b0IqO9kazqb8U',
      TOOL_SLUG: 'pricing',
      AUTOSAVE_DELAY: 2000
    };

    const { createClient } = supabase;
    const supabaseClient = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);

    // Make Supabase client globally available for dependency injection
    window.supabaseClient = supabaseClient;

    // Initialize ToolDB and dependency injection
    ToolDB.init(CONFIG.TOOL_SLUG);
        ToolAccessControl.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        CognitiveLoad.init('pricing', {"insights":["Pricing is the most powerful profit lever. A 1% price increase drives ~11% profit increase.","Value-based pricing beats cost-plus pricing every time."],"caseStudy":{"before":"A software startup offered 20 features at a single monthly fee with no user feedback on real value. Hourly billing meant minimal profit and continuous haggling with customers over scope and deliverables.","after":"After applying the Fast Track pricing method, they identified 5 key features from top 10 prospects, created a Core plan (3 must-haves) and a Pro plan (2 premium add-ons). Core hit 80% of users; Pro cost 50% more for power users who valued advanced functions. Average deal size increased 35%.","quote":"We stopped guessing and started asking what customers would actually pay for. The moment we set our anchor price first and built the product around it, our margins jumped and customer satisfaction went up because we delivered exactly what they valued."}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

    /* VP-style transition content between steps */
    const TRANSITION_CONTENT = {
        1: {
            title: 'FEATURES CLASSIFIED.',
            text: "You've identified what customers will actually pay for. Now set your price anchor before building anything.",
            brutalTruth: "Most companies classify features based on internal assumptions, not customer data. If your 'Must-Have' label came from engineering pride rather than WTP evidence, your entire pricing strategy is built on sand. Simon (2015) found that companies using data-driven feature classification set prices 15-25% more accurately.",
            peerProof: "McKinsey research across 1,200 companies shows that a 1% improvement in price generates an 8.7% increase in operating profits on average — nearly 50% more than a 1% fall in variable costs. Getting feature classification right is the foundation."
        },
        2: {
            title: 'ANCHOR SET.',
            text: "Your price position is locked. Now design 2-3 tiers that capture different willingness-to-pay segments.",
            brutalTruth: "Tversky & Kahneman's anchoring research shows the first number a customer sees becomes their reference point. If you let competitors set that anchor for you, you've already lost the pricing war. Your anchor must be justified by value, not apologized for.",
            peerProof: "Ariely, Loewenstein & Prelec (2003) at MIT found that deliberate price anchors influenced willingness to pay by up to 60-80%. Companies that set high anchors and justify them with value capture 15-30% more revenue."
        },
        3: {
            title: 'TIERS DESIGNED.',
            text: "Your bundles are structured. Now align every feature to your price anchor and prove the value.",
            brutalTruth: "The decoy effect shows that a strategically positioned third option can increase selection of your target tier by 40%. But if your tiers aren't clearly differentiated — if customers can't summarize each in one sentence — you've created confusion, not choice.",
            peerProof: "Nagle & Muller (2017) found that companies limiting themselves to 2-3 clearly differentiated tiers achieve 30% higher conversion rates than those with complex multi-tier structures. Simplified choice reduces decision paralysis."
        },
        4: {
            title: 'VALUE ALIGNED.',
            text: "Features map to price. Now build the execution plan that turns strategy into profit.",
            brutalTruth: "Anderson, Narus & Van Rossum (2006, HBR) found that companies able to quantify their value proposition in monetary terms win deals at 3x the rate of competitors who cannot. If you can't show the ROI math, your price will always feel arbitrary.",
            peerProof: "Companies that explicitly connect features to measurable outcomes — time saved, revenue boosted, risk reduced — achieve premium positioning 2.5x more often than those selling features alone."
        },
        5: {
            title: 'STRATEGY COMPLETE.',
            text: "Your pricing strategy is ready. Pilot, measure, and iterate — pricing is a living weapon, not a one-time decision.",
            brutalTruth: "Hinterhuber (2008) found that companies running structured pricing pilots before full rollout achieved 23% higher profit improvements than those who launched changes organization-wide without testing. Set it once and forget it = lost revenue.",
            peerProof: "A Bain & Company study found that companies with formal pricing review cadences (quarterly or better) maintained 5-8% higher margins over 3 years compared to peers who treated pricing as a one-time decision."
        }
    };

    /* ============================================================
       SHARED COMPONENTS
       ============================================================ */

    function CheckIcon({ color = "#fff", size = 16 }) {
        return <svg width={size} height={size} viewBox="0 0 24 24" fill={color}><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>;
    }

    function ButtonFooter({ onBack, onNext, nextLabel = 'Next', showBack = true, disabled = false }) {
        return (
            <div className="btn-footer no-print">
                {showBack ? <button className="btn-back" onClick={onBack}>&larr; Back</button> : <div />}
                <button className="btn-next" disabled={disabled} onClick={onNext}>{nextLabel} &rarr;</button>
            </div>
        );
    }

    function MobileStepBar({ currentStep, totalSteps }) {
        const total = totalSteps || 5;
        const progress = currentStep >= 999 ? 100 : Math.round((currentStep / total) * 100);
        return (
            <div className="mobile-step-bar no-print">
                <div className="bar-text">Step {Math.min(currentStep, total)} of {total}</div>
                <div className="mobile-progress"><div className="mobile-progress-fill" style={{ width: `${progress}%` }} /></div>
            </div>
        );
    }

    function DependencyContext({ deps }) {
        if (!deps || deps.length === 0) return null;
        return (
            <div style={{ marginBottom: '24px' }}>
                <div style={{ fontFamily: "'Monument', monospace", fontSize: '11px', textTransform: 'uppercase', letterSpacing: '0.05em', color: '#666', marginBottom: '8px' }}>
                    CONTEXT FROM PREVIOUS TOOLS
                </div>
                {deps.map((dep, i) => (
                    <div key={i} style={{ background: '#FFF9E0', border: '1px solid #F0E68C', borderLeft: '3px solid #DAA520', padding: '12px 16px', marginBottom: '8px', fontSize: '14px' }}>
                        <div style={{ fontWeight: 600, marginBottom: '4px', color: '#333' }}>{dep.label}</div>
                        <div style={{ color: '#555', whiteSpace: 'pre-wrap' }}>{dep.value}</div>
                    </div>
                ))}
            </div>
        );
    }

    function CoachFeedbackPanel() {
        const [expanded, setExpanded] = useState(false);
        const [feedback, setFeedback] = useState(null);

        useEffect(() => {
            const check = () => {
                if (window.AIChallenge && window.AIChallenge.getLastFeedback) {
                    setFeedback(window.AIChallenge.getLastFeedback());
                }
            };
            check();
            const interval = setInterval(check, 2000);
            return () => clearInterval(interval);
        }, []);

        if (!feedback) return null;

        return (
            <div style={{ marginTop: 24, borderTop: '1px solid #333', paddingTop: 16 }}>
                <button
                    onClick={() => setExpanded(!expanded)}
                    style={{ background: 'none', border: 'none', color: '#FFF469', cursor: 'pointer', fontFamily: "'Monument', monospace", fontSize: 10, textTransform: 'uppercase', letterSpacing: '0.05em', display: 'flex', alignItems: 'center', gap: 6, padding: 0, width: '100%' }}
                >
                    <span style={{ transform: expanded ? 'rotate(90deg)' : 'rotate(0deg)', transition: 'transform 0.2s', display: 'inline-block' }}>&#9654;</span>
                    COACH FEEDBACK
                </button>
                {expanded && (
                    <div style={{ marginTop: 10, fontSize: 12, color: '#ccc', lineHeight: 1.5 }}>
                        {feedback.type === 'approved' && (
                            <p style={{ color: '#FFF469' }}>{feedback.message}</p>
                        )}
                        {feedback.type === 'challenges' && (
                            <>
                                {feedback.encouragement && <p style={{ color: '#FFF469', marginBottom: 8 }}>{feedback.encouragement}</p>}
                                {feedback.challenges && feedback.challenges.map((ch, i) => (
                                    <div key={i} style={{ marginBottom: 8, paddingLeft: 8, borderLeft: '2px solid #555' }}>
                                        <div style={{ fontSize: 10, color: '#999', marginBottom: 2 }}>{ch.question_text || ch.question_key}</div>
                                        <div>{ch.feedback}</div>
                                    </div>
                                ))}
                            </>
                        )}
                    </div>
                )}
            </div>
        );
    }

    function WizardSidebar({ currentStep, data, onNavigate }) {
        const steps = [
            { num: 1, label: 'Feature Classification', time: '~8 min' },
            { num: 2, label: 'Price Anchor', time: '~5 min' },
            { num: 3, label: 'Tier Bundles', time: '~8 min' },
            { num: 4, label: 'Value Alignment', time: '~5 min' },
            { num: 5, label: 'Implementation', time: '~8 min' }
        ];

        const getSnippet = (n) => {
            if (n === 1 && data.features.length > 1) return data.features.filter(f => f.name).length + ' features classified';
            if (n === 2 && data.anchorType) return data.anchorType + ': ' + (data.anchorPrice || 'pending').substring(0, 30);
            if (n === 3 && data.tiers.length >= 2) return data.tiers.filter(t => t.name).length + ' tiers designed';
            if (n === 4 && data.valueProposition) return '"' + data.valueProposition.substring(0, 50) + (data.valueProposition.length > 50 ? '...' : '') + '"';
            if (n === 5 && data.pricingActions.length > 1) return data.pricingActions.filter(a => a.action).length + ' actions planned';
            return null;
        };

        return (
            <div className="wizard-sidebar no-print">
                <div className="wizard-sidebar-inner">
                    <div style={{ marginBottom: 24 }}>
                        <div className="monument" style={{ fontSize: 12, textTransform: 'uppercase', color: '#fff', marginBottom: 4 }}>PRICING STRATEGY</div>
                        <div style={{ fontSize: 13, color: '#999' }}>~34 min total</div>
                    </div>
                    <div style={{ marginBottom: 16, fontFamily: "'Monument', monospace", fontSize: 10, textTransform: 'uppercase', letterSpacing: '0.05em', color: '#999' }}>Your journey</div>
                    {steps.map(s => {
                        const effectiveStep = Math.ceil(currentStep);
                        const isCompleted = effectiveStep > s.num, isActive = effectiveStep === s.num, isLocked = effectiveStep < s.num;
                        const snippet = isCompleted ? getSnippet(s.num) : null;
                        return (
                            <div key={s.num} className={`sidebar-step-item ${isCompleted ? 'completed' : ''} ${isActive ? 'active' : ''} ${isLocked ? 'locked' : ''}`}
                                onClick={() => isCompleted && onNavigate && onNavigate(s.num)}
                                title={isCompleted ? 'Click to review this step' : ''}
                            >
                                <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>
                                    {isCompleted ? <CheckIcon color="#000" size={14} /> : <span className="step-num" style={{ color: isActive ? '#fff' : '#ccc' }}>{String(s.num).padStart(2, '0')}</span>}
                                    <span className="step-name" style={{ color: isLocked ? '#666' : isCompleted ? '#000' : '#fff' }}>{s.label}</span>
                                </div>
                                {snippet && <div className="sidebar-snippet">{snippet}</div>}
                            </div>
                        );
                    })}

                    <CoachFeedbackPanel />
                </div>
            </div>
        );
    }

    // Main App Component
    function PricingApp() {
            const [deps, setDeps] = useState([]);
      const [step, setStep] = useState(0);
      const [aiReviewing, setAiReviewing] = useState(false);
      const [submitStatus, setSubmitStatus] = useState(null);
      const [submitMessage, setSubmitMessage] = useState('');

      const [data, setData] = useState({
        // Step 1: Feature Classification
        features: [
          { id: 1, name: '', category: 'must-have', wtpImpact: '', rationale: '' }
        ],

        // Step 2: Price Anchor Selection
        anchorType: '',
        targetSegment: '',
        competitorBenchmark: '',
        anchorPrice: '',
        anchorRationale: '',

        // Step 3: Tier Bundle Design
        tiers: [
          { id: 1, name: '', price: '', features: '', targetCustomer: '', margin: '' }
        ],

        // Step 4: Price-to-Value Alignment
        mustHaveFeatures: '',
        niceToHaveFeatures: '',
        killerFeatures: '',
        valueProposition: '',

        // Step 5: Implementation Plan
        pricingActions: [
          { id: 1, action: '', owner: '', deadline: '', expectedImpact: '' }
        ],
        pilotPlan: '',
        successMetrics: ''
      });

            useEffect(() => {
                async function loadDeps() {
                    const userId = localStorage.getItem('ft_user_id');
                    if (!userId || !window.ToolDB || !window.DependencyInjection) return;
                    try {
                        await ToolDB.whenReady();
                        const config = DependencyInjection.getDependenciesConfig();
                        const toolConfig = config[CONFIG.TOOL_SLUG];
                        if (!toolConfig || !toolConfig.fields) return;
                        const loaded = [];
                        for (const field of toolConfig.fields) {
                            const val = await ToolDB.getDependency(userId, field.source_field);
                            if (val) {
                                loaded.push({ label: field.display_label || field.source_field, value: window.DependencyInjection ? DependencyInjection.formatValue(val) : (typeof val === 'object' ? JSON.stringify(val, null, 2) : String(val)) });
                            }
                        }
                        setDeps(loaded);
                    } catch (err) {
                        console.warn('[' + CONFIG.TOOL_SLUG + '] Failed to load dependencies:', err);
                    }
                }
                loadDeps();
            }, []);

      // Load from localStorage
      useEffect(() => {
        const saved = localStorage.getItem('pricing-tool-data');
        if (saved) {
          try {
            const savedData = JSON.parse(saved);
            setData(savedData);
          } catch (e) {
            console.error('Error loading saved data:', e);
          }
        }
      }, []);

      // Auto-save every 2 seconds
      useEffect(() => {
        const interval = setInterval(() => {
          localStorage.setItem('pricing-tool-data', JSON.stringify(data));
        }, 2000);
        return () => clearInterval(interval);
      }, [data]);

      const updateData = (field, value) => {
        setData({ ...data, [field]: value });
      };

      const addFeature = () => {
        const newFeature = { id: Date.now(), name: '', category: 'must-have', wtpImpact: '', rationale: '' };
        updateData('features', [...data.features, newFeature]);
      };

      const removeFeature = (id) => {
        if (data.features.length > 1) {
          updateData('features', data.features.filter(f => f.id !== id));
        }
      };

      const updateFeature = (id, field, value) => {
        const updated = data.features.map(f => f.id === id ? { ...f, [field]: value } : f);
        updateData('features', updated);
      };

      const addTier = () => {
        if (data.tiers.length < 3) {
          const newTier = { id: Date.now(), name: '', price: '', features: '', targetCustomer: '', margin: '' };
          updateData('tiers', [...data.tiers, newTier]);
        }
      };

      const removeTier = (id) => {
        if (data.tiers.length > 1) {
          updateData('tiers', data.tiers.filter(t => t.id !== id));
        }
      };

      const updateTier = (id, field, value) => {
        const updated = data.tiers.map(t => t.id === id ? { ...t, [field]: value } : t);
        updateData('tiers', updated);
      };

      const addAction = () => {
        const newAction = { id: Date.now(), action: '', owner: '', deadline: '', expectedImpact: '' };
        updateData('pricingActions', [...data.pricingActions, newAction]);
      };

      const removeAction = (id) => {
        if (data.pricingActions.length > 1) {
          updateData('pricingActions', data.pricingActions.filter(a => a.id !== id));
        }
      };

      const updateAction = (id, field, value) => {
        const updated = data.pricingActions.map(a => a.id === id ? { ...a, [field]: value } : a);
        updateData('pricingActions', updated);
      };

      /* PRESERVED: AI-gated step navigation */
      const handleStepNext = async (nextStepValue, stepAnswers, stepName) => {
        const userId = localStorage.getItem('ft_user_id');
        if (!userId) {
          setStep(nextStepValue);
          return;
        }
        setAiReviewing(true);
        try {
          const canProceed = await window.AIChallenge.reviewStep(userId, CONFIG.TOOL_SLUG, stepAnswers, stepName);
          if (canProceed) {
            setStep(nextStepValue);
          }
        } catch (err) {
          console.warn('[AIChallenge] Error, allowing passage:', err);
          setStep(nextStepValue);
        } finally {
          setAiReviewing(false);
        }
      };

      // Validation functions
      const isStep1Valid = () => {
        return data.features.length >= 5 && data.features.every(f =>
          f.name.trim().length >= 10 &&
          f.wtpImpact.trim().length >= 20 &&
          f.rationale.trim().length >= 30
        );
      };

      const isStep2Valid = () => {
        return data.anchorType &&
               data.targetSegment.length >= 50 &&
               data.competitorBenchmark.length >= 50 &&
               data.anchorPrice.length >= 5 &&
               data.anchorRationale.length >= 100;
      };

      const isStep3Valid = () => {
        return data.tiers.length >= 2 && data.tiers.length <= 3 && data.tiers.every(t =>
          t.name.trim().length >= 5 &&
          t.price.trim().length >= 3 &&
          t.features.trim().length >= 50 &&
          t.targetCustomer.trim().length >= 30 &&
          t.margin.trim().length >= 3
        );
      };

      const isStep4Valid = () => {
        return data.mustHaveFeatures.length >= 100 &&
               data.niceToHaveFeatures.length >= 50 &&
               data.killerFeatures.length >= 50 &&
               data.valueProposition.length >= 100;
      };

      const isStep5Valid = () => {
        return data.pricingActions.length >= 3 &&
               data.pricingActions.every(a =>
                 a.action.trim().length >= 20 &&
                 a.owner.trim().length >= 5 &&
                 a.deadline.trim().length >= 5 &&
                 a.expectedImpact.trim().length >= 20
               ) &&
               data.pilotPlan.length >= 100 &&
               data.successMetrics.length >= 100;
      };

      const exportPDF = async () => {
        try {
          const canvas = document.getElementById('canvas-content');
          if (!canvas) {
            alert('Canvas not found');
            return;
          }

          // Hide images to avoid CORS
          const images = canvas.querySelectorAll('img');
          const imageStates = [];
          images.forEach(img => {
            imageStates.push({ img, display: img.style.display });
            img.style.display = 'none';
          });

          const canvasImage = await html2canvas(canvas, {
            scale: 2,
            logging: false,
            backgroundColor: '#ffffff'
          });

          // Restore images
          imageStates.forEach(({ img, display }) => {
            img.style.display = display;
          });

          const imgWidth = 190;
          const imgHeight = (canvasImage.height * imgWidth) / canvasImage.width;

          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const imgData = canvasImage.toDataURL('image/png');

          pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
          pdf.save('strategy-driven-pricing.pdf');
        } catch (error) {
          console.error('PDF export error:', error);
          alert('Failed to export PDF: ' + error.message);
        }
      };

      const handleSubmit = async () => {
        try {
          const userId = localStorage.getItem('ft_user_id');
          if (!userId) {
            alert('User not authenticated. Please return to the dashboard.');
            return;
          }

          const questionMappings = {
            pricing_tiers: data.tiers,
            anchor_price: {
              anchorType: data.anchorType,
              targetSegment: data.targetSegment,
              competitorBenchmark: data.competitorBenchmark,
              anchorPrice: data.anchorPrice,
              anchorRationale: data.anchorRationale
            }
          };

          await window.AIChallenge.submitWithChallenge(userId, CONFIG.TOOL_SLUG, questionMappings, {
            onReviewStart: () => { setSubmitMessage('AI coach is reviewing...'); },
            onRevise: () => { setSubmitStatus(null); setSubmitMessage(''); setStep(5); },
            onSubmitAnyway: () => { setSubmitStatus('success'); setSubmitMessage('Submission saved successfully!'); },
            onError: (err) => { setSubmitStatus('error'); setSubmitMessage('Failed to save: ' + err.message); }
          });
        } catch (error) {
          console.error('Submit error:', error);
          alert('Submission failed: ' + error.message);
        }
      };

      return (
        <div className="tool-frame">
          <div className="tool-inner">
            {/* Step 0: Cover */}
            {step === 0 && (
              <div style={{ minHeight: '100vh', background: '#000', display: 'flex', alignItems: 'center', justifyContent: 'center', position: 'relative', overflow: 'hidden' }}>
                <div style={{ position: 'absolute', inset: 0, backgroundImage: 'url("asoggetti-sXPbIgVcmW4-unsplash.jpg")', backgroundSize: 'cover', backgroundPosition: 'center', opacity: 0.5 }} />
                <div style={{ position: 'relative', textAlign: 'center', color: '#fff', padding: '0 32px' }} className="animate-in">
                  <h1 className="plaak" style={{ fontSize: 80, marginBottom: 16, textTransform: 'uppercase' }}>STRATEGY DRIVEN PRICING</h1>
                  <p style={{ fontSize: 18, color: '#ccc', marginBottom: 48 }}>Set value-based price anchors before building the product</p>
                  <button onClick={() => setStep(0.5)}
                    style={{ background: '#fff', color: '#000', border: 'none', padding: '16px 48px', fontSize: 16, fontFamily: "'Monument', monospace", letterSpacing: '0.1em', textTransform: 'uppercase', cursor: 'pointer', transition: 'all 0.2s ease', minHeight: 44 }}
                    onMouseOver={e => { e.target.style.background = '#FFF469'; }}
                    onMouseOut={e => { e.target.style.background = '#fff'; }}
                  >START</button>
                </div>
              </div>
            )}

            {/* Step 0.5: Intro */}
            {step === 0.5 && (
              <IntroPage onNext={() => setStep(1)} />
            )}

            {/* Steps 1-5: Wizard */}
            {[1,2,3,4,5].includes(step) && (
              <div className="wizard-layout">
                <div className="wizard-main">
                  <MobileStepBar currentStep={step} totalSteps={5} />

                  <div className="wizard-content animate-in">
                    {step === 1 && <><DependencyContext deps={deps} /><Step1Page data={data} updateFeature={updateFeature} addFeature={addFeature} removeFeature={removeFeature} /></>}
                    {step === 2 && <Step2Page data={data} updateData={updateData} />}
                    {step === 3 && <Step3Page data={data} updateTier={updateTier} addTier={addTier} removeTier={removeTier} />}
                    {step === 4 && <Step4Page data={data} updateData={updateData} />}
                    {step === 5 && <Step5Page data={data} updateData={updateData} updateAction={updateAction} addAction={addAction} removeAction={removeAction} />}
                  </div>

                  <ButtonFooter
                    onBack={() => setStep(step === 1 ? 0 : step - 1)}
                    onNext={() => {
                      if (step === 1) {
                        if (!isStep1Valid()) return;
                        handleStepNext(1.5, { features: data.features }, 'Feature Classification');
                      } else if (step === 2) {
                        if (!isStep2Valid()) return;
                        handleStepNext(2.5, { anchorType: data.anchorType, targetSegment: data.targetSegment, competitorBenchmark: data.competitorBenchmark, anchorPrice: data.anchorPrice, anchorRationale: data.anchorRationale }, 'Price Anchor Selection');
                      } else if (step === 3) {
                        if (!isStep3Valid()) return;
                        handleStepNext(3.5, { tiers: data.tiers }, 'Tier Bundle Design');
                      } else if (step === 4) {
                        if (!isStep4Valid()) return;
                        handleStepNext(4.5, { mustHaveFeatures: data.mustHaveFeatures, niceToHaveFeatures: data.niceToHaveFeatures, killerFeatures: data.killerFeatures, valueProposition: data.valueProposition }, 'Price-to-Value Alignment');
                      } else if (step === 5) {
                        if (!isStep5Valid()) return;
                        handleStepNext(5.5, { pricingActions: data.pricingActions, pilotPlan: data.pilotPlan, successMetrics: data.successMetrics }, 'Implementation Plan');
                      }
                    }}
                    disabled={aiReviewing}
                    nextLabel={aiReviewing ? 'AI Coach Reviewing...' : step === 5 ? 'View Canvas' : 'Next'}
                    showBack={true}
                  />
                </div>
                <WizardSidebar currentStep={step} data={data} onNavigate={setStep} />
              </div>
            )}

            {/* Transition screens between steps */}
            {[1.5, 2.5, 3.5, 4.5, 5.5].includes(step) && (() => {
              const completedStep = Math.floor(step);
              const nextStep = completedStep === 5 ? 6 : completedStep + 1;
              const t = TRANSITION_CONTENT[completedStep];
              return (
                <div style={{ minHeight: '100vh', background: '#000', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                  <div style={{ maxWidth: 640, padding: '0 32px', textAlign: 'center', color: '#fff' }} className="animate-in">
                    <div className="monument" style={{ fontSize: 12, color: '#FFF469', letterSpacing: '0.1em', marginBottom: 16 }}>
                      STEP {completedStep} OF 5 COMPLETE
                    </div>
                    <h1 className="plaak" style={{ fontSize: 48, marginBottom: 12 }}>{t.title}</h1>
                    <p style={{ fontSize: 16, color: '#ccc', marginBottom: 48 }}>{t.text}</p>

                    <div style={{ background: '#111', border: '1px solid #333', borderLeft: '4px solid #FFF469', padding: '20px 24px', marginBottom: 24, textAlign: 'left' }}>
                      <span className="monument" style={{ fontSize: 10, color: '#FFF469', display: 'block', marginBottom: 8 }}>BRUTAL TRUTH</span>
                      <p style={{ fontSize: 14, color: '#ccc', lineHeight: 1.7 }}>{t.brutalTruth}</p>
                    </div>

                    <div style={{ background: '#111', border: '1px solid #333', borderLeft: '4px solid #666', padding: '20px 24px', marginBottom: 48, textAlign: 'left' }}>
                      <span className="monument" style={{ fontSize: 10, color: '#999', display: 'block', marginBottom: 8 }}>PEER PROOF</span>
                      <p style={{ fontSize: 14, color: '#ccc', lineHeight: 1.7, fontStyle: 'italic' }}>{t.peerProof}</p>
                    </div>

                    <button
                      onClick={() => setStep(nextStep)}
                      style={{ background: '#fff', color: '#000', border: 'none', padding: '16px 48px', fontSize: 16, fontFamily: "'Monument', monospace", letterSpacing: '0.1em', textTransform: 'uppercase', cursor: 'pointer', transition: 'all 0.2s ease' }}
                      onMouseOver={e => { e.target.style.background = '#FFF469'; }}
                      onMouseOut={e => { e.target.style.background = '#fff'; }}
                    >CONTINUE</button>
                  </div>
                </div>
              );
            })()}

            {/* Step 6: Canvas */}
            {step === 6 && (
              <CanvasPage
                data={data}
                onExport={exportPDF}
                onSubmit={handleSubmit}
              />
            )}
          </div>
        </div>
      );
    }

    // Intro Page Component
    function IntroPage({ onNext }) {
      return (
        <div className="bg-black text-white min-h-screen p-16">
          <div className="max-w-5xl mx-auto">
            <h1 className="plaak mb-16 animate-in" style={{fontSize: '100px'}}>
              BEFORE WE START
            </h1>

            {/* Sprint Info */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.05s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>SPRINT INFO</h2>
              <div className="bg-white text-black p-8">
                <p className="text-2xl font-bold mb-4">Sprint 18: Strategy Driven Pricing</p>
                <p className="text-xl leading-relaxed mb-4">
                  A 1-2% price tweak can beat extensive cost-cutting efforts. This sprint helps you set value-based price anchors and finalize product/feature bundles based on actual willingness to pay.
                </p>
                <div className="border-l-4 border-black pl-4 italic text-lg">
                  &quot;Pricing is not a formula you set and forget—it&apos;s an ongoing strategic weapon.&quot;
                </div>
              </div>
            </div>

            {/* Purpose */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <h2 className="plaak text-6xl mb-6">PURPOSE</h2>

              <div className="border-l-4 border-white pl-6 mb-6">
                <p className="text-3xl italic mb-2">&quot;Price Before Product: faster profit gains come from a 1-2% price tweak, not extensive cost-cutting.&quot;</p>
                <p className="text-xl text-gray-400">— FAST TRACK PRICING PRINCIPLE</p>
              </div>

              <p className="text-3xl leading-relaxed mb-4">
                Most companies build products first, then set prices. This approach leaves money on the table. Set your anchor price FIRST based on willingness to pay, then build the product around it.
              </p>
            </div>

            {/* Mistakes to Avoid */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>MISTAKES TO AVOID</h2>

              <div className="bg-white text-black p-6 mb-6 border-4 border-yellow-400">
                <p className="riforma-bold text-2xl mb-4">COMMON PRICING FAILURES:</p>
                <ul className="text-xl space-y-3">
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">1.</span>
                    <span><strong>Too many tiers:</strong> Keep to 2–3 tiers max for clarity</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">2.</span>
                    <span><strong>Ignoring WTP:</strong> Don&apos;t guess your price—use real data or pilot tests</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">3.</span>
                    <span><strong>Overcomplicating features:</strong> If it doesn&apos;t increase WTP, it&apos;s noise</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">4.</span>
                    <span><strong>No follow-through:</strong> Pricing strategy is worthless without execution and testing</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">5.</span>
                    <span><strong>Product-first thinking:</strong> Building before pricing leads to margin compression and misalignment</span>
                  </li>
                </ul>
              </div>
            </div>

            {/* The Journey */}
            <div className="mb-16 animate-in" style={{animationDelay: '0.3s'}}>
              <h2 className="plaak text-6xl mb-8">THE JOURNEY</h2>
              <div className="grid grid-cols-5 gap-4 text-center">
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">01</div>
                  <p className="text-xl font-bold mb-2">FEATURES</p>
                  <p className="text-base text-gray-400">Classify by WTP</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">02</div>
                  <p className="text-xl font-bold mb-2">ANCHOR</p>
                  <p className="text-base text-gray-400">Set price position</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">03</div>
                  <p className="text-xl font-bold mb-2">TIERS</p>
                  <p className="text-base text-gray-400">Design 2-3 bundles</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">04</div>
                  <p className="text-xl font-bold mb-2">ALIGN</p>
                  <p className="text-base text-gray-400">Map price to value</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">05</div>
                  <p className="text-xl font-bold mb-2">IMPLEMENT</p>
                  <p className="text-base text-gray-400">Action plan</p>
                </div>
              </div>
            </div>

            {/* Next Button */}
            <button
              onClick={onNext}
              className="btn-primary w-full text-3xl py-8 plaak"
            >
              LET&apos;S START →
            </button>
          </div>
        </div>
      );
    }

    // Step 1: Feature Classification
    function Step1Page({ data, updateFeature, addFeature, removeFeature }) {
      return (
        <>
            <div className="step-indicator"><span>STEP 01</span><span className="step-time">~8 min</span></div>
            <h2 className="step-heading">FEATURE CLASSIFICATION</h2>
            <p className="step-hint">Classify 5+ features by willingness to pay: Must-Have, Nice-to-Have, or Killer.</p>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                Pricing is the fastest profit lever you have. Even a small 1-2% price increase can spark a far larger jump in net margin than most cost-cutting efforts. The key is classifying features by willingness to pay (WTP): Must-Have features are essential and customers will not buy without them, Nice-to-Have features are moderate value-adds for upselling, and Killer features are ones customers place no value on and should be removed. Get this classification right, and 80% of your pricing strategy falls into place.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Hermann Simon's research in "Confessions of the Pricing Man" demonstrates that a mere 1% price increase can drive an approximately 11% increase in operating profit, making pricing the single most powerful profit lever available (Simon, 2015). Separately, a McKinsey Global Institute study of 1,200 companies found that a 1% improvement in price, if volumes remained stable, generated an 8.7% increase in operating profits on average -- nearly 50% more than a 1% fall in variable costs. Structured feature classification based on willingness-to-pay data reduces pricing errors by 25-40% compared to intuition-based approaches (Nagle &amp; Muller, "The Strategy and Tactics of Pricing," 2017).
            </ScienceBox>

            {/* Common Mistake */}
            <WarningBox>
                The most dangerous mistake is classifying features based on internal assumptions rather than actual customer WTP data. <strong>Bad:</strong> Labeling a feature "Must-Have" because the engineering team spent months building it, or because a competitor has it. <strong>Good:</strong> Classifying based on real evidence -- customer interviews, survey data, or pilot test results showing what percentage of customers would pay more (or walk away) based on that feature.
            </WarningBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Classify 5+ features as Must-Have, Nice-to-Have, or Killer
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Must-Have features are essential—customers won&apos;t buy if missing. Nice-to-Have items are moderately valued. Killer features are what customers don&apos;t place value on—remove them.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Use your WTP data from Sprint 17 to classify features. Focus on what customers will actually pay for, not internal assumptions about value.
            </p>

            {/* Features List */}
            <div className="mb-12">
              {data.features.map((feature, index) => (
                <div key={feature.id} className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                  <div className="flex justify-between items-start mb-4">
                    <h4 className="riforma-bold text-2xl">Feature {index + 1}</h4>
                    {data.features.length > 1 && (
                      <button
                        onClick={() => removeFeature(feature.id)}
                        className="text-red-600 hover:text-red-800 text-sm"
                      >
                        REMOVE
                      </button>
                    )}
                  </div>

                  <div className="space-y-4">
                    <div>
                      <label className="monument text-sm block mb-2">FEATURE NAME <span className="text-red-500">*</span></label>
                      <ScienceBookmarkIcon>
                          Simon (2015) found that companies with precisely named and scoped features achieve 20% higher WTP scores because customers can articulate exactly what they are paying for.
                      </ScienceBookmarkIcon>
                      <input
                        type="text"
                        value={feature.name}
                        onChange={(e) => updateFeature(feature.id, 'name', e.target.value)}
                        placeholder="Real-time collaboration with team members across 3 offices"
                        className="w-full"
                      />
                      <div className="char-counter">{feature.name.length}/300 (min 10)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">CATEGORY <span className="text-red-500">*</span></label>
                      <ScienceBookmarkIcon>
                          The Must-Have / Nice-to-Have / Killer classification mirrors the Kano Model from product design research, which shows that accurately categorizing features predicts purchase intent with 78% accuracy (Kano et al., 1984; updated by Berger et al., 1993).
                      </ScienceBookmarkIcon>
                      <select
                        value={feature.category}
                        onChange={(e) => updateFeature(feature.id, 'category', e.target.value)}
                        className="w-full"
                      >
                        <option value="must-have">Must-Have (Essential for purchase)</option>
                        <option value="nice-to-have">Nice-to-Have (Moderate value add)</option>
                        <option value="killer">Killer (Low/no value - remove)</option>
                      </select>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">WTP IMPACT <span className="text-red-500">*</span></label>
                      <ScienceBookmarkIcon>
                          Quantifying WTP impact is critical: McKinsey research shows that companies using data-driven WTP estimates set prices 15-25% more accurately than those relying on gut feel, directly translating to higher margins.
                      </ScienceBookmarkIcon>
                      <input
                        type="text"
                        value={feature.wtpImpact}
                        onChange={(e) => updateFeature(feature.id, 'wtpImpact', e.target.value)}
                        placeholder="70% of surveyed customers said they'd pay 25% premium for this"
                        className="w-full"
                      />
                      <div className="char-counter">{feature.wtpImpact.length}/300 (min 20)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">CLASSIFICATION RATIONALE <span className="text-red-500">*</span></label>
                      <p className="text-sm text-gray-600 mb-2">Why did you classify it this way? What data supports this?</p>
                      <textarea
                        value={feature.rationale}
                        onChange={(e) => updateFeature(feature.id, 'rationale', e.target.value)}
                        placeholder="Based on 15 customer interviews, this solves the #1 pain point: coordination delays cost 8 hours/week. Without it, 80% said they wouldn't purchase."
                        className="w-full"
                        rows={3}
                      />
                      <div className="char-counter">{feature.rationale.length}/1000 (min 30)</div>
                    </div>
                  </div>
                </div>
              ))}
              <button onClick={addFeature} className="btn-back" style={{ width: '100%', textAlign: 'center' }}>+ ADD FEATURE</button>
            </div>
        </>
      );
    }

    // Step 2: Price Anchor Selection
    function Step2Page({ data, updateData }) {
      return (
        <>
            <div className="step-indicator"><span>STEP 02</span><span className="step-time">~5 min</span></div>
            <h2 className="step-heading">PRICE ANCHOR SELECTION</h2>
            <p className="step-hint">Choose your price position and justify it with WTP data.</p>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                Your anchor price is the single most consequential pricing decision you will make. Select premium, mid-tier, or entry-level based on your brand ambitions and profit goals -- this price anchor sets the stage for everything else. Set it FIRST based on willingness to pay, then build the product around it. As Hermann Simon warns: ignoring anchoring psychology causes more pricing failures than any other factor. The anchor shapes every subsequent customer conversation about value.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Anchoring bias is one of the most robust findings in behavioral economics. Tversky &amp; Kahneman (1974) demonstrated that initial price exposure disproportionately influences subsequent value judgments. In pricing, this means the first number a customer sees becomes their reference point. A study by Ariely, Loewenstein &amp; Prelec (2003) at MIT found that arbitrary anchors influenced WTP by up to 60-80%. Simon (2015) applies this directly: companies that deliberately set a high anchor and justify it with value capture 15-30% more revenue than those who let competitors or costs set their reference price.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Choose your price position: Premium, Mid-tier, or Entry-level
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Set your anchor price FIRST based on willingness to pay, then build the product around it. This maximizes returns and matches real customer demand.&quot;
              </p>
            </div>

            <div className="space-y-6 mb-12">
              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.15s'}}>
                <label className="monument text-sm block mb-2">ANCHOR TYPE <span className="text-red-500">*</span></label>
                <select
                  value={data.anchorType}
                  onChange={(e) => updateData('anchorType', e.target.value)}
                  className="w-full"
                >
                  <option value="">Select anchor position...</option>
                  <option value="premium">Premium - High value, high margin, selective customers</option>
                  <option value="mid-tier">Mid-Tier - Balanced value, broad appeal</option>
                  <option value="entry-level">Entry-Level - Volume play, accessible pricing</option>
                </select>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.2s'}}>
                <label className="monument text-sm block mb-2">TARGET CUSTOMER SEGMENT <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Who is the ideal customer for this price anchor?</p>
                <textarea
                  value={data.targetSegment}
                  onChange={(e) => updateData('targetSegment', e.target.value)}
                  placeholder="Enterprise clients with 50-200 employees, annual revenue $10M+, currently using 3+ disconnected tools, willing to pay premium for integration. Primary buyer: VP Operations with $50K+ budget authority."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.targetSegment.length}/1000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.25s'}}>
                <label className="monument text-sm block mb-2">COMPETITOR BENCHMARK <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What do competitors charge? Where do you fit?</p>
                <textarea
                  value={data.competitorBenchmark}
                  onChange={(e) => updateData('competitorBenchmark', e.target.value)}
                  placeholder="Competitor A charges $299/month for similar features but lacks real-time collaboration. Competitor B offers premium at $499/month. Market average is $350/month. Our feature set justifies positioning at $425/month."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.competitorBenchmark.length}/1000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">ANCHOR PRICE POINT <span className="text-red-500">*</span></label>
                <input
                  type="text"
                  value={data.anchorPrice}
                  onChange={(e) => updateData('anchorPrice', e.target.value)}
                  placeholder="$425 per month per team (5 users), $75/month for additional users"
                  className="w-full"
                />
                <div className="char-counter">{data.anchorPrice.length}/300 (min 5)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.35s'}}>
                <label className="monument text-sm block mb-2">ANCHOR RATIONALE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Why this price? What data supports it?</p>
                <textarea
                  value={data.anchorRationale}
                  onChange={(e) => updateData('anchorRationale', e.target.value)}
                  placeholder="Recommend Premium anchor of $425/month because: (1) 70% of surveyed customers said they'd pay this for Features A, B, C; (2) Current solutions cost them $8K/year in lost productivity; (3) Our must-have features deliver 50% time savings worth $15K annually; (4) At $5,100/year, we capture 34% of created value."
                  className="w-full"
                  rows={5}
                />
                <div className="char-counter">{data.anchorRationale.length}/2000 (min 100)</div>
              </div>
            </div>
        </>
      );
    }

    // Step 3: Tier Bundle Design
    function Step3Page({ data, updateTier, addTier, removeTier }) {
      return (
        <>
            <div className="step-indicator"><span>STEP 03</span><span className="step-time">~8 min</span></div>
            <h2 className="step-heading">TIER BUNDLE DESIGN</h2>
            <p className="step-hint">Create 2-3 pricing tiers with bundled features for different customer segments.</p>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                Different customer segments have different budgets and different needs. Offer 2-3 tiers maximum -- ranging from basic to premium -- with bundled features accordingly. The Core tier should hit 80% of users with Must-Have features; the Pro tier costs approximately 50% more and serves power users who value advanced functions. Keep it simple: if you cannot summarize each tier in one sentence of benefits, your structure is too complex. Capture higher margins from top-tier clients while still serving cost-conscious buyers.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Research on the "decoy effect" (Huber, Payne &amp; Puto, 1982) shows that adding a strategically positioned third option can increase selection of the target tier by 40%. When customers see three tiers, the middle option becomes the natural choice -- a phenomenon confirmed by Simonson (1989) as "extremeness aversion." Nagle &amp; Muller (2017) found that companies limiting themselves to 2-3 clearly differentiated tiers achieve 30% higher conversion rates than those with complex multi-tier structures, because simplified choice reduces decision paralysis.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Create 2-3 pricing tiers (maximum 3 for clarity)
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Core tier hits 80% of users; Pro tier costs 50% more for power users who value advanced functions. Keep it simple.&quot;
              </p>
            </div>

            <div className="mb-12">
              {data.tiers.map((tier, index) => (
                <div key={tier.id} className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                  <div className="flex justify-between items-start mb-4">
                    <h4 className="riforma-bold text-2xl">Tier {index + 1}</h4>
                    {data.tiers.length > 1 && (
                      <button
                        onClick={() => removeTier(tier.id)}
                        className="text-red-600 hover:text-red-800 text-sm"
                      >
                        REMOVE
                      </button>
                    )}
                  </div>

                  <div className="space-y-4">
                    <div>
                      <label className="monument text-sm block mb-2">TIER NAME <span className="text-red-500">*</span></label>
                      <input
                        type="text"
                        value={tier.name}
                        onChange={(e) => updateTier(tier.id, 'name', e.target.value)}
                        placeholder="Core / Pro / Enterprise"
                        className="w-full"
                      />
                      <div className="char-counter">{tier.name.length}/100 (min 5)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">PRICE POINT <span className="text-red-500">*</span></label>
                      <input
                        type="text"
                        value={tier.price}
                        onChange={(e) => updateTier(tier.id, 'price', e.target.value)}
                        placeholder="$299/month or $2,990/year (17% savings)"
                        className="w-full"
                      />
                      <div className="char-counter">{tier.price.length}/200 (min 3)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">INCLUDED FEATURES <span className="text-red-500">*</span></label>
                      <p className="text-sm text-gray-600 mb-2">What features are included in this tier?</p>
                      <textarea
                        value={tier.features}
                        onChange={(e) => updateTier(tier.id, 'features', e.target.value)}
                        placeholder="Real-time collaboration for up to 5 users&#10;Shared workspace with 50GB storage&#10;Basic reporting and analytics&#10;Email support (24-hour response)&#10;Mobile app access"
                        className="w-full"
                        rows={4}
                      />
                      <div className="char-counter">{tier.features.length}/1000 (min 50)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">TARGET CUSTOMER <span className="text-red-500">*</span></label>
                      <textarea
                        value={tier.targetCustomer}
                        onChange={(e) => updateTier(tier.id, 'targetCustomer', e.target.value)}
                        placeholder="Small teams (5-15 people) needing basic collaboration, budget-conscious, willing to sacrifice advanced features for lower price"
                        className="w-full"
                        rows={2}
                      />
                      <div className="char-counter">{tier.targetCustomer.length}/500 (min 30)</div>
                    </div>

                    <div>
                      <label className="monument text-sm block mb-2">EXPECTED MARGIN % <span className="text-red-500">*</span></label>
                      <input
                        type="text"
                        value={tier.margin}
                        onChange={(e) => updateTier(tier.id, 'margin', e.target.value)}
                        placeholder="65% gross margin"
                        className="w-full"
                      />
                      <div className="char-counter">{tier.margin.length}/100 (min 3)</div>
                    </div>
                  </div>
                </div>
              ))}
              {data.tiers.length < 3 && (
                <button onClick={addTier} className="btn-back" style={{ width: '100%', textAlign: 'center' }}>+ ADD TIER (Max 3)</button>
              )}
            </div>
        </>
      );
    }

    // Step 4: Price-to-Value Alignment
    function Step4Page({ data, updateData }) {
      return (
        <>
            <div className="step-indicator"><span>STEP 04</span><span className="step-time">~5 min</span></div>
            <h2 className="step-heading">PRICE-TO-VALUE ALIGNMENT</h2>
            <p className="step-hint">Map features to anchor price and identify what to remove.</p>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                This is where your pricing strategy comes together. Combine Must-Have features to lock in the anchor price. Use selected Nice-to-Have items as upsells and tier differentiators. Ditch Killer features that cost money to build but do not raise WTP. Map each feature to a real customer pain point, proving why it justifies your anchor price. Your value proposition from Sprint 15 and your product decisions from Sprint 17 should directly align with your pricing here -- if they do not, something is wrong.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Research on value-price alignment by Anderson, Narus &amp; Van Rossum (2006, HBR) found that companies able to quantify their value proposition in monetary terms win deals at 3x the rate of competitors who cannot. Simon (2015) emphasizes that the core message must be clear: "We solve a real, high-stakes problem, so we warrant a premium price." Customers pay for benefits -- time saved, revenue boosted, risk reduced -- and your pricing must explicitly connect features to these measurable outcomes. Removing low-value features also signals confidence and reduces perceived complexity (Iyengar &amp; Lepper, 2000).
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Map features to anchor price and identify what to remove
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Combine Must-Have features to lock in the anchor price. Use Nice-to-Have items as upsells. Ditch Killer features that don&apos;t raise WTP.&quot;
              </p>
            </div>

            <div className="space-y-6 mb-12">
              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.15s'}}>
                <label className="monument text-sm block mb-2">MUST-HAVE FEATURES (Lock in anchor price) <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Which features justify your anchor price? Why?</p>
                <textarea
                  value={data.mustHaveFeatures}
                  onChange={(e) => updateData('mustHaveFeatures', e.target.value)}
                  placeholder="Real-time collaboration: Customers won't buy without it—saves 8 hours/week in coordination time, worth $12K annually.&#10;&#10;Shared workspace: Essential for remote teams—eliminates email chaos, reduces errors by 40%."
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.mustHaveFeatures.length}/2000 (min 100)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.2s'}}>
                <label className="monument text-sm block mb-2">NICE-TO-HAVE FEATURES (Upsell opportunities) <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Which features drive tier upgrades?</p>
                <textarea
                  value={data.niceToHaveFeatures}
                  onChange={(e) => updateData('niceToHaveFeatures', e.target.value)}
                  placeholder="Advanced analytics: 30% of customers willing to pay 25% premium for deeper insights.&#10;&#10;Priority support: 20% value 4-hour response time, will upgrade for this."
                  className="w-full"
                  rows={5}
                />
                <div className="char-counter">{data.niceToHaveFeatures.length}/2000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.25s'}}>
                <label className="monument text-sm block mb-2">KILLER FEATURES (Remove these) <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Which features add cost without increasing WTP?</p>
                <textarea
                  value={data.killerFeatures}
                  onChange={(e) => updateData('killerFeatures', e.target.value)}
                  placeholder="Gamification badges: Customer feedback shows zero interest—adds dev cost with no WTP impact.&#10;&#10;Social sharing: Only 2% of users requested this—remove to simplify."
                  className="w-full"
                  rows={5}
                />
                <div className="char-counter">{data.killerFeatures.length}/2000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">VALUE PROPOSITION STATEMENT <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Why should customers pay your anchor price?</p>
                <textarea
                  value={data.valueProposition}
                  onChange={(e) => updateData('valueProposition', e.target.value)}
                  placeholder="For distributed teams spending 8+ hours per week on coordination, our platform delivers real-time collaboration that saves $12K annually. At $5,100/year, we capture only 34% of the value we create—making this a no-brainer ROI of 2.4x in year one."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.valueProposition.length}/1000 (min 100)</div>
              </div>
            </div>
        </>
      );
    }

    // Step 5: Implementation Plan
    function Step5Page({ data, updateData, updateAction, addAction, removeAction }) {
      return (
        <>
            <div className="step-indicator"><span>STEP 05</span><span className="step-time">~8 min</span></div>
            <h2 className="step-heading">IMPLEMENTATION PLAN</h2>
            <p className="step-hint">Define actions, pilots, and success metrics to execute your pricing strategy.</p>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                Pricing strategy without execution is worthless. Implementation and testing turn your pricing decisions into actual profit gains. Pilot with a small group first, monitor acceptance and pushback, then adjust before full rollout. Schedule quarterly pricing reviews because markets, competitors, and products are constantly evolving. Cross-functional alignment is essential: if sales, marketing, and finance are not on the same page, pricing efforts die on the vine. Arm your team with a strong "price narrative" they can confidently deliver.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Research by Hinterhuber (2008, Industrial Marketing Management) across 85 companies found that those running structured pricing pilots before full rollout achieved 23% higher profit improvements than those who launched pricing changes organization-wide without testing. Simon (2015) advocates continuous pricing iteration: setting it once and forgetting it leads to lost revenue. A Bain &amp; Company study found that companies with formal pricing review cadences (quarterly or better) maintained 5-8% higher margins over 3 years compared to peers who treated pricing as a one-time decision.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Define actions, pilots, and success metrics
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Pricing strategy is worthless without execution. Implementation and testing turn your pricing decisions into actual profit gains.&quot;
              </p>
            </div>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Pricing Actions</h4>
                {data.pricingActions.map((action, index) => (
                  <div key={action.id} className="bg-gray-50 border-2 border-gray-200 p-4 mb-4 animate-in" style={{animationDelay: `${0.15 + index * 0.03}s`}}>
                    <div className="flex justify-between items-center mb-3">
                      <span className="monument text-xs">ACTION {index + 1}</span>
                      {data.pricingActions.length > 1 && (
                        <button onClick={() => removeAction(action.id)} className="text-red-600 text-sm">REMOVE</button>
                      )}
                    </div>
                    <div className="space-y-3">
                      <div>
                        <label className="monument text-xs block mb-1">ACTION DESCRIPTION <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={action.action}
                          onChange={(e) => updateAction(action.id, 'action', e.target.value)}
                          placeholder="Update website pricing page with new 3-tier structure and value propositions"
                          className="w-full"
                        />
                        <div className="char-counter text-xs">{action.action.length}/300 (min 20)</div>
                      </div>
                      <div className="grid grid-cols-2 gap-3">
                        <div>
                          <label className="monument text-xs block mb-1">OWNER <span className="text-red-500">*</span></label>
                          <input
                            type="text"
                            value={action.owner}
                            onChange={(e) => updateAction(action.id, 'owner', e.target.value)}
                            placeholder="Sarah Chen (Marketing)"
                            className="w-full"
                          />
                          <div className="char-counter text-xs">{action.owner.length}/100 (min 5)</div>
                        </div>
                        <div>
                          <label className="monument text-xs block mb-1">DEADLINE <span className="text-red-500">*</span></label>
                          <input
                            type="text"
                            value={action.deadline}
                            onChange={(e) => updateAction(action.id, 'deadline', e.target.value)}
                            placeholder="March 15, 2025"
                            className="w-full"
                          />
                          <div className="char-counter text-xs">{action.deadline.length}/100 (min 5)</div>
                        </div>
                      </div>
                      <div>
                        <label className="monument text-xs block mb-1">EXPECTED IMPACT <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={action.expectedImpact}
                          onChange={(e) => updateAction(action.id, 'expectedImpact', e.target.value)}
                          placeholder="15% increase in average deal size, 10% improvement in win rate"
                          className="w-full"
                        />
                        <div className="char-counter text-xs">{action.expectedImpact.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addAction} className="btn-back" style={{ width: '100%', textAlign: 'center' }}>+ ADD ACTION</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">PILOT TESTING PLAN <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How will you test the new pricing before full rollout?</p>
                <textarea
                  value={data.pilotPlan}
                  onChange={(e) => updateData('pilotPlan', e.target.value)}
                  placeholder="Phase 1 (Weeks 1-2): Soft launch to 10 existing customers in renewal conversations. Gather feedback.&#10;&#10;Phase 2 (Weeks 3-4): Launch to 25 new prospects through outbound sales. Track conversion rates by tier.&#10;&#10;Phase 3 (Week 5): Analyze data, adjust messaging, prepare full rollout."
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.pilotPlan.length}/2000 (min 100)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.35s'}}>
                <label className="monument text-sm block mb-2">SUCCESS METRICS <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How will you measure success?</p>
                <textarea
                  value={data.successMetrics}
                  onChange={(e) => updateData('successMetrics', e.target.value)}
                  placeholder="Primary: 20% increase in average contract value within 90 days&#10;Secondary: 15% improvement in gross margin percentage&#10;Adoption: 60% of customers select Pro tier or higher&#10;Retention: <5% churn due to pricing changes"
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.successMetrics.length}/2000 (min 100)</div>
              </div>
            </div>
        </>
      );
    }

    // Canvas Page
    function CanvasPage({ data, onExport, onSubmit }) {
      return (
        <div className="bg-gray-100 min-h-screen p-16">
          <div className="max-w-6xl mx-auto">
            {/* Canvas Content */}
            <div id="canvas-content" className="bg-white p-16 mb-8">
              <div className="border-b-4 border-black pb-8 mb-8">
                <h1 className="plaak text-7xl mb-2">PRICING STRATEGY</h1>
                <p className="text-2xl text-gray-600">Strategy Driven Pricing - Sprint 18</p>
              </div>

              {/* Price Anchor */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Price Anchor</h2>
                <div className="bg-gray-50 p-6 border-l-4 border-black">
                  <p className="text-xl mb-2"><strong>Type:</strong> {data.anchorType || 'Not set'}</p>
                  <p className="text-xl mb-2"><strong>Price Point:</strong> {data.anchorPrice || 'Not set'}</p>
                  <p className="text-lg text-gray-700 mt-4">{data.anchorRationale.substring(0, 200)}...</p>
                </div>
              </div>

              {/* Pricing Tiers */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Pricing Tiers</h2>
                <div className="grid grid-cols-3 gap-4">
                  {data.tiers.map((tier, i) => (
                    <div key={i} className="bg-gray-50 p-4 border-2 border-black">
                      <p className="riforma-bold text-2xl mb-2">{tier.name}</p>
                      <p className="text-3xl plaak mb-2">{tier.price}</p>
                      <p className="text-sm text-gray-600">Margin: {tier.margin}</p>
                    </div>
                  ))}
                </div>
              </div>

              {/* Feature Classification */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Feature Classification</h2>
                <div className="space-y-4">
                  <div className="bg-gray-50 p-4 border-l-4 border-black">
                    <p className="riforma-bold text-xl mb-2">Must-Have Features</p>
                    <p className="text-base">{data.mustHaveFeatures.substring(0, 150)}...</p>
                  </div>
                  <div className="bg-gray-50 p-4 border-l-4 border-black">
                    <p className="riforma-bold text-xl mb-2">Nice-to-Have Features</p>
                    <p className="text-base">{data.niceToHaveFeatures.substring(0, 150)}...</p>
                  </div>
                  <div className="bg-red-50 p-4 border-l-4 border-red-600">
                    <p className="riforma-bold text-xl mb-2">Killer Features (Remove)</p>
                    <p className="text-base">{data.killerFeatures.substring(0, 150)}...</p>
                  </div>
                </div>
              </div>

              {/* Value Proposition */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Value Proposition</h2>
                <div className="bg-yellow-50 p-6 border-4 border-yellow-400">
                  <p className="text-xl">{data.valueProposition}</p>
                </div>
              </div>

              {/* Implementation Actions */}
              <div>
                <h2 className="riforma-bold text-4xl mb-4">Next Actions</h2>
                <div className="space-y-2">
                  {data.pricingActions.slice(0, 5).map((action, i) => (
                    <div key={i} className="flex items-start text-base">
                      <span className="riforma-bold mr-3">{i + 1}.</span>
                      <div>
                        <p className="riforma-bold">{action.action}</p>
                        <p className="text-sm text-gray-600">{action.owner} - {action.deadline}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="mt-12 pt-8 border-t-2 border-gray-200 text-center text-sm text-gray-500">
                <p>Generated: {new Date().toLocaleDateString()}</p>
                <p className="mt-1">Fast Track Sprint 18 - Strategy Driven Pricing</p>
              </div>
            </div>

            {/* Action Buttons */}
            <div className="flex gap-6 mb-6">
              <button onClick={onExport} className="btn-primary flex-1">
                EXPORT PDF
              </button>
              <button onClick={onSubmit} className="btn-primary flex-1">
                SUBMIT
              </button>
            </div>

            {/* Case Study */}
            <CaseStudy
                before={"A professional services firm used hourly billing with cost-plus margins. They had 20 service features at a single monthly fee with no data on which features customers actually valued. Continuous haggling over scope eroded margins, and one-size-fits-all pricing left money on the table with enterprise clients while losing price-sensitive smaller accounts."}
                after={"After applying the Fast Track pricing method, they packaged outcomes ('Cut your downtime 50% in 3 months') instead of hours, and created a Core tier (3 must-have services) and a Pro tier (2 premium add-ons). Core hit 80% of clients; Pro commanded 50% more for power users who valued advanced support. Average deal size increased 35% and client retention improved because the price narrative was tied directly to measurable ROI."}
                quote={"We had been pricing our costs for years instead of pricing our value. The moment we set the anchor price first based on what customers would actually pay, everything changed -- our margins jumped, our sales conversations became easier, and clients stopped haggling because they could see the ROI was 3x their investment."}
            />
          </div>
        </div>
      );
    }

    /* TransitionScreen, ProgressIndicator, HelpButton are now inline in PricingApp render using TRANSITION_CONTENT */

    // Render App
        ReactDOM.render(<PricingApp />, document.getElementById('root'));
  </script>
</body>
</html>