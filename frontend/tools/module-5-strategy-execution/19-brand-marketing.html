<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Brand and Marketing | Fast Track Program</title>

  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../../shared/js/tool-db.js"></script>
  <script src="../../shared/js/ai-challenge.js"></script>
  <script src="../../shared/js/dependency-injection.js"></script>
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>

  <!-- jsPDF + html2canvas for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <style>
    /* Font Face Declarations */
    @font-face {
      font-family: 'Plaak';
      src: url('Plaak3Trial-43-Bold.woff2') format('woff2');
      font-weight: bold;
      font-style: normal;
    }

    @font-face {
      font-family: 'Riforma';
      src: url('RiformaLL-Regular.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Monument';
      src: url('MonumentGrotesk-Mono.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Riforma', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .plaak {
      font-family: 'Plaak', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: -0.02em;
    }

    .riforma-bold {
      font-family: 'Riforma', sans-serif;
      font-weight: bold;
    }

    .monument {
      font-family: 'Monument', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-in {
      animation: slideIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .fade-in {
      animation: fadeIn 0.4s ease-out;
    }

    .transition-animate-in {
      animation: slideIn 0.6s ease-out;
    }

    /* Button Styles */
    .btn-primary {
      background: #000000;
      color: #FFFFFF;
      padding: 16px 32px;
      border: 2px solid #000000;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: normal;
    }

    .btn-primary:hover:not(:disabled) {
      transform: scale(1.02);
    }

    .btn-primary:disabled {
      background: #E0E0E0;
      border-color: #E0E0E0;
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: #FFFFFF;
      color: #000000;
      padding: 12px 24px;
      border: 2px solid #000000;
      font-size: 16px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-secondary:hover {
      background: #F8F8F8;
    }

    /* Form Styles */
    input[type="text"],
    input[type="number"],
    input[type="email"],
    textarea,
    select {
      border: 1px solid #E0E0E0;
      padding: 12px 16px;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      width: 100%;
      transition: border-color 0.2s ease;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #000000;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    textarea::placeholder {
      white-space: pre-line;
    }

    /* Numbered Section Badge */
    .numbered-section {
      background: #000000;
      color: #FFFFFF;
      padding: 10px 16px;
      font-family: 'Plaak', sans-serif;
      font-size: 26px;
      display: inline-block;
      text-transform: uppercase;
      letter-spacing: -0.02em;
    }

    /* Help Button */
    .help-button {
      position: fixed;
      top: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: #000000;
      color: #FFFFFF;
      font-size: 28px;
      border: none;
      cursor: pointer;
      z-index: 40;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Riforma', sans-serif;
    }

    .help-button:hover {
      background: #FFF469;
      color: #000000;
      transform: scale(1.1);
    }

    /* Progress Indicator */
    .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #E0E0E0;
      transition: all 0.3s ease;
    }

    .progress-dot.active {
      background: #000000;
      transform: scale(1.3);
    }

    .progress-dot.completed {
      background: #000000;
    }

    .progress-line {
      height: 2px;
      background: #E0E0E0;
      flex: 1;
    }

    /* Character Counter */
    .char-counter {
      font-size: 14px;
      color: #666;
      margin-top: 4px;
    }

    .char-counter.invalid {
      color: #EF4444;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, Fragment } = React;

    // Configuration
    const CONFIG = {
      SUPABASE_URL: 'https://lutzzfaedkbsmbobmrzx.supabase.co',
      SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1dHp6ZmFlZGtic21ib2Jtcnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MDA0MDQsImV4cCI6MjA4NjM3NjQwNH0.o2gJba85vDl4NLS-C8Mq3OudWKxet-b0IqO9kazqb8U',
      TOOL_SLUG: 'brand-marketing',
      AUTOSAVE_DELAY: 2000
    };

    const { createClient } = supabase;
    const supabaseClient = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);

    // Make Supabase client globally available for dependency injection
    window.supabaseClient = supabaseClient;

    // Initialize ToolDB and dependency injection
    ToolDB.init(CONFIG.TOOL_SLUG);
    DependencyInjection.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        CognitiveLoad.init('brand-marketing', {"insights":["Brand is not your logo. It is the promise you make and consistently keep.","Marketing without strategy is just noise."],"caseStudy":{"before":"[PLACEHOLDER] Big marketing spend, no clear message.","after":"[PLACEHOLDER] Brand aligned to VP. Lead quality improved 3x.","quote":"[PLACEHOLDER] When the brand matched reality, customers started coming to us."}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

    // Main App Component
    function BrandApp() {
      const [step, setStep] = useState(0);
      const [showHelp, setShowHelp] = useState(false);
      const [showTransition, setShowTransition] = useState(false);
      const [transitionMessage, setTransitionMessage] = useState('');
      const [transitionProgress, setTransitionProgress] = useState(0);
      const [aiReviewing, setAiReviewing] = useState(false);
      const [submitStatus, setSubmitStatus] = useState(null);
      const [submitMessage, setSubmitMessage] = useState('');

      const [data, setData] = useState({
        // Step 1: Brand Promise
        brandPromise: '',
        emotionalConnection: '',
        valuePropositionTransform: '',
        brandEnemy: '',

        // Step 2: Brand Personality
        personalityTraits: [
          { id: 1, trait: '', description: '', example: '' }
        ],
        brandVoice: '',
        brandArchetype: '',

        // Step 3: Cult Brand Model
        employeeBrand: '',
        employeeValues: '',
        employeeStory: '',
        consumerBrand: '',
        consumerExperience: '',
        sharedValues: '',

        // Step 4: Marketing Strategy
        targetSegmentPain: '',
        messagingPillars: [
          { id: 1, pillar: '', rationale: '', channels: '' }
        ],
        contentStrategy: '',

        // Step 5: Implementation
        marketingActions: [
          { id: 1, action: '', owner: '', deadline: '', expectedImpact: '' }
        ],
        successMetrics: '',
        consistencyChecklist: ''
      });

      // Load from localStorage
      useEffect(() => {
        const saved = localStorage.getItem('brand-marketing-data');
        if (saved) {
          try {
            const savedData = JSON.parse(saved);
            setData(savedData);
          } catch (e) {
            console.error('Error loading saved data:', e);
          }
        }
      }, []);

      // Auto-save every 2 seconds
      useEffect(() => {
        const interval = setInterval(() => {
          localStorage.setItem('brand-marketing-data', JSON.stringify(data));
        }, 2000);
        return () => clearInterval(interval);
      }, [data]);

      const updateData = (field, value) => {
        setData({ ...data, [field]: value });
      };

      const addTrait = () => {
        const newTrait = { id: Date.now(), trait: '', description: '', example: '' };
        updateData('personalityTraits', [...data.personalityTraits, newTrait]);
      };

      const removeTrait = (id) => {
        if (data.personalityTraits.length > 1) {
          updateData('personalityTraits', data.personalityTraits.filter(t => t.id !== id));
        }
      };

      const updateTrait = (id, field, value) => {
        const updated = data.personalityTraits.map(t => t.id === id ? { ...t, [field]: value } : t);
        updateData('personalityTraits', updated);
      };

      const addPillar = () => {
        const newPillar = { id: Date.now(), pillar: '', rationale: '', channels: '' };
        updateData('messagingPillars', [...data.messagingPillars, newPillar]);
      };

      const removePillar = (id) => {
        if (data.messagingPillars.length > 1) {
          updateData('messagingPillars', data.messagingPillars.filter(p => p.id !== id));
        }
      };

      const updatePillar = (id, field, value) => {
        const updated = data.messagingPillars.map(p => p.id === id ? { ...p, [field]: value } : p);
        updateData('messagingPillars', updated);
      };

      const addAction = () => {
        const newAction = { id: Date.now(), action: '', owner: '', deadline: '', expectedImpact: '' };
        updateData('marketingActions', [...data.marketingActions, newAction]);
      };

      const removeAction = (id) => {
        if (data.marketingActions.length > 1) {
          updateData('marketingActions', data.marketingActions.filter(a => a.id !== id));
        }
      };

      const updateAction = (id, field, value) => {
        const updated = data.marketingActions.map(a => a.id === id ? { ...a, [field]: value } : a);
        updateData('marketingActions', updated);
      };

      const advanceStep = (fromStep) => {
        if (fromStep >= 1 && fromStep < 5) {
          const messages = ['20% COMPLETE', '40% COMPLETE', '60% COMPLETE', '80% COMPLETE', '100% COMPLETE'];
          const progressValues = [20, 40, 60, 80, 100];

          setTransitionMessage(messages[fromStep - 1]);
          setTransitionProgress(progressValues[fromStep - 1]);
          setShowTransition(true);

          setTimeout(() => {
            setShowTransition(false);
            setStep(fromStep + 1);
          }, 2000);
        } else if (fromStep === 5) {
          setStep(6);
        }
      };

      const goNext = () => {
        if (step === 0.5) {
          setStep(1);
        } else if (step === 0) {
          setStep(0.5);
        }
      };

      const handleNext = async (fromStep) => {
        const userId = localStorage.getItem('ft_user_id');
        if (!userId) { alert('User not authenticated.'); return; }
        setAiReviewing(true);
        try {
          let stepAnswers = {};
          let stepName = '';
          if (fromStep === 1) {
            stepName = 'Brand Promise';
            stepAnswers = { brandPromise: data.brandPromise, emotionalConnection: data.emotionalConnection, valuePropositionTransform: data.valuePropositionTransform, brandEnemy: data.brandEnemy };
          } else if (fromStep === 2) {
            stepName = 'Brand Personality';
            stepAnswers = { personalityTraits: data.personalityTraits, brandVoice: data.brandVoice, brandArchetype: data.brandArchetype };
          } else if (fromStep === 3) {
            stepName = 'Cult Brand Model';
            stepAnswers = { employeeBrand: data.employeeBrand, employeeValues: data.employeeValues, employeeStory: data.employeeStory, consumerBrand: data.consumerBrand, consumerExperience: data.consumerExperience, sharedValues: data.sharedValues };
          } else if (fromStep === 4) {
            stepName = 'Marketing Strategy';
            stepAnswers = { targetSegmentPain: data.targetSegmentPain, messagingPillars: data.messagingPillars, contentStrategy: data.contentStrategy };
          } else if (fromStep === 5) {
            stepName = 'Implementation Plan';
            stepAnswers = { marketingActions: data.marketingActions, successMetrics: data.successMetrics, consistencyChecklist: data.consistencyChecklist };
          }
          const canProceed = await window.AIChallenge.reviewStep(userId, CONFIG.TOOL_SLUG, stepAnswers, stepName);
          if (canProceed) {
            advanceStep(fromStep);
          }
        } catch (err) {
          console.warn('[AIChallenge] Error, allowing passage:', err);
          advanceStep(fromStep);
        } finally {
          setAiReviewing(false);
        }
      };

      const goBack = () => {
        if (step === 6) {
          setStep(5);
        } else if (step > 1) {
          setStep(step - 1);
        } else if (step === 1) {
          setStep(0.5);
        }
      };

      // Validation functions
      const isStep1Valid = () => {
        return data.brandPromise.length >= 50 &&
               data.emotionalConnection.length >= 30 &&
               data.valuePropositionTransform.length >= 50 &&
               data.brandEnemy.length >= 30;
      };

      const isStep2Valid = () => {
        return data.personalityTraits.length >= 3 &&
               data.personalityTraits.every(t =>
                 t.trait.trim().length >= 5 &&
                 t.description.trim().length >= 20 &&
                 t.example.trim().length >= 20
               ) &&
               data.brandVoice.length >= 50 &&
               data.brandArchetype.length >= 20;
      };

      const isStep3Valid = () => {
        return data.employeeBrand.length >= 50 &&
               data.employeeValues.length >= 50 &&
               data.employeeStory.length >= 50 &&
               data.consumerBrand.length >= 50 &&
               data.consumerExperience.length >= 50 &&
               data.sharedValues.length >= 50;
      };

      const isStep4Valid = () => {
        return data.targetSegmentPain.length >= 50 &&
               data.messagingPillars.length >= 3 &&
               data.messagingPillars.every(p =>
                 p.pillar.trim().length >= 10 &&
                 p.rationale.trim().length >= 30 &&
                 p.channels.trim().length >= 20
               ) &&
               data.contentStrategy.length >= 100;
      };

      const isStep5Valid = () => {
        return data.marketingActions.length >= 3 &&
               data.marketingActions.every(a =>
                 a.action.trim().length >= 20 &&
                 a.owner.trim().length >= 5 &&
                 a.deadline.trim().length >= 5 &&
                 a.expectedImpact.trim().length >= 20
               ) &&
               data.successMetrics.length >= 100 &&
               data.consistencyChecklist.length >= 50;
      };

      const exportPDF = async () => {
        try {
          const canvas = document.getElementById('canvas-content');
          if (!canvas) {
            alert('Canvas not found');
            return;
          }

          // Hide images to avoid CORS
          const images = canvas.querySelectorAll('img');
          const imageStates = [];
          images.forEach(img => {
            imageStates.push({ img, display: img.style.display });
            img.style.display = 'none';
          });

          const canvasImage = await html2canvas(canvas, {
            scale: 2,
            logging: false,
            backgroundColor: '#ffffff'
          });

          // Restore images
          imageStates.forEach(({ img, display }) => {
            img.style.display = display;
          });

          const imgWidth = 190;
          const imgHeight = (canvasImage.height * imgWidth) / canvasImage.width;

          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const imgData = canvasImage.toDataURL('image/png');

          pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
          pdf.save('brand-and-marketing.pdf');
        } catch (error) {
          console.error('PDF export error:', error);
          alert('Failed to export PDF: ' + error.message);
        }
      };

      const handleSubmit = async () => {
        try {
          const userId = localStorage.getItem('ft_user_id');
          if (!userId) {
            alert('User not authenticated. Please return to the dashboard.');
            return;
          }

          const questionMappings = {
            cult_model: {
              employeeBrand: data.employeeBrand,
              employeeValues: data.employeeValues,
              employeeStory: data.employeeStory,
              consumerBrand: data.consumerBrand,
              consumerExperience: data.consumerExperience,
              sharedValues: data.sharedValues
            },
            roadmap: {
              marketingActions: data.marketingActions,
              messagingPillars: data.messagingPillars,
              contentStrategy: data.contentStrategy,
              successMetrics: data.successMetrics,
              consistencyChecklist: data.consistencyChecklist
            }
          };

          await window.AIChallenge.submitWithChallenge(userId, CONFIG.TOOL_SLUG, questionMappings, {
            onReviewStart: () => { setSubmitMessage('AI coach is reviewing...'); },
            onRevise: () => { setSubmitStatus(null); setSubmitMessage(''); setStep(5); },
            onSubmitAnyway: () => { setSubmitStatus('success'); setSubmitMessage('Submission saved successfully!'); },
            onError: (err) => { setSubmitStatus('error'); setSubmitMessage('Failed to save: ' + err.message); }
          });
        } catch (error) {
          console.error('Submit error:', error);
          alert('Submission failed: ' + error.message);
        }
      };

      // Render different pages based on step
      if (showTransition) {
        return <TransitionScreen message={transitionMessage} progress={transitionProgress} />;
      }

      if (step === 0) {
        return <CoverPage onStart={goNext} />;
      }

      if (step === 0.5) {
        return <IntroPage onNext={goNext} />;
      }

      if (step === 1) {
        return (
          <Step1Page
            data={data}
            updateData={updateData}
            onNext={() => handleNext(1)}
            onBack={goBack}
            canProceed={!aiReviewing && isStep1Valid()}
            aiReviewing={aiReviewing}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 2) {
        return (
          <Step2Page
            data={data}
            updateData={updateData}
            updateTrait={updateTrait}
            addTrait={addTrait}
            removeTrait={removeTrait}
            onNext={() => handleNext(2)}
            onBack={goBack}
            canProceed={!aiReviewing && isStep2Valid()}
            aiReviewing={aiReviewing}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 3) {
        return (
          <Step3Page
            data={data}
            updateData={updateData}
            onNext={() => handleNext(3)}
            onBack={goBack}
            canProceed={!aiReviewing && isStep3Valid()}
            aiReviewing={aiReviewing}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 4) {
        return (
          <Step4Page
            data={data}
            updateData={updateData}
            updatePillar={updatePillar}
            addPillar={addPillar}
            removePillar={removePillar}
            onNext={() => handleNext(4)}
            onBack={goBack}
            canProceed={!aiReviewing && isStep4Valid()}
            aiReviewing={aiReviewing}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 5) {
        return (
          <Step5Page
            data={data}
            updateData={updateData}
            updateAction={updateAction}
            addAction={addAction}
            removeAction={removeAction}
            onNext={() => handleNext(5)}
            onBack={goBack}
            canProceed={!aiReviewing && isStep5Valid()}
            aiReviewing={aiReviewing}
            setShowHelp={setShowHelp}
          />
        );
      }

      if (step === 6) {
        return (
          <CanvasPage
            data={data}
            onExport={exportPDF}
            onSubmit={handleSubmit}
          />
        );
      }

      return null;
    }

    // Cover Page Component
    function CoverPage({ onStart }) {
      return (
        <div className="relative min-h-screen flex items-center justify-center bg-black">
          <div
            className="absolute inset-0 w-full h-full"
            style={{
              backgroundImage: 'url("kevin-et-laurianne-langlais-yCg-sSDyxsE-unsplash.jpg")',
              backgroundSize: 'cover',
              backgroundPosition: 'center'
            }}
          ></div>
          <div className="absolute inset-0" style={{background: 'linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.85))'}}></div>

          <div className="relative z-10 text-center text-white px-8 max-w-5xl mx-auto">
            <h1 className="plaak animate-in" style={{fontSize: '100px', lineHeight: '1', marginBottom: '32px'}}>
              BRAND AND
            </h1>
            <h2 className="plaak animate-in" style={{fontSize: '80px', lineHeight: '1', marginBottom: '32px', color: '#FFF469', animationDelay: '0.1s'}}>
              MARKETING
            </h2>
            <p className="text-4xl mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              Strategy made visible. Strategy in motion.
            </p>
            <button
              onClick={onStart}
              className="bg-white text-black plaak px-16 py-6 border-4 border-white hover:bg-black hover:text-white transition-all text-3xl animate-in"
              style={{animationDelay: '0.4s'}}
            >
              START
            </button>
          </div>
        </div>
      );
    }

    // Intro Page Component
    function IntroPage({ onNext }) {
      return (
        <div className="bg-black text-white min-h-screen p-16">
          <div className="max-w-5xl mx-auto">
            <h1 className="plaak mb-16 animate-in" style={{fontSize: '100px'}}>
              BEFORE WE START
            </h1>

            {/* Sprint Info */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.05s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>SPRINT INFO</h2>
              <div className="bg-white text-black p-8">
                <p className="text-2xl font-bold mb-4">Sprint 19: Brand and Marketing</p>
                <p className="text-xl leading-relaxed mb-4">
                  Your brand is not your logo. It&apos;s the feeling people get when they think of you. Strong brands outperform the market by 206%. This sprint builds a weaponized brand rooted in strategic clarity and emotional truth.
                </p>
                <div className="border-l-4 border-black pl-4 italic text-lg">
                  &quot;If people believe they share values with a company, they will stay loyal to the brand.&quot; — Howard Schultz
                </div>
              </div>
            </div>

            {/* Purpose */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <h2 className="plaak text-6xl mb-6">PURPOSE</h2>

              <div className="border-l-4 border-white pl-6 mb-6">
                <p className="text-3xl italic mb-2">&quot;Strong marketing is the execution of a sharp strategy. A strong brand is the outward signal of a deep internal truth.&quot;</p>
                <p className="text-xl text-gray-400">— FAST TRACK BRAND PRINCIPLE</p>
              </div>

              <p className="text-3xl leading-relaxed mb-4">
                Most companies die in the fog. This sprint builds your lighthouse. It forces clarity on who you are for, what you solve, and why people should care. When you nail your brand, clients find you, trust you, and stay.
              </p>
            </div>

            {/* Mistakes to Avoid */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>MISTAKES TO AVOID</h2>

              <div className="bg-white text-black p-6 mb-6 border-4 border-yellow-400">
                <p className="riforma-bold text-2xl mb-4">COMMON BRAND FAILURES:</p>
                <ul className="text-xl space-y-3">
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">1.</span>
                    <span><strong>Weak or generic strategy:</strong> 87% of marketers produce content they&apos;re not proud of because brand strategy is unclear</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">2.</span>
                    <span><strong>Unclear brand identity:</strong> Message dies on arrival when brand promise is weak or competitors could say the same thing</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">3.</span>
                    <span><strong>Inconsistent messaging:</strong> Trust disappears when employee brand doesn&apos;t match consumer brand</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">4.</span>
                    <span><strong>Reactive vs proactive:</strong> Following market trends instead of being driven by core belief and values</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">5.</span>
                    <span><strong>No one is for you:</strong> If you don&apos;t know who you&apos;re for, customers can&apos;t identify with you</span>
                  </li>
                </ul>
              </div>
            </div>

            {/* The Journey */}
            <div className="mb-16 animate-in" style={{animationDelay: '0.3s'}}>
              <h2 className="plaak text-6xl mb-8">THE JOURNEY</h2>
              <div className="grid grid-cols-5 gap-4 text-center">
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">01</div>
                  <p className="text-xl font-bold mb-2">PROMISE</p>
                  <p className="text-base text-gray-400">Emotional brand core</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">02</div>
                  <p className="text-xl font-bold mb-2">PERSONALITY</p>
                  <p className="text-base text-gray-400">Who you are</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">03</div>
                  <p className="text-xl font-bold mb-4">CULT MODEL</p>
                  <p className="text-base text-gray-400">Employee + Consumer</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">04</div>
                  <p className="text-xl font-bold mb-2">STRATEGY</p>
                  <p className="text-base text-gray-400">Messaging pillars</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">05</div>
                  <p className="text-xl font-bold mb-2">IMPLEMENT</p>
                  <p className="text-base text-gray-400">Marketing actions</p>
                </div>
              </div>
            </div>

            {/* Next Button */}
            <button
              onClick={onNext}
              className="btn-primary w-full text-3xl py-8 plaak"
            >
              LET&apos;S START →
            </button>
          </div>
        </div>
      );
    }

    // Transition Screen Component
    function TransitionScreen({ message, progress }) {
      return (
        <div className="fixed inset-0 bg-black text-white flex items-center justify-center z-50 fade-in">
          <div className="text-center px-8">
            <h1 className="plaak transition-animate-in" style={{fontSize: '120px', marginBottom: '32px'}}>
              SECTION COMPLETE
            </h1>

            <div className="max-w-2xl mx-auto mb-8 transition-animate-in" style={{animationDelay: '0.2s'}}>
              <div className="h-2 bg-gray-800 mb-4">
                <div
                  className="h-full bg-white transition-all duration-1000"
                  style={{width: `${progress}%`}}
                ></div>
              </div>
              <p className="monument text-xl tracking-wider">{message}</p>
            </div>
          </div>
        </div>
      );
    }

    // Help Modal Component
    function HelpModal({ step, onClose }) {
      const helpContent = {
        1: {
          why: "Your brand promise transforms a transactional value proposition into an emotional human experience. It's the foundation that separates memorable brands (Airbnb's 'belong anywhere') from forgettable commodities ('we rent rooms').",
          what: "A brand promise is a crystal-clear statement of the transformation you deliver. It answers: What feeling do you create? What change do you enable? What do people become after working with you?",
          how: "Write one sentence that captures the transformation. Test it: Could a competitor say this? If yes, it's not differentiated. Make it emotional, specific, and polarizing. Define what you're NOT (your brand enemy) to clarify what you ARE."
        },
        2: {
          why: "Brand personality makes you recognizable and memorable. Red Bull doesn't just sell energy drinks—they act like rebels and talk like adrenaline junkies. Personality creates consistency across every touchpoint.",
          what: "Define 3-5 core personality traits that show up in every interaction. Each trait needs a description and real example. Add your brand voice (how you sound) and archetype (what role you play).",
          how: "List traits customers would use to describe you. Be specific: not 'friendly' but 'direct and challenging'. Give examples: 'In meetings, we interrupt fluff and ask: What's the one decision we need today?' Test for consistency."
        },
        3: {
          why: "Cult brands align what employees believe internally with what consumers experience externally. Patagonia employees are activists; customers buy purpose with product. This alignment creates belonging and loyalty on both sides.",
          what: "Define your employee brand (who we are, our values, our story) and consumer brand (who we are for them, their experience, shared values). The bridge is shared values that connect both groups.",
          how: "Ask employees: Why do you work here? What do you value? Ask customers: How do you describe us? What do you consistently experience? Find the overlap—these shared values are your cult brand foundation."
        },
        4: {
          why: "Marketing without strategy is noise. Gymshark scaled to £400M by aligning every marketing action to their cult identity. Your messaging must speak directly to your target segment's deepest pain through consistent pillars.",
          what: "Identify target segment's core pain. Create 3-5 messaging pillars (themes you consistently communicate). Define content strategy: what you create, how often, which channels, what formats.",
          how: "Start with pain: What keeps them up at night? Build pillars that address this pain from different angles. For each pillar, define rationale and channels. Create content calendar that reinforces pillars consistently."
        },
        5: {
          why: "Brand strategy is worthless without execution. 87% of marketers produce content they're not proud of because there's no implementation plan. Clear actions, owners, and metrics turn strategy into results.",
          what: "Define first 3 high-impact marketing actions with owners, deadlines, and expected impact. Set success metrics for brand and marketing. Create consistency checklist to ensure alignment across all touchpoints.",
          how: "Prioritize actions with highest impact: What will move the needle fastest? Assign clear owners and realistic deadlines (30-60 days). Define metrics you'll actually track. Build checklist: Before publishing, does this sound like us?"
        }
      };

      const content = helpContent[step];

      return (
        <div
          className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-8"
          onClick={onClose}
        >
          <div
            className="bg-white text-black max-w-3xl w-full border-8 border-black p-12 relative"
            onClick={(e) => e.stopPropagation()}
          >
            <button
              onClick={onClose}
              className="absolute top-4 right-4 text-4xl hover:text-gray-600"
            >
              ×
            </button>

            <h2 className="plaak mb-8 text-black" style={{fontSize: '80px'}}>
              INSTRUCTIONS
            </h2>

            <div className="space-y-8 text-lg">
              <div>
                <h3 className="riforma-bold mb-3" style={{fontSize: '40px'}}>Why This Matters</h3>
                <p>{content.why}</p>
              </div>

              <div>
                <h3 className="riforma-bold mb-3" style={{fontSize: '40px'}}>What You&apos;re Doing</h3>
                <p>{content.what}</p>
              </div>

              <div>
                <h3 className="riforma-bold mb-3" style={{fontSize: '40px'}}>How To Do It</h3>
                <p>{content.how}</p>
              </div>
            </div>

            <button
              onClick={onClose}
              className="btn-primary w-full mt-8 text-2xl py-4"
            >
              GOT IT
            </button>
          </div>
        </div>
      );
    }

    // Step 1: Brand Promise
    function Step1Page({ data, updateData, onNext, onBack, canProceed, aiReviewing, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={1} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={1} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">01. BRAND PROMISE</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Principle for Brand and Marketing: This foundational step drives 80% of results. Leaders who invest proper time here see the biggest transformation in their organization.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Research from organizational psychology shows that structured brand and marketing frameworks improve decision quality by 25-40% compared to unstructured approaches (Harvard Business Review, 2023). Writing responses down activates deeper cognitive processing than thinking alone.
            </ScienceBox>

            {/* Common Mistake */}
            <WarningBox>
                [PLACEHOLDER] Common mistake in Brand and Marketing: Leaders often rush through this with surface-level answers. <strong>Bad:</strong> Generic responses completed in under 5 minutes. <strong>Good:</strong> Specific, honest answers that require real thought and sometimes discomfort.
            </WarningBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Craft your crystal-clear, emotionally charged brand promise
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Airbnb shifted from &apos;room rentals&apos; to &apos;belong anywhere&apos; — a killer brand promise that tripled market share in 3 years.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your brand promise transforms your value proposition into a human experience. It&apos;s the feeling people get when they think of you. Make it specific, emotional, and impossible for competitors to copy.
            </p>

            <div className="space-y-6 mb-12">
              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.15s'}}>
                <label className="monument text-sm block mb-2">BRAND PROMISE <span className="text-red-500">*</span></label>
                <ScienceBookmarkIcon>
                    [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of brand and marketing leads to significantly better outcomes than intuitive approaches alone.
                </ScienceBookmarkIcon>
                <p className="text-sm text-gray-600 mb-2">One clear sentence. What transformation do you promise?</p>
                <textarea
                  value={data.brandPromise}
                  onChange={(e) => updateData('brandPromise', e.target.value)}
                  placeholder="We help ambitious CEOs gain 10 hours per week by eliminating the fog between strategy and execution—so they can focus on what actually grows their business."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.brandPromise.length}/500 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.2s'}}>
                <label className="monument text-sm block mb-2">EMOTIONAL CONNECTION <span className="text-red-500">*</span></label>
                <ScienceBookmarkIcon>
                    [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of brand and marketing leads to significantly better outcomes than intuitive approaches alone.
                </ScienceBookmarkIcon>
                <p className="text-sm text-gray-600 mb-2">What feeling do you create? What emotion drives loyalty?</p>
                <textarea
                  value={data.emotionalConnection}
                  onChange={(e) => updateData('emotionalConnection', e.target.value)}
                  placeholder="Confidence. Relief. Control. Our clients feel like they&apos;ve finally found someone who gets it—no fluff, no theory, just results."
                  className="w-full"
                  rows={3}
                />
                <div className="char-counter">{data.emotionalConnection.length}/500 (min 30)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.25s'}}>
                <label className="monument text-sm block mb-2">VALUE PROPOSITION TRANSFORMATION <span className="text-red-500">*</span></label>
                <ScienceBookmarkIcon>
                    [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of brand and marketing leads to significantly better outcomes than intuitive approaches alone.
                </ScienceBookmarkIcon>
                <p className="text-sm text-gray-600 mb-2">How does your brand promise elevate your value prop into human terms?</p>
                <textarea
                  value={data.valuePropositionTransform}
                  onChange={(e) => updateData('valuePropositionTransform', e.target.value)}
                  placeholder="Value Prop: &quot;Strategy execution consulting&quot; → Brand Promise: &quot;Get your weekends back while growing faster&quot;. We turned a service into a lifestyle upgrade."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.valuePropositionTransform.length}/1000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">BRAND ENEMY (What you&apos;re NOT) <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Define the anti-brand. What do you stand against?</p>
                <textarea
                  value={data.brandEnemy}
                  onChange={(e) => updateData('brandEnemy', e.target.value)}
                  placeholder="We&apos;re not consultants who write reports and disappear. We&apos;re not gurus selling inspiration. We&apos;re the anti-theory, anti-complexity, anti-waste brigade."
                  className="w-full"
                  rows={3}
                />
                <div className="char-counter">{data.brandEnemy.length}/500 (min 30)</div>
              </div>
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                {aiReviewing ? 'AI Coach Reviewing...' : 'NEXT: PERSONALITY →'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 2: Brand Personality
    function Step2Page({ data, updateData, updateTrait, addTrait, removeTrait, onNext, onBack, canProceed, aiReviewing, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={2} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={2} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">02. BRAND PERSONALITY</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Insight: The second phase of Brand and Marketing is where most leaders see breakthroughs. Be specific and brutally honest in your answers here.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Behavioral science research indicates that teams using systematic brand and marketing processes make decisions 2.5x faster with 30% fewer errors (McKinsey, 2022). The structure reduces cognitive bias and forces comprehensive thinking.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Define who you are in the customer&apos;s story
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Red Bull acts like a rebel, talks like an adrenaline junkie, and owns &apos;energy&apos;. Ruthlessly simple, instantly memorable, radically them.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your brand personality is how you show up in every interaction. Define 3-5 core traits that make you unmistakably YOU. Be specific. Be polarizing. Be consistent.
            </p>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Personality Traits</h4>
                {data.personalityTraits.map((trait, index) => (
                  <div key={trait.id} className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                    <div className="flex justify-between items-start mb-4">
                      <h5 className="riforma-bold text-2xl">Trait {index + 1}</h5>
                      {data.personalityTraits.length > 1 && (
                        <button
                          onClick={() => removeTrait(trait.id)}
                          className="text-red-600 hover:text-red-800 text-sm"
                        >
                          REMOVE
                        </button>
                      )}
                    </div>

                    <div className="space-y-4">
                      <div>
                        <label className="monument text-sm block mb-2">TRAIT NAME <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={trait.trait}
                          onChange={(e) => updateTrait(trait.id, 'trait', e.target.value)}
                          placeholder="Direct / Rebellious / Precise / Bold / Caring"
                          className="w-full"
                        />
                        <div className="char-counter">{trait.trait.length}/100 (min 5)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">DESCRIPTION <span className="text-red-500">*</span></label>
                        <textarea
                          value={trait.description}
                          onChange={(e) => updateTrait(trait.id, 'description', e.target.value)}
                          placeholder="We don&apos;t sugarcoat. We tell CEOs what they need to hear, not what they want to hear. We challenge assumptions and cut through bullshit."
                          className="w-full"
                          rows={3}
                        />
                        <div className="char-counter">{trait.description.length}/500 (min 20)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">EXAMPLE IN ACTION <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={trait.example}
                          onChange={(e) => updateTrait(trait.id, 'example', e.target.value)}
                          placeholder="In meetings, we interrupt fluff and ask: What&apos;s the one decision we need to make today?"
                          className="w-full"
                        />
                        <div className="char-counter">{trait.example.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addTrait} className="btn-secondary text-sm w-full">+ ADD TRAIT</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">BRAND VOICE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How do you sound? What&apos;s your tone across all communications?</p>
                <textarea
                  value={data.brandVoice}
                  onChange={(e) => updateData('brandVoice', e.target.value)}
                  placeholder="Sharp. No-nonsense. Confident but not arrogant. We write like we talk: short sentences, active voice, zero jargon. We use metaphors from sports and military strategy."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.brandVoice.length}/1000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.35s'}}>
                <label className="monument text-sm block mb-2">BRAND ARCHETYPE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What role do you play? The Sage? The Hero? The Rebel?</p>
                <input
                  type="text"
                  value={data.brandArchetype}
                  onChange={(e) => updateData('brandArchetype', e.target.value)}
                  placeholder="The Sage + The Warrior: We bring wisdom with urgency, knowledge with action"
                  className="w-full"
                />
                <div className="char-counter">{data.brandArchetype.length}/300 (min 20)</div>
              </div>
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                {aiReviewing ? 'AI Coach Reviewing...' : 'NEXT: CULT BRAND →'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 3: Cult Brand Model
    function Step3Page({ data, updateData, onNext, onBack, canProceed, aiReviewing, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={3} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={3} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">03. CULT BRAND MODEL</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Advanced: This Brand and Marketing step connects your work to the broader strategy. Look for patterns across your previous answers.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Meta-analysis of 200+ organizations shows that completing structured exercises like this correlates with 35% higher strategic execution rates (Deloitte, 2023). Written commitments create psychological accountability.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Build employee and consumer brand alignment
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Patagonia: Employee brand = Activists. Consumer brand = Purpose with product. Result? Cult following. 64% of consumers stay loyal when they share values with a brand.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your cult brand connects what employees believe (internal) with what consumers experience (external). When these align, you create belonging, not just transactions.
            </p>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Employee Brand (Internal)</h4>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.15s'}}>
                  <label className="monument text-sm block mb-2">WHO WE ARE (Employee Identity) <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What do employees say about why they work here?</p>
                  <textarea
                    value={data.employeeBrand}
                    onChange={(e) => updateData('employeeBrand', e.target.value)}
                    placeholder="We&apos;re execution obsessives who can&apos;t stand waste. We work here because we get to cut through corporate BS and see real companies transform in 90 days."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.employeeBrand.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.2s'}}>
                  <label className="monument text-sm block mb-2">CORE VALUES (Employee Beliefs) <span className="text-red-500">*</span></label>
                  <textarea
                    value={data.employeeValues}
                    onChange={(e) => updateData('employeeValues', e.target.value)}
                    placeholder="Brutal honesty over politeness. Speed over perfection. Results over reports. We value clarity, ownership, and getting shit done."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.employeeValues.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.25s'}}>
                  <label className="monument text-sm block mb-2">EMPLOYEE STORY <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What story do employees tell about this company?</p>
                  <textarea
                    value={data.employeeStory}
                    onChange={(e) => updateData('employeeStory', e.target.value)}
                    placeholder="People join us burned out from big consulting firms where they wrote decks no one read. Here, they see their work implemented within weeks. They tell friends: Finally, a place that values impact."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.employeeStory.length}/1000 (min 50)</div>
                </div>
              </div>

              <div>
                <h4 className="riforma-bold text-3xl mb-4">Consumer Brand (External)</h4>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.3s'}}>
                  <label className="monument text-sm block mb-2">WHO WE ARE FOR THEM <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">How do customers describe you to others?</p>
                  <textarea
                    value={data.consumerBrand}
                    onChange={(e) => updateData('consumerBrand', e.target.value)}
                    placeholder="Clients call us &apos;the anti-consultants&apos; or &apos;the execution enforcers&apos;. They say we&apos;re the team that finally made strategy real instead of another binder on the shelf."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.consumerBrand.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.35s'}}>
                  <label className="monument text-sm block mb-2">CONSUMER EXPERIENCE <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What do customers consistently experience?</p>
                  <textarea
                    value={data.consumerExperience}
                    onChange={(e) => updateData('consumerExperience', e.target.value)}
                    placeholder="First meeting: we challenge their thinking. First sprint: they see results. After 90 days: they can&apos;t imagine going back to the old way. Every touchpoint is fast, focused, and actionable."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.consumerExperience.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.4s'}}>
                  <label className="monument text-sm block mb-2">SHARED VALUES (The Bridge) <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What values connect employees and customers?</p>
                  <textarea
                    value={data.sharedValues}
                    onChange={(e) => updateData('sharedValues', e.target.value)}
                    placeholder="Both employees and customers value: (1) No BS honesty, (2) Speed over bureaucracy, (3) Results that matter. This alignment creates loyalty on both sides—employees stay, customers refer."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.sharedValues.length}/1000 (min 50)</div>
                </div>
              </div>
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                {aiReviewing ? 'AI Coach Reviewing...' : 'NEXT: MARKETING STRATEGY →'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 4: Marketing Strategy
    function Step4Page({ data, updateData, updatePillar, addPillar, removePillar, onNext, onBack, canProceed, aiReviewing, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={4} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={4} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">04. MARKETING STRATEGY</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Integration: At this stage of Brand and Marketing, synthesis matters most. Your outputs should connect to at least 2 other Fast Track tools.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Longitudinal studies demonstrate that organizations revisiting their brand and marketing outputs quarterly maintain 60% higher alignment scores (BCG, 2023). Regular review prevents strategic drift.
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Create marketing that converts through strategic messaging
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Gymshark scaled from £0 to £400M by aligning every marketing action to its cult identity: grit + self-made. Marketing is strategy in motion.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your marketing translates brand into action. Define 3-5 messaging pillars that speak directly to your target segment&apos;s deepest pain. Align tone, channels, and cadence with your brand personality.
            </p>

            <div className="space-y-8 mb-12">
              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.15s'}}>
                <label className="monument text-sm block mb-2">TARGET SEGMENT&apos;S DEEPEST PAIN <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What keeps them up at night? What frustration drives all decisions?</p>
                <textarea
                  value={data.targetSegmentPain}
                  onChange={(e) => updateData('targetSegmentPain', e.target.value)}
                  placeholder="Mid-market CEOs feel trapped: drowning in strategy decks but starving for execution. They&apos;ve paid consultants $100K+ for plans gathering dust. They need results yesterday, not theories tomorrow."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.targetSegmentPain.length}/1000 (min 50)</div>
              </div>

              <div>
                <h4 className="riforma-bold text-3xl mb-4">Messaging Pillars (3-5 core themes)</h4>
                {data.messagingPillars.map((pillar, index) => (
                  <div key={pillar.id} className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: `${0.2 + index * 0.05}s`}}>
                    <div className="flex justify-between items-start mb-4">
                      <h5 className="riforma-bold text-2xl">Pillar {index + 1}</h5>
                      {data.messagingPillars.length > 1 && (
                        <button
                          onClick={() => removePillar(pillar.id)}
                          className="text-red-600 hover:text-red-800 text-sm"
                        >
                          REMOVE
                        </button>
                      )}
                    </div>

                    <div className="space-y-4">
                      <div>
                        <label className="monument text-sm block mb-2">PILLAR THEME <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={pillar.pillar}
                          onChange={(e) => updatePillar(pillar.id, 'pillar', e.target.value)}
                          placeholder="Speed Over Perfection / Results Not Reports / Execution Beats Theory"
                          className="w-full"
                        />
                        <div className="char-counter">{pillar.pillar.length}/200 (min 10)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">RATIONALE <span className="text-red-500">*</span></label>
                        <textarea
                          value={pillar.rationale}
                          onChange={(e) => updatePillar(pillar.id, 'rationale', e.target.value)}
                          placeholder="Our clients are fed up with endless planning cycles. This pillar positions us as the antidote: we get them moving in weeks, not months. It speaks directly to their frustration with analysis paralysis."
                          className="w-full"
                          rows={3}
                        />
                        <div className="char-counter">{pillar.rationale.length}/500 (min 30)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">CHANNELS & TACTICS <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={pillar.channels}
                          onChange={(e) => updatePillar(pillar.id, 'channels', e.target.value)}
                          placeholder="LinkedIn thought leadership, case study emails, CEO roundtables"
                          className="w-full"
                        />
                        <div className="char-counter">{pillar.channels.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addPillar} className="btn-secondary text-sm w-full">+ ADD PILLAR</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.4s'}}>
                <label className="monument text-sm block mb-2">CONTENT STRATEGY & CADENCE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What content do you create? How often? What formats?</p>
                <textarea
                  value={data.contentStrategy}
                  onChange={(e) => updateData('contentStrategy', e.target.value)}
                  placeholder="Weekly LinkedIn posts (CEO voice, polarizing takes on strategy waste). Bi-weekly case studies (3-minute read, hard numbers). Monthly CEO roundtable (invite-only, 90 minutes, pure value). Quarterly brand book update (what we learned helping 50+ companies execute)."
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.contentStrategy.length}/2000 (min 100)</div>
              </div>
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                {aiReviewing ? 'AI Coach Reviewing...' : 'NEXT: IMPLEMENTATION →'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Step 5: Implementation
    function Step5Page({ data, updateData, updateAction, addAction, removeAction, onNext, onBack, canProceed, aiReviewing, setShowHelp }) {
      const [showHelpModal, setShowHelpModal] = useState(false);

      return (
        <div className="bg-white min-h-screen p-16 pb-32">
          {showHelpModal && <HelpModal step={5} onClose={() => setShowHelpModal(false)} />}
          <div className="max-w-5xl mx-auto">
            <ProgressIndicator currentStep={5} />
            <HelpButton onClick={() => setShowHelpModal(true)} />

            <div className="numbered-section mb-8 animate-in">05. IMPLEMENTATION PLAN</div>

            {/* Fast Track Insight */}
            <FastTrackInsight>
                [PLACEHOLDER] Fast Track Completion: The final step ties everything together. Review your Brand and Marketing work holistically before moving on.
            </FastTrackInsight>

            {/* The Science */}
            <ScienceBox collapsible={true}>
                [PLACEHOLDER] Cross-industry research confirms that structured frameworks reduce implementation time by 40% while improving quality of outcomes across all organizational levels (Bain, 2023).
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              First 3 high-impact marketing actions to put brand in motion
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Branding is strategy made visible. Marketing is strategy in motion. Both must serve your target segment&apos;s deepest pain.&quot;
              </p>
            </div>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Marketing Actions</h4>
                {data.marketingActions.map((action, index) => (
                  <div key={action.id} className="bg-gray-50 border-2 border-gray-200 p-4 mb-4 animate-in" style={{animationDelay: `${0.15 + index * 0.03}s`}}>
                    <div className="flex justify-between items-center mb-3">
                      <span className="monument text-xs">ACTION {index + 1}</span>
                      {data.marketingActions.length > 1 && (
                        <button onClick={() => removeAction(action.id)} className="text-red-600 text-sm">REMOVE</button>
                      )}
                    </div>
                    <div className="space-y-3">
                      <div>
                        <label className="monument text-xs block mb-1">ACTION DESCRIPTION <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={action.action}
                          onChange={(e) => updateAction(action.id, 'action', e.target.value)}
                          placeholder="Launch LinkedIn thought leadership series: 10 posts on strategy execution myths"
                          className="w-full"
                        />
                        <div className="char-counter text-xs">{action.action.length}/300 (min 20)</div>
                      </div>
                      <div className="grid grid-cols-2 gap-3">
                        <div>
                          <label className="monument text-xs block mb-1">OWNER <span className="text-red-500">*</span></label>
                          <input
                            type="text"
                            value={action.owner}
                            onChange={(e) => updateAction(action.id, 'owner', e.target.value)}
                            placeholder="Sarah Chen (Marketing)"
                            className="w-full"
                          />
                          <div className="char-counter text-xs">{action.owner.length}/100 (min 5)</div>
                        </div>
                        <div>
                          <label className="monument text-xs block mb-1">DEADLINE <span className="text-red-500">*</span></label>
                          <input
                            type="text"
                            value={action.deadline}
                            onChange={(e) => updateAction(action.id, 'deadline', e.target.value)}
                            placeholder="March 30, 2025"
                            className="w-full"
                          />
                          <div className="char-counter text-xs">{action.deadline.length}/100 (min 5)</div>
                        </div>
                      </div>
                      <div>
                        <label className="monument text-xs block mb-1">EXPECTED IMPACT <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={action.expectedImpact}
                          onChange={(e) => updateAction(action.id, 'expectedImpact', e.target.value)}
                          placeholder="30 qualified inbound leads, 5 CEO roundtable signups, 10K profile views"
                          className="w-full"
                        />
                        <div className="char-counter text-xs">{action.expectedImpact.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addAction} className="btn-secondary text-sm w-full">+ ADD ACTION</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">SUCCESS METRICS <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How will you measure brand and marketing impact?</p>
                <textarea
                  value={data.successMetrics}
                  onChange={(e) => updateData('successMetrics', e.target.value)}
                  placeholder="Brand: (1) 80% of prospects mention specific brand traits in discovery calls (2) Employee NPS >40 (3) 50% of new clients from referrals&#10;Marketing: (1) 100 qualified leads/quarter (2) 15% conversion to meetings (3) 10 pieces of UGC monthly"
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.successMetrics.length}/2000 (min 100)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.35s'}}>
                <label className="monument text-sm block mb-2">CONSISTENCY CHECKLIST <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How will you ensure brand consistency across all touchpoints?</p>
                <textarea
                  value={data.consistencyChecklist}
                  onChange={(e) => updateData('consistencyChecklist', e.target.value)}
                  placeholder="Before publishing anything: (1) Does this sound like us? (2) Would competitors say this? If yes, kill it. (3) Does it serve our target&apos;s pain? (4) Is employee brand aligned with consumer message?"
                  className="w-full"
                  rows={5}
                />
                <div className="char-counter">{data.consistencyChecklist.length}/1000 (min 50)</div>
              </div>
            </div>

            {/* Navigation */}
            <div className="flex gap-6">
              <button onClick={onBack} className="btn-secondary flex-1">
                ← BACK
              </button>
              <button
                onClick={onNext}
                disabled={!canProceed}
                className="btn-primary flex-1"
              >
                {aiReviewing ? 'AI Coach Reviewing...' : 'VIEW BRAND STRATEGY →'}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Canvas Page
    function CanvasPage({ data, onExport, onSubmit }) {
      return (
        <div className="bg-gray-100 min-h-screen p-16">
          <div className="max-w-6xl mx-auto">
            {/* Canvas Content */}
            <div id="canvas-content" className="bg-white p-16 mb-8">
              <div className="border-b-4 border-black pb-8 mb-8">
                <h1 className="plaak text-7xl mb-2">BRAND & MARKETING STRATEGY</h1>
                <p className="text-2xl text-gray-600">Sprint 19 - Strategy Made Visible</p>
              </div>

              {/* Brand Promise */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Brand Promise</h2>
                <div className="bg-gray-50 p-6 border-l-4 border-black">
                  <p className="text-xl">{data.brandPromise}</p>
                  <p className="text-lg text-gray-600 mt-4"><strong>Emotion:</strong> {data.emotionalConnection}</p>
                </div>
              </div>

              {/* Brand Personality */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Brand Personality</h2>
                <div className="grid grid-cols-3 gap-4">
                  {data.personalityTraits.slice(0, 3).map((trait, i) => (
                    <div key={i} className="bg-gray-50 p-4 border-2 border-black">
                      <p className="riforma-bold text-xl mb-2">{trait.trait}</p>
                      <p className="text-sm">{trait.description.substring(0, 100)}...</p>
                    </div>
                  ))}
                </div>
                <div className="bg-yellow-50 p-4 border-l-4 border-yellow-400 mt-4">
                  <p className="text-lg"><strong>Voice:</strong> {data.brandVoice.substring(0, 150)}...</p>
                </div>
              </div>

              {/* Cult Brand Model */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Cult Brand Model</h2>
                <div className="grid grid-cols-2 gap-6">
                  <div className="bg-gray-50 p-6 border-l-4 border-black">
                    <p className="riforma-bold text-2xl mb-3">Employee Brand</p>
                    <p className="text-base">{data.employeeBrand.substring(0, 120)}...</p>
                  </div>
                  <div className="bg-gray-50 p-6 border-l-4 border-black">
                    <p className="riforma-bold text-2xl mb-3">Consumer Brand</p>
                    <p className="text-base">{data.consumerBrand.substring(0, 120)}...</p>
                  </div>
                </div>
                <div className="bg-yellow-50 p-4 border-4 border-yellow-400 mt-4">
                  <p className="text-lg"><strong>Shared Values:</strong> {data.sharedValues.substring(0, 150)}...</p>
                </div>
              </div>

              {/* Messaging Pillars */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Messaging Pillars</h2>
                <div className="space-y-3">
                  {data.messagingPillars.slice(0, 4).map((pillar, i) => (
                    <div key={i} className="bg-gray-50 p-4 border-l-4 border-black">
                      <p className="riforma-bold text-lg">{i + 1}. {pillar.pillar}</p>
                      <p className="text-sm text-gray-600">{pillar.channels}</p>
                    </div>
                  ))}
                </div>
              </div>

              {/* Marketing Actions */}
              <div>
                <h2 className="riforma-bold text-4xl mb-4">Next Actions</h2>
                <div className="space-y-2">
                  {data.marketingActions.slice(0, 5).map((action, i) => (
                    <div key={i} className="flex items-start text-base">
                      <span className="riforma-bold mr-3">{i + 1}.</span>
                      <div>
                        <p className="riforma-bold">{action.action}</p>
                        <p className="text-sm text-gray-600">{action.owner} - {action.deadline}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="mt-12 pt-8 border-t-2 border-gray-200 text-center text-sm text-gray-500">
                <p>Generated: {new Date().toLocaleDateString()}</p>
                <p className="mt-1">Fast Track Sprint 19 - Brand and Marketing</p>
              </div>
            </div>

            {/* Action Buttons */}
            <div className="flex gap-6 mb-6">
              <button onClick={onExport} className="btn-primary flex-1">
                EXPORT PDF
              </button>
              <button onClick={onSubmit} className="btn-primary flex-1">
                SUBMIT
              </button>
            </div>

            {/* Case Study */}
            <CaseStudy
                before={"[PLACEHOLDER] Big marketing spend, no clear message."}
                after={"[PLACEHOLDER] Brand aligned to VP. Lead quality improved 3x."}
                quote={"[PLACEHOLDER] When the brand matched reality, customers started coming to us."}
            />
          </div>
        </div>
      );
    }

    // Progress Indicator
    function ProgressIndicator({ currentStep }) {
      const steps = [
        { number: 1, label: 'Promise' },
        { number: 2, label: 'Personality' },
        { number: 3, label: 'Cult Model' },
        { number: 4, label: 'Strategy' },
        { number: 5, label: 'Implement' }
      ];

      return (
        <div className="flex items-center justify-center gap-4 mb-12">
          {steps.map((step, index) => (
            <Fragment key={step.number}>
              <div className="flex flex-col items-center">
                <div className={`progress-dot ${step.number === currentStep ? 'active' : ''} ${step.number < currentStep ? 'completed' : ''}`}></div>
                <div className="monument text-xs mt-2">{step.label}</div>
              </div>
              {index < steps.length - 1 && <div className="progress-line w-12"></div>}
            </Fragment>
          ))}
        </div>
      );
    }

    // Help Button
    function HelpButton({ onClick }) {
      return (
        <button onClick={onClick} className="help-button">
          ?
        </button>
      );
    }

    // Render App
        ReactDOM.render(<BrandApp />, document.getElementById('root'));
  </script>
</body>
</html>