<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Brand and Marketing | Fast Track Program</title>

  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../../shared/js/tool-db.js"></script>
  <script src="../../shared/js/ai-challenge.js"></script>
  <script src="../../shared/js/dependency-injection.js"></script>
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>
    <script src="../../js/tool-access-control.js"></script>

  <!-- jsPDF + html2canvas for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Transition Screen -->
  <script src="../../shared/js/transition-screen.js"></script>

  <style>
    /* Font Face Declarations */
    @font-face {
      font-family: 'Plaak';
      src: url('Plaak3Trial-43-Bold.woff2') format('woff2');
      font-weight: bold;
      font-style: normal;
    }

    @font-face {
      font-family: 'Riforma';
      src: url('RiformaLL-Regular.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Monument';
      src: url('MonumentGrotesk-Mono.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Riforma', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .plaak {
      font-family: 'Plaak', sans-serif;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: -0.02em;
    }

    .riforma-bold {
      font-family: 'Riforma', sans-serif;
      font-weight: bold;
    }

    .monument {
      font-family: 'Monument', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-in {
      animation: slideIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .fade-in {
      animation: fadeIn 0.4s ease-out;
    }

    .transition-animate-in {
      animation: slideIn 0.6s ease-out;
    }

    /* Button Styles */
    .btn-primary {
      background: #000000;
      color: #FFFFFF;
      padding: 16px 32px;
      border: 2px solid #000000;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: normal;
    }

    .btn-primary:hover:not(:disabled) {
      transform: scale(1.02);
    }

    .btn-primary:disabled {
      background: #E0E0E0;
      border-color: #E0E0E0;
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: #FFFFFF;
      color: #000000;
      padding: 12px 24px;
      border: 2px solid #000000;
      font-size: 16px;
      font-family: 'Riforma', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-secondary:hover {
      background: #F8F8F8;
    }

    /* Form Styles */
    input[type="text"],
    input[type="number"],
    input[type="email"],
    textarea,
    select {
      border: 1px solid #E0E0E0;
      padding: 12px 16px;
      font-size: 18px;
      font-family: 'Riforma', sans-serif;
      width: 100%;
      transition: border-color 0.2s ease;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #000000;
    }

    textarea {
      min-height: 120px;
      resize: none !important;
    }

    textarea::placeholder {
      white-space: pre-line;
    }

    /* Numbered Section Badge */
    .numbered-section {
      background: #000000;
      color: #FFFFFF;
      padding: 10px 16px;
      font-family: 'Plaak', sans-serif;
      font-size: 26px;
      display: inline-block;
      text-transform: uppercase;
      letter-spacing: -0.02em;
    }

    /* Help Button */
    .help-button {
      position: fixed;
      top: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: #000000;
      color: #FFFFFF;
      font-size: 28px;
      border: none;
      cursor: pointer;
      z-index: 40;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Riforma', sans-serif;
    }

    .help-button:hover {
      background: #FFF469;
      color: #000000;
      transform: scale(1.1);
    }

    /* Progress Indicator */
    .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #E0E0E0;
      transition: all 0.3s ease;
    }

    .progress-dot.active {
      background: #000000;
      transform: scale(1.3);
    }

    .progress-dot.completed {
      background: #000000;
    }

    .progress-line {
      height: 2px;
      background: #E0E0E0;
      flex: 1;
    }

    /* Character Counter */
    .char-counter {
      font-size: 14px;
      color: #666;
      margin-top: 4px;
    }

    .char-counter.invalid {
      color: #EF4444;
    }

    /* Wizard Layout */
    .wizard-layout {
      display: flex;
      min-height: 100vh;
    }
    .wizard-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }
    .wizard-content {
      flex: 1;
      padding: 48px 64px;
      max-width: 860px;
    }
    .wizard-sidebar {
      width: 280px;
      background: #1a1a1a;
      color: #fff;
      padding: 40px 32px;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
    }
    .wizard-footer {
      padding: 24px 64px;
      border-top: 1px solid #E0E0E0;
      display: flex;
      gap: 16px;
      background: #fff;
    }
    .btn-wiz-back {
      background: #fff;
      color: #000;
      padding: 14px 24px;
      border: 2px solid #000;
      font-family: 'Riforma', sans-serif;
      font-size: 14px;
      cursor: pointer;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .btn-wiz-next {
      flex: 1;
      background: #000;
      color: #fff;
      padding: 14px 24px;
      border: 2px solid #000;
      font-family: 'Riforma', sans-serif;
      font-size: 14px;
      cursor: pointer;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .btn-wiz-next:disabled {
      background: #E0E0E0;
      border-color: #E0E0E0;
      cursor: not-allowed;
      color: #999;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, Fragment } = React;

    // Configuration
    const CONFIG = {
      SUPABASE_URL: 'https://lutzzfaedkbsmbobmrzx.supabase.co',
      SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1dHp6ZmFlZGtic21ib2Jtcnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MDA0MDQsImV4cCI6MjA4NjM3NjQwNH0.o2gJba85vDl4NLS-C8Mq3OudWKxet-b0IqO9kazqb8U',
      TOOL_SLUG: 'brand-marketing',
      AUTOSAVE_DELAY: 2000,
      TRANSITION_CONTENT: {
        1: {
          brutalTruth: 'Most marketing fails not because of poor execution — but because there is no clear brand identity worth communicating. If your team cannot describe what you stand for in 10 words, your customers cannot either.',
          peerProof: '"A €8M B2B firm invested 3 months defining their brand positioning. Lead quality improved measurably. Sales cycle shortened 30%. Their best new clients said the messaging resonated immediately — before a single meeting."'
        },
        2: {
          brutalTruth: 'Brand consistency is not a design preference — it is a trust signal. Inconsistent visual identity tells customers you are uncertain about who you are. Certainty in brand signals certainty in delivery.',
          peerProof: '"A regional services brand standardized their visual identity across 6 channels in one month. Three months later, unaided brand recall among their ICP doubled. No new ad spend. Just consistency."'
        },
        3: {
          brutalTruth: 'Content without distribution is a tree falling in an empty forest. The best brand strategy in the world is invisible if your customers are not in the channels where you are publishing.',
          peerProof: '"A B2B SaaS company shifted from posting across 4 social channels to focusing entirely on LinkedIn for 6 months. Engagement per post increased 8x. Inbound demo requests from content doubled. Less volume. More focus. Better results."'
        },
        4: {
          brutalTruth: 'Strategy without execution is fiction. Most brands have excellent mission statements and zero consistent follow-through. A marketing plan that sits in a document is worth exactly nothing.',
          peerProof: '"A B2B tech firm wrote a 30-page marketing strategy. Six months later, nothing had shipped. They stripped it to 3 actions with named owners and 30-day deadlines. Within 90 days they had doubled their qualified pipeline."'
        },
        5: {
          brutalTruth: 'Measurement without action is theatre. Tracking metrics you never act on is a sophisticated way of avoiding accountability. Define the number. Own the number. Move the number.',
          peerProof: '"A professional services firm tracked 22 marketing KPIs weekly. Nothing improved. They cut to 3 metrics, assigned a single owner to each, and reviewed monthly. Brand awareness doubled in 6 months."'
        }
      },
      CLOSING_MESSAGES: {
        1: { title: 'BRAND DEFINED', text: 'Your brand foundation is set. Next: translate it into a consistent visual and messaging system.' },
        2: { title: 'IDENTITY LOCKED', text: 'Your brand identity is complete. Next: build the content and channel strategy to bring it to life.' },
        3: { title: 'STRATEGY COMPLETE', text: 'Your brand and marketing strategy is built. Now execute it with ruthless consistency.' },
        4: { title: 'STRATEGY LOCKED', text: 'Your marketing strategy is complete. Now build the implementation plan that brings it to life.' },
        5: { title: 'PLAN COMPLETE', text: 'Your brand and marketing strategy is built. Review your canvas and submit.' }
      }
    };

    const { createClient } = supabase;
    const supabaseClient = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);

    // Make Supabase client globally available for dependency injection
    window.supabaseClient = supabaseClient;

    // Initialize ToolDB and dependency injection
    ToolDB.init(CONFIG.TOOL_SLUG);
        ToolAccessControl.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        CognitiveLoad.init('brand-marketing', {"insights":["Brand is not your logo. It is the promise you make and consistently keep.","Marketing without strategy is just noise."],"caseStudy":{"before":"A mid-market B2B services firm spent 15% of revenue on marketing across six channels with no unified brand message. Sales decks contradicted the website, social media felt generic, and lead quality was declining quarter over quarter despite increased ad spend.","after":"After defining a sharp brand promise rooted in their value proposition and aligning employee and consumer brand messaging, they cut marketing spend by 40% while tripling qualified inbound leads within two quarters. Every touchpoint now told the same story.","quote":"We stopped trying to be everything to everyone. Once the brand matched the reality of what we actually delivered, customers started coming to us instead of us chasing them. Our close rate went from 12% to 34%."}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

        function DependencyContext({ deps }) {
            const [open, setOpen] = React.useState(false);
            if (!deps || deps.length === 0) return null;
            return (
                <div style={{ marginBottom: '16px' }}>
                    <button onClick={() => setOpen(o => !o)} style={{ display: 'flex', alignItems: 'center', gap: 8, background: '#FFF9E0', border: '1px solid #F0E68C', borderLeft: '3px solid #DAA520', padding: '8px 14px', fontSize: 12, fontFamily: "'Monument', monospace", letterSpacing: '0.05em', textTransform: 'uppercase', cursor: 'pointer', color: '#555', width: '100%' }}>
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#DAA520" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                        CONTEXT FROM PREVIOUS TOOLS ({deps.length})
                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="#999" strokeWidth="2" style={{ marginLeft: 'auto', transform: open ? 'rotate(180deg)' : 'none', transition: 'transform 0.2s' }}><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    {open && (
                        <div style={{ border: '1px solid #F0E68C', borderTop: 'none', padding: '12px 14px' }}>
                            {deps.map((dep, i) => (
                                <div key={i} style={{ background: '#fff', padding: '8px 0', borderBottom: i < deps.length - 1 ? '1px solid #F0E68C' : 'none', fontSize: '13px' }}>
                                    <div style={{ fontWeight: 600, marginBottom: '2px', color: '#333', fontSize: '11px', fontFamily: "'Monument', monospace", letterSpacing: '0.04em', textTransform: 'uppercase' }}>{dep.label}</div>
                                    <div style={{ color: '#555', whiteSpace: 'pre-wrap' }}>{dep.value}</div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        }

    // Main App Component
    function BrandApp() {
            const [deps, setDeps] = useState([]);
      const [step, setStep] = useState(0);
      const [aiReviewing, setAiReviewing] = useState(false);
      const [submitStatus, setSubmitStatus] = useState(null);
      const [submitMessage, setSubmitMessage] = useState('');

      const [data, setData] = useState({
        // Step 1: Brand Promise
        brandPromise: '',
        emotionalConnection: '',
        valuePropositionTransform: '',
        brandEnemy: '',

        // Step 2: Brand Personality
        personalityTraits: [
          { id: 1, trait: '', description: '', example: '' }
        ],
        brandVoice: '',
        brandArchetype: '',

        // Step 3: Cult Brand Model
        employeeBrand: '',
        employeeValues: '',
        employeeStory: '',
        consumerBrand: '',
        consumerExperience: '',
        sharedValues: '',

        // Step 4: Marketing Strategy
        targetSegmentPain: '',
        messagingPillars: [
          { id: 1, pillar: '', rationale: '', channels: '' }
        ],
        contentStrategy: '',

        // Step 5: Implementation
        marketingActions: [
          { id: 1, action: '', owner: '', deadline: '', expectedImpact: '' }
        ],
        successMetrics: '',
        consistencyChecklist: ''
      });

            useEffect(() => {
                async function loadDeps() {
                    const userId = localStorage.getItem('ft_user_id');
                    if (!userId || !window.ToolDB || !window.DependencyInjection) return;
                    try {
                        await ToolDB.whenReady();
                        const config = DependencyInjection.getDependenciesConfig();
                        const toolConfig = config[CONFIG.TOOL_SLUG];
                        if (!toolConfig || !toolConfig.fields) return;
                        const loaded = [];
                        for (const field of toolConfig.fields) {
                            const val = await ToolDB.getDependency(userId, field.source_field);
                            if (val) {
                                loaded.push({ label: field.display_label || field.source_field, value: window.DependencyInjection ? DependencyInjection.formatValue(val) : (typeof val === 'object' ? JSON.stringify(val, null, 2) : String(val)) });
                            }
                        }
                        setDeps(loaded);
                    } catch (err) {
                        console.warn('[' + CONFIG.TOOL_SLUG + '] Failed to load dependencies:', err);
                    }
                }
                loadDeps();
            }, []);

      // Load from localStorage
      useEffect(() => {
        const saved = localStorage.getItem('brand-marketing-data');
        if (saved) {
          try {
            const savedData = JSON.parse(saved);
            setData(savedData);
          } catch (e) {
            console.error('Error loading saved data:', e);
          }
        }
      }, []);

      // Auto-save every 2 seconds
      useEffect(() => {
        const interval = setInterval(() => {
          localStorage.setItem('brand-marketing-data', JSON.stringify(data));
        }, 2000);
        return () => clearInterval(interval);
      }, [data]);

      const updateData = (field, value) => {
        setData({ ...data, [field]: value });
      };

      const addTrait = () => {
        const newTrait = { id: Date.now(), trait: '', description: '', example: '' };
        updateData('personalityTraits', [...data.personalityTraits, newTrait]);
      };

      const removeTrait = (id) => {
        if (data.personalityTraits.length > 1) {
          updateData('personalityTraits', data.personalityTraits.filter(t => t.id !== id));
        }
      };

      const updateTrait = (id, field, value) => {
        const updated = data.personalityTraits.map(t => t.id === id ? { ...t, [field]: value } : t);
        updateData('personalityTraits', updated);
      };

      const addPillar = () => {
        const newPillar = { id: Date.now(), pillar: '', rationale: '', channels: '' };
        updateData('messagingPillars', [...data.messagingPillars, newPillar]);
      };

      const removePillar = (id) => {
        if (data.messagingPillars.length > 1) {
          updateData('messagingPillars', data.messagingPillars.filter(p => p.id !== id));
        }
      };

      const updatePillar = (id, field, value) => {
        const updated = data.messagingPillars.map(p => p.id === id ? { ...p, [field]: value } : p);
        updateData('messagingPillars', updated);
      };

      const addAction = () => {
        const newAction = { id: Date.now(), action: '', owner: '', deadline: '', expectedImpact: '' };
        updateData('marketingActions', [...data.marketingActions, newAction]);
      };

      const removeAction = (id) => {
        if (data.marketingActions.length > 1) {
          updateData('marketingActions', data.marketingActions.filter(a => a.id !== id));
        }
      };

      const updateAction = (id, field, value) => {
        const updated = data.marketingActions.map(a => a.id === id ? { ...a, [field]: value } : a);
        updateData('marketingActions', updated);
      };

      const advanceStep = (fromStep) => {
        setStep(fromStep + 0.5);
      };

      const goNext = () => {
        if (step === 0.5) {
          setStep(1);
        } else if (step === 0) {
          setStep(0.5);
        }
      };

      const handleNext = async (fromStep) => {
        const userId = localStorage.getItem('ft_user_id');
        if (!userId) { alert('User not authenticated.'); return; }
        setAiReviewing(true);
        try {
          let stepAnswers = {};
          let stepName = '';
          if (fromStep === 1) {
            stepName = 'Brand Promise';
            stepAnswers = { brandPromise: data.brandPromise, emotionalConnection: data.emotionalConnection, valuePropositionTransform: data.valuePropositionTransform, brandEnemy: data.brandEnemy };
          } else if (fromStep === 2) {
            stepName = 'Brand Personality';
            stepAnswers = { personalityTraits: data.personalityTraits, brandVoice: data.brandVoice, brandArchetype: data.brandArchetype };
          } else if (fromStep === 3) {
            stepName = 'Cult Brand Model';
            stepAnswers = { employeeBrand: data.employeeBrand, employeeValues: data.employeeValues, employeeStory: data.employeeStory, consumerBrand: data.consumerBrand, consumerExperience: data.consumerExperience, sharedValues: data.sharedValues };
          } else if (fromStep === 4) {
            stepName = 'Marketing Strategy';
            stepAnswers = { targetSegmentPain: data.targetSegmentPain, messagingPillars: data.messagingPillars, contentStrategy: data.contentStrategy };
          } else if (fromStep === 5) {
            stepName = 'Implementation Plan';
            stepAnswers = { marketingActions: data.marketingActions, successMetrics: data.successMetrics, consistencyChecklist: data.consistencyChecklist };
          }
          const canProceed = await window.AIChallenge.reviewStep(userId, CONFIG.TOOL_SLUG, stepAnswers, stepName);
          if (canProceed) {
            advanceStep(fromStep);
          }
        } catch (err) {
          console.warn('[AIChallenge] Error, allowing passage:', err);
          advanceStep(fromStep);
        } finally {
          setAiReviewing(false);
        }
      };

      const goBack = () => {
        if (step === 6) {
          setStep(5);
        } else if (step > 1) {
          setStep(step - 1);
        } else if (step === 1) {
          setStep(0.5);
        }
      };

      // Validation functions
      const isStep1Valid = () => {
        return data.brandPromise.length >= 50 &&
               data.emotionalConnection.length >= 30 &&
               data.valuePropositionTransform.length >= 50 &&
               data.brandEnemy.length >= 30;
      };

      const isStep2Valid = () => {
        return data.personalityTraits.length >= 3 &&
               data.personalityTraits.every(t =>
                 t.trait.trim().length >= 5 &&
                 t.description.trim().length >= 20 &&
                 t.example.trim().length >= 20
               ) &&
               data.brandVoice.length >= 50 &&
               data.brandArchetype.length >= 20;
      };

      const isStep3Valid = () => {
        return data.employeeBrand.length >= 50 &&
               data.employeeValues.length >= 50 &&
               data.employeeStory.length >= 50 &&
               data.consumerBrand.length >= 50 &&
               data.consumerExperience.length >= 50 &&
               data.sharedValues.length >= 50;
      };

      const isStep4Valid = () => {
        return data.targetSegmentPain.length >= 50 &&
               data.messagingPillars.length >= 3 &&
               data.messagingPillars.every(p =>
                 p.pillar.trim().length >= 10 &&
                 p.rationale.trim().length >= 30 &&
                 p.channels.trim().length >= 20
               ) &&
               data.contentStrategy.length >= 100;
      };

      const isStep5Valid = () => {
        return data.marketingActions.length >= 3 &&
               data.marketingActions.every(a =>
                 a.action.trim().length >= 20 &&
                 a.owner.trim().length >= 5 &&
                 a.deadline.trim().length >= 5 &&
                 a.expectedImpact.trim().length >= 20
               ) &&
               data.successMetrics.length >= 100 &&
               data.consistencyChecklist.length >= 50;
      };

      const exportPDF = async () => {
        try {
          const canvas = document.getElementById('canvas-content');
          if (!canvas) {
            alert('Canvas not found');
            return;
          }

          // Hide images to avoid CORS
          const images = canvas.querySelectorAll('img');
          const imageStates = [];
          images.forEach(img => {
            imageStates.push({ img, display: img.style.display });
            img.style.display = 'none';
          });

          const canvasImage = await html2canvas(canvas, {
            scale: 2,
            logging: false,
            backgroundColor: '#ffffff'
          });

          // Restore images
          imageStates.forEach(({ img, display }) => {
            img.style.display = display;
          });

          const imgWidth = 190;
          const imgHeight = (canvasImage.height * imgWidth) / canvasImage.width;

          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const imgData = canvasImage.toDataURL('image/png');

          pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
          pdf.save('brand-and-marketing.pdf');
        } catch (error) {
          console.error('PDF export error:', error);
          alert('Failed to export PDF: ' + error.message);
        }
      };

      const handleSubmit = async () => {
        try {
          const userId = localStorage.getItem('ft_user_id');
          if (!userId) {
            alert('User not authenticated. Please return to the dashboard.');
            return;
          }

          const questionMappings = {
            cult_model: {
              employeeBrand: data.employeeBrand,
              employeeValues: data.employeeValues,
              employeeStory: data.employeeStory,
              consumerBrand: data.consumerBrand,
              consumerExperience: data.consumerExperience,
              sharedValues: data.sharedValues
            },
            roadmap: {
              marketingActions: data.marketingActions,
              messagingPillars: data.messagingPillars,
              contentStrategy: data.contentStrategy,
              successMetrics: data.successMetrics,
              consistencyChecklist: data.consistencyChecklist
            }
          };

          await window.AIChallenge.submitWithChallenge(userId, CONFIG.TOOL_SLUG, questionMappings, {
            onReviewStart: () => { setSubmitMessage('AI coach is reviewing...'); },
            onRevise: () => { setSubmitStatus(null); setSubmitMessage(''); setStep(5); },
            onSubmitAnyway: () => { setSubmitStatus('success'); setSubmitMessage('Submission saved successfully!'); },
            onError: (err) => { setSubmitStatus('error'); setSubmitMessage('Failed to save: ' + err.message); }
          });
        } catch (error) {
          console.error('Submit error:', error);
          alert('Submission failed: ' + error.message);
        }
      };

      // Render different pages based on step
      if ([1.5, 2.5, 3.5, 4.5, 5.5].includes(step)) {
        return window.renderTransitionScreen(step, CONFIG, 5, setStep);
      }

      if (step === 0) {
        return <CoverPage onStart={goNext} />;
      }

      if (step === 0.5) {
        return <IntroPage onNext={goNext} />;
      }

      // Steps 1-5: Wizard layout
      if (step >= 1 && step <= 5) {
        const stepLabels = ['Brand Promise', 'Brand Personality', 'Cult Brand Model', 'Marketing Strategy', 'Implementation'];
        const isValid = step === 1 ? isStep1Valid() : step === 2 ? isStep2Valid() : step === 3 ? isStep3Valid() : step === 4 ? isStep4Valid() : isStep5Valid();
        const canProceed = !aiReviewing && isValid;
        const nextLabels = {
          1: 'NEXT: PERSONALITY →',
          2: 'NEXT: CULT BRAND →',
          3: 'NEXT: MARKETING STRATEGY →',
          4: 'NEXT: IMPLEMENTATION →',
          5: 'VIEW BRAND STRATEGY →'
        };
        return (
          <div className="wizard-layout">
            <div className="wizard-main">
              <div className="wizard-content animate-in">
                <DependencyContext deps={deps} />
                {step === 1 && <Step1Page data={data} updateData={updateData} />}
                {step === 2 && <Step2Page data={data} updateData={updateData} updateTrait={updateTrait} addTrait={addTrait} removeTrait={removeTrait} />}
                {step === 3 && <Step3Page data={data} updateData={updateData} />}
                {step === 4 && <Step4Page data={data} updateData={updateData} updatePillar={updatePillar} addPillar={addPillar} removePillar={removePillar} />}
                {step === 5 && <Step5Page data={data} updateData={updateData} updateAction={updateAction} addAction={addAction} removeAction={removeAction} />}
              </div>
              <div className="wizard-footer">
                <button className="btn-wiz-back" onClick={goBack}>← BACK</button>
                <button className="btn-wiz-next" disabled={!canProceed} onClick={() => handleNext(step)}>
                  {aiReviewing ? 'AI COACH REVIEWING...' : (nextLabels[step] || 'NEXT →')}
                </button>
              </div>
            </div>
            <WizardSidebar currentStep={step} stepLabels={stepLabels} totalSteps={5} />
          </div>
        );
      }

      if (step === 6) {
        return (
          <CanvasPage
            data={data}
            onExport={exportPDF}
            onSubmit={handleSubmit}
          />
        );
      }

      return null;
    }

    // Cover Page Component
    function CoverPage({ onStart }) {
      return (
        <div className="relative min-h-screen flex items-center justify-center bg-black">
          <div
            className="absolute inset-0 w-full h-full"
            style={{
              backgroundImage: 'url("https://images.unsplash.com/photo-1493421419110-74f4e85ba126?w=1920&q=80")',
              backgroundSize: 'cover',
              backgroundPosition: 'center'
            }}
          ></div>
          <div className="absolute inset-0" style={{background: 'linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.85))'}}></div>

          <div className="relative z-10 text-center text-white px-8 max-w-5xl mx-auto">
            <h1 className="plaak animate-in" style={{fontSize: '100px', lineHeight: '1', marginBottom: '32px'}}>
              BRAND AND
            </h1>
            <h2 className="plaak animate-in" style={{fontSize: '80px', lineHeight: '1', marginBottom: '32px', color: '#FFF469', animationDelay: '0.1s'}}>
              MARKETING
            </h2>
            <p className="text-4xl mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              Strategy made visible. Strategy in motion.
            </p>
            <button
              onClick={onStart}
              className="bg-white text-black plaak px-16 py-6 border-4 border-white hover:bg-black hover:text-white transition-all text-3xl animate-in"
              style={{animationDelay: '0.4s'}}
            >
              START
            </button>
          </div>
        </div>
      );
    }

    // Intro Page Component
    function IntroPage({ onNext }) {
      return (
        <div className="bg-black text-white min-h-screen p-16">
          <div className="max-w-5xl mx-auto">
            <h1 className="plaak mb-16 animate-in" style={{fontSize: '100px'}}>
              BEFORE WE START
            </h1>

            {/* Sprint Info */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.05s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>SPRINT INFO</h2>
              <div className="bg-white text-black p-8">
                <p className="text-2xl font-bold mb-4">Sprint 19: Brand and Marketing</p>
                <p className="text-xl leading-relaxed mb-4">
                  Your brand is not your logo. It&apos;s the feeling people get when they think of you. Strong brands outperform the market by 206%. This sprint builds a weaponized brand rooted in strategic clarity and emotional truth.
                </p>
                <div className="border-l-4 border-black pl-4 italic text-lg">
                  &quot;If people believe they share values with a company, they will stay loyal to the brand.&quot; — Howard Schultz
                </div>
              </div>
            </div>

            {/* Purpose */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <h2 className="plaak text-6xl mb-6">PURPOSE</h2>

              <div className="border-l-4 border-white pl-6 mb-6">
                <p className="text-3xl italic mb-2">&quot;Strong marketing is the execution of a sharp strategy. A strong brand is the outward signal of a deep internal truth.&quot;</p>
                <p className="text-xl text-gray-400">— FAST TRACK BRAND PRINCIPLE</p>
              </div>

              <p className="text-3xl leading-relaxed mb-4">
                Most companies die in the fog. This sprint builds your lighthouse. It forces clarity on who you are for, what you solve, and why people should care. When you nail your brand, clients find you, trust you, and stay.
              </p>
            </div>

            {/* Mistakes to Avoid */}
            <div className="mb-12 animate-in" style={{animationDelay: '0.2s'}}>
              <h2 className="plaak text-6xl mb-6" style={{color: '#FFF469'}}>MISTAKES TO AVOID</h2>

              <div className="bg-white text-black p-6 mb-6 border-4 border-yellow-400">
                <p className="riforma-bold text-2xl mb-4">COMMON BRAND FAILURES:</p>
                <ul className="text-xl space-y-3">
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">1.</span>
                    <span><strong>Weak or generic strategy:</strong> 87% of marketers produce content they&apos;re not proud of because brand strategy is unclear</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">2.</span>
                    <span><strong>Unclear brand identity:</strong> Message dies on arrival when brand promise is weak or competitors could say the same thing</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">3.</span>
                    <span><strong>Inconsistent messaging:</strong> Trust disappears when employee brand doesn&apos;t match consumer brand</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">4.</span>
                    <span><strong>Reactive vs proactive:</strong> Following market trends instead of being driven by core belief and values</span>
                  </li>
                  <li className="flex items-start">
                    <span className="text-3xl mr-3">5.</span>
                    <span><strong>No one is for you:</strong> If you don&apos;t know who you&apos;re for, customers can&apos;t identify with you</span>
                  </li>
                </ul>
              </div>
            </div>

            {/* The Journey */}
            <div className="mb-16 animate-in" style={{animationDelay: '0.3s'}}>
              <h2 className="plaak text-6xl mb-8">THE JOURNEY</h2>
              <div className="grid grid-cols-5 gap-4 text-center">
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">01</div>
                  <p className="text-xl font-bold mb-2">PROMISE</p>
                  <p className="text-base text-gray-400">Emotional brand core</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">02</div>
                  <p className="text-xl font-bold mb-2">PERSONALITY</p>
                  <p className="text-base text-gray-400">Who you are</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">03</div>
                  <p className="text-xl font-bold mb-4">CULT MODEL</p>
                  <p className="text-base text-gray-400">Employee + Consumer</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">04</div>
                  <p className="text-xl font-bold mb-2">STRATEGY</p>
                  <p className="text-base text-gray-400">Messaging pillars</p>
                </div>
                <div className="border-2 border-white p-6">
                  <div className="text-8xl plaak mb-4">05</div>
                  <p className="text-xl font-bold mb-2">IMPLEMENT</p>
                  <p className="text-base text-gray-400">Marketing actions</p>
                </div>
              </div>
            </div>

            {/* Next Button */}
            <button
              onClick={onNext}
              className="btn-primary w-full text-3xl py-8 plaak"
            >
              LET&apos;S START →
            </button>
          </div>
        </div>
      );
    }

    // Help Modal Component
    function HelpModal({ step, onClose }) {
      const helpContent = {
        1: {
          why: "Your brand promise transforms a transactional value proposition into an emotional human experience. It's the foundation that separates memorable brands (Airbnb's 'belong anywhere') from forgettable commodities ('we rent rooms').",
          what: "A brand promise is a crystal-clear statement of the transformation you deliver. It answers: What feeling do you create? What change do you enable? What do people become after working with you?",
          how: "Write one sentence that captures the transformation. Test it: Could a competitor say this? If yes, it's not differentiated. Make it emotional, specific, and polarizing. Define what you're NOT (your brand enemy) to clarify what you ARE."
        },
        2: {
          why: "Brand personality makes you recognizable and memorable. Red Bull doesn't just sell energy drinks—they act like rebels and talk like adrenaline junkies. Personality creates consistency across every touchpoint.",
          what: "Define 3-5 core personality traits that show up in every interaction. Each trait needs a description and real example. Add your brand voice (how you sound) and archetype (what role you play).",
          how: "List traits customers would use to describe you. Be specific: not 'friendly' but 'direct and challenging'. Give examples: 'In meetings, we interrupt fluff and ask: What's the one decision we need today?' Test for consistency."
        },
        3: {
          why: "Cult brands align what employees believe internally with what consumers experience externally. Patagonia employees are activists; customers buy purpose with product. This alignment creates belonging and loyalty on both sides.",
          what: "Define your employee brand (who we are, our values, our story) and consumer brand (who we are for them, their experience, shared values). The bridge is shared values that connect both groups.",
          how: "Ask employees: Why do you work here? What do you value? Ask customers: How do you describe us? What do you consistently experience? Find the overlap—these shared values are your cult brand foundation."
        },
        4: {
          why: "Marketing without strategy is noise. Gymshark scaled to £400M by aligning every marketing action to their cult identity. Your messaging must speak directly to your target segment's deepest pain through consistent pillars.",
          what: "Identify target segment's core pain. Create 3-5 messaging pillars (themes you consistently communicate). Define content strategy: what you create, how often, which channels, what formats.",
          how: "Start with pain: What keeps them up at night? Build pillars that address this pain from different angles. For each pillar, define rationale and channels. Create content calendar that reinforces pillars consistently."
        },
        5: {
          why: "Brand strategy is worthless without execution. 87% of marketers produce content they're not proud of because there's no implementation plan. Clear actions, owners, and metrics turn strategy into results.",
          what: "Define first 3 high-impact marketing actions with owners, deadlines, and expected impact. Set success metrics for brand and marketing. Create consistency checklist to ensure alignment across all touchpoints.",
          how: "Prioritize actions with highest impact: What will move the needle fastest? Assign clear owners and realistic deadlines (30-60 days). Define metrics you'll actually track. Build checklist: Before publishing, does this sound like us?"
        }
      };

      const content = helpContent[step];

      return (
        <div
          className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-8"
          onClick={onClose}
        >
          <div
            className="bg-white text-black max-w-3xl w-full border-8 border-black p-12 relative"
            onClick={(e) => e.stopPropagation()}
          >
            <button
              onClick={onClose}
              className="absolute top-4 right-4 text-4xl hover:text-gray-600"
            >
              ×
            </button>

            <h2 className="plaak mb-8 text-black" style={{fontSize: '80px'}}>
              INSTRUCTIONS
            </h2>

            <div className="space-y-8 text-lg">
              <div>
                <h3 className="riforma-bold mb-3" style={{fontSize: '40px'}}>Why This Matters</h3>
                <p>{content.why}</p>
              </div>

              <div>
                <h3 className="riforma-bold mb-3" style={{fontSize: '40px'}}>What You&apos;re Doing</h3>
                <p>{content.what}</p>
              </div>

              <div>
                <h3 className="riforma-bold mb-3" style={{fontSize: '40px'}}>How To Do It</h3>
                <p>{content.how}</p>
              </div>
            </div>

            <button
              onClick={onClose}
              className="btn-primary w-full mt-8 text-2xl py-4"
            >
              GOT IT
            </button>
          </div>
        </div>
      );
    }

    // Step 1: Brand Promise
    function Step1Page({ data, updateData }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">01. BRAND PROMISE</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Harvard Business Review found that 64% of consumers cite shared values as the primary reason they form relationships with a brand — not price, not features. Neumeier's research in <em>The Brand Gap</em> shows that brands creating a gut-level emotional reaction achieve 3x higher recall than those relying on rational messaging. Writing your brand promise forces the cognitive specificity that separates magnetic brands from forgettable ones (Neumeier, 2003; HBR, 2020).
            </ScienceBox>

            {/* Common Mistake */}


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Craft your crystal-clear, emotionally charged brand promise
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Airbnb shifted from &apos;room rentals&apos; to &apos;belong anywhere&apos; — a killer brand promise that tripled market share in 3 years.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your brand promise transforms your value proposition into a human experience. It&apos;s the feeling people get when they think of you. Make it specific, emotional, and impossible for competitors to copy.
            </p>

            <div className="space-y-6 mb-12">
              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.15s'}}>
                <label className="monument text-sm block mb-2">BRAND PROMISE <span className="text-red-500">*</span></label>
                <ScienceBookmarkIcon>
                    Neumeier's Brand Gap framework: brands that articulate a clear transformation promise achieve 3x stronger customer recall than feature-based positioning.
                </ScienceBookmarkIcon>
                <p className="text-sm text-gray-600 mb-2">One clear sentence. What transformation do you promise?</p>
                <textarea
                  value={data.brandPromise}
                  onChange={(e) => updateData('brandPromise', e.target.value)}
                  placeholder="We help ambitious CEOs gain 10 hours per week by eliminating the fog between strategy and execution—so they can focus on what actually grows their business."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.brandPromise.length}/500 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.2s'}}>
                <label className="monument text-sm block mb-2">EMOTIONAL CONNECTION <span className="text-red-500">*</span></label>
                <ScienceBookmarkIcon>
                    HBR: 64% of consumers form brand relationships based on shared emotional values, not product features or price.
                </ScienceBookmarkIcon>
                <p className="text-sm text-gray-600 mb-2">What feeling do you create? What emotion drives loyalty?</p>
                <textarea
                  value={data.emotionalConnection}
                  onChange={(e) => updateData('emotionalConnection', e.target.value)}
                  placeholder="Confidence. Relief. Control. Our clients feel like they&apos;ve finally found someone who gets it—no fluff, no theory, just results."
                  className="w-full"
                  rows={3}
                />
                <div className="char-counter">{data.emotionalConnection.length}/500 (min 30)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.25s'}}>
                <label className="monument text-sm block mb-2">VALUE PROPOSITION TRANSFORMATION <span className="text-red-500">*</span></label>
                <ScienceBookmarkIcon>
                    Seth Godin's Purple Cow principle: remarkable brands transform features into stories. People don't buy products — they buy better versions of themselves.
                </ScienceBookmarkIcon>
                <p className="text-sm text-gray-600 mb-2">How does your brand promise elevate your value prop into human terms?</p>
                <textarea
                  value={data.valuePropositionTransform}
                  onChange={(e) => updateData('valuePropositionTransform', e.target.value)}
                  placeholder="Value Prop: &quot;Strategy execution consulting&quot; → Brand Promise: &quot;Get your weekends back while growing faster&quot;. We turned a service into a lifestyle upgrade."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.valuePropositionTransform.length}/1000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">BRAND ENEMY (What you&apos;re NOT) <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">Define the anti-brand. What do you stand against?</p>
                <textarea
                  value={data.brandEnemy}
                  onChange={(e) => updateData('brandEnemy', e.target.value)}
                  placeholder="We&apos;re not consultants who write reports and disappear. We&apos;re not gurus selling inspiration. We&apos;re the anti-theory, anti-complexity, anti-waste brigade."
                  className="w-full"
                  rows={3}
                />
                <div className="char-counter">{data.brandEnemy.length}/500 (min 30)</div>
              </div>
            </div>

        </div>
      );
    }

    // Step 2: Brand Personality
    function Step2Page({ data, updateData, updateTrait, addTrait, removeTrait }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">02. BRAND PERSONALITY</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Jungian archetype theory, applied to branding by Margaret Mark and Carol Pearson in <em>The Hero and the Outlaw</em>, demonstrates that brands aligned to a universal archetype achieve 97% higher emotional engagement than those without clear personality frameworks. Neumeier's "Brand Gap" research confirms: people don't remember ads — they remember patterns. Repetition of consistent personality traits creates trust, and trust creates pricing power (Mark &amp; Pearson, 2001; Neumeier, 2003).
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Define who you are in the customer&apos;s story
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Red Bull acts like a rebel, talks like an adrenaline junkie, and owns &apos;energy&apos;. Ruthlessly simple, instantly memorable, radically them.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your brand personality is how you show up in every interaction. Define 3-5 core traits that make you unmistakably YOU. Be specific. Be polarizing. Be consistent.
            </p>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Personality Traits</h4>
                {data.personalityTraits.map((trait, index) => (
                  <div key={trait.id} className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: `${0.15 + index * 0.05}s`}}>
                    <div className="flex justify-between items-start mb-4">
                      <h5 className="riforma-bold text-2xl">Trait {index + 1}</h5>
                      {data.personalityTraits.length > 1 && (
                        <button
                          onClick={() => removeTrait(trait.id)}
                          className="text-red-600 hover:text-red-800 text-sm"
                        >
                          REMOVE
                        </button>
                      )}
                    </div>

                    <div className="space-y-4">
                      <div>
                        <label className="monument text-sm block mb-2">TRAIT NAME <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={trait.trait}
                          onChange={(e) => updateTrait(trait.id, 'trait', e.target.value)}
                          placeholder="Direct / Rebellious / Precise / Bold / Caring"
                          className="w-full"
                        />
                        <div className="char-counter">{trait.trait.length}/100 (min 5)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">DESCRIPTION <span className="text-red-500">*</span></label>
                        <textarea
                          value={trait.description}
                          onChange={(e) => updateTrait(trait.id, 'description', e.target.value)}
                          placeholder="We don&apos;t sugarcoat. We tell CEOs what they need to hear, not what they want to hear. We challenge assumptions and cut through bullshit."
                          className="w-full"
                          rows={3}
                        />
                        <div className="char-counter">{trait.description.length}/500 (min 20)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">EXAMPLE IN ACTION <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={trait.example}
                          onChange={(e) => updateTrait(trait.id, 'example', e.target.value)}
                          placeholder="In meetings, we interrupt fluff and ask: What&apos;s the one decision we need to make today?"
                          className="w-full"
                        />
                        <div className="char-counter">{trait.example.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addTrait} className="btn-secondary text-sm w-full">+ ADD TRAIT</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">BRAND VOICE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How do you sound? What&apos;s your tone across all communications?</p>
                <textarea
                  value={data.brandVoice}
                  onChange={(e) => updateData('brandVoice', e.target.value)}
                  placeholder="Sharp. No-nonsense. Confident but not arrogant. We write like we talk: short sentences, active voice, zero jargon. We use metaphors from sports and military strategy."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.brandVoice.length}/1000 (min 50)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.35s'}}>
                <label className="monument text-sm block mb-2">BRAND ARCHETYPE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What role do you play? The Sage? The Hero? The Rebel?</p>
                <input
                  type="text"
                  value={data.brandArchetype}
                  onChange={(e) => updateData('brandArchetype', e.target.value)}
                  placeholder="The Sage + The Warrior: We bring wisdom with urgency, knowledge with action"
                  className="w-full"
                />
                <div className="char-counter">{data.brandArchetype.length}/300 (min 20)</div>
              </div>
            </div>

        </div>
      );
    }

    // Step 3: Cult Brand Model
    function Step3Page({ data, updateData }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">03. CULT BRAND MODEL</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Ragas and Bueno's <em>The Power of Cult Branding</em> analyzed brands like Apple, Harley-Davidson, and Oprah's empire, finding that cult brands share one trait: internal culture and external experience are indistinguishable. Gallup research confirms that companies with high employee-brand alignment see 21% higher profitability and 41% lower absenteeism. When employees genuinely believe the brand story, customers feel it in every interaction (Ragas &amp; Bueno, 2002; Gallup, 2022).
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Build employee and consumer brand alignment
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Patagonia: Employee brand = Activists. Consumer brand = Purpose with product. Result? Cult following. 64% of consumers stay loyal when they share values with a brand.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your cult brand connects what employees believe (internal) with what consumers experience (external). When these align, you create belonging, not just transactions.
            </p>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Employee Brand (Internal)</h4>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.15s'}}>
                  <label className="monument text-sm block mb-2">WHO WE ARE (Employee Identity) <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What do employees say about why they work here?</p>
                  <textarea
                    value={data.employeeBrand}
                    onChange={(e) => updateData('employeeBrand', e.target.value)}
                    placeholder="We&apos;re execution obsessives who can&apos;t stand waste. We work here because we get to cut through corporate BS and see real companies transform in 90 days."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.employeeBrand.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.2s'}}>
                  <label className="monument text-sm block mb-2">CORE VALUES (Employee Beliefs) <span className="text-red-500">*</span></label>
                  <textarea
                    value={data.employeeValues}
                    onChange={(e) => updateData('employeeValues', e.target.value)}
                    placeholder="Brutal honesty over politeness. Speed over perfection. Results over reports. We value clarity, ownership, and getting shit done."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.employeeValues.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.25s'}}>
                  <label className="monument text-sm block mb-2">EMPLOYEE STORY <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What story do employees tell about this company?</p>
                  <textarea
                    value={data.employeeStory}
                    onChange={(e) => updateData('employeeStory', e.target.value)}
                    placeholder="People join us burned out from big consulting firms where they wrote decks no one read. Here, they see their work implemented within weeks. They tell friends: Finally, a place that values impact."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.employeeStory.length}/1000 (min 50)</div>
                </div>
              </div>

              <div>
                <h4 className="riforma-bold text-3xl mb-4">Consumer Brand (External)</h4>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.3s'}}>
                  <label className="monument text-sm block mb-2">WHO WE ARE FOR THEM <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">How do customers describe you to others?</p>
                  <textarea
                    value={data.consumerBrand}
                    onChange={(e) => updateData('consumerBrand', e.target.value)}
                    placeholder="Clients call us &apos;the anti-consultants&apos; or &apos;the execution enforcers&apos;. They say we&apos;re the team that finally made strategy real instead of another binder on the shelf."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.consumerBrand.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.35s'}}>
                  <label className="monument text-sm block mb-2">CONSUMER EXPERIENCE <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What do customers consistently experience?</p>
                  <textarea
                    value={data.consumerExperience}
                    onChange={(e) => updateData('consumerExperience', e.target.value)}
                    placeholder="First meeting: we challenge their thinking. First sprint: they see results. After 90 days: they can&apos;t imagine going back to the old way. Every touchpoint is fast, focused, and actionable."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.consumerExperience.length}/1000 (min 50)</div>
                </div>

                <div className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: '0.4s'}}>
                  <label className="monument text-sm block mb-2">SHARED VALUES (The Bridge) <span className="text-red-500">*</span></label>
                  <p className="text-sm text-gray-600 mb-2">What values connect employees and customers?</p>
                  <textarea
                    value={data.sharedValues}
                    onChange={(e) => updateData('sharedValues', e.target.value)}
                    placeholder="Both employees and customers value: (1) No BS honesty, (2) Speed over bureaucracy, (3) Results that matter. This alignment creates loyalty on both sides—employees stay, customers refer."
                    className="w-full"
                    rows={4}
                  />
                  <div className="char-counter">{data.sharedValues.length}/1000 (min 50)</div>
                </div>
              </div>
            </div>

        </div>
      );
    }

    // Step 4: Marketing Strategy
    function Step4Page({ data, updateData, updatePillar, addPillar, removePillar }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">04. MARKETING STRATEGY</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            <ScienceBox collapsible={true}>
                Content Marketing Institute research shows that companies with a documented content strategy are 3x more likely to report success than those without one. Les Binet and Peter Field's landmark IPA study of 996 campaigns found that brand-building messaging drives 60% of long-term business effects, while short-term activation drives only 40%. Organizations that balance brand and activation messaging achieve 2-3x the market share growth of those focused on performance marketing alone (CMI, 2023; Binet &amp; Field, 2013).
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              Create marketing that converts through strategic messaging
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Gymshark scaled from £0 to £400M by aligning every marketing action to its cult identity: grit + self-made. Marketing is strategy in motion.&quot;
              </p>
            </div>

            <p className="text-xl mb-8 text-gray-700">
              Your marketing translates brand into action. Define 3-5 messaging pillars that speak directly to your target segment&apos;s deepest pain. Align tone, channels, and cadence with your brand personality.
            </p>

            <div className="space-y-8 mb-12">
              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.15s'}}>
                <label className="monument text-sm block mb-2">TARGET SEGMENT&apos;S DEEPEST PAIN <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What keeps them up at night? What frustration drives all decisions?</p>
                <textarea
                  value={data.targetSegmentPain}
                  onChange={(e) => updateData('targetSegmentPain', e.target.value)}
                  placeholder="Mid-market CEOs feel trapped: drowning in strategy decks but starving for execution. They&apos;ve paid consultants $100K+ for plans gathering dust. They need results yesterday, not theories tomorrow."
                  className="w-full"
                  rows={4}
                />
                <div className="char-counter">{data.targetSegmentPain.length}/1000 (min 50)</div>
              </div>

              <div>
                <h4 className="riforma-bold text-3xl mb-4">Messaging Pillars (3-5 core themes)</h4>
                {data.messagingPillars.map((pillar, index) => (
                  <div key={pillar.id} className="bg-gray-50 border-2 border-gray-200 p-6 mb-6 animate-in" style={{animationDelay: `${0.2 + index * 0.05}s`}}>
                    <div className="flex justify-between items-start mb-4">
                      <h5 className="riforma-bold text-2xl">Pillar {index + 1}</h5>
                      {data.messagingPillars.length > 1 && (
                        <button
                          onClick={() => removePillar(pillar.id)}
                          className="text-red-600 hover:text-red-800 text-sm"
                        >
                          REMOVE
                        </button>
                      )}
                    </div>

                    <div className="space-y-4">
                      <div>
                        <label className="monument text-sm block mb-2">PILLAR THEME <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={pillar.pillar}
                          onChange={(e) => updatePillar(pillar.id, 'pillar', e.target.value)}
                          placeholder="Speed Over Perfection / Results Not Reports / Execution Beats Theory"
                          className="w-full"
                        />
                        <div className="char-counter">{pillar.pillar.length}/200 (min 10)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">RATIONALE <span className="text-red-500">*</span></label>
                        <textarea
                          value={pillar.rationale}
                          onChange={(e) => updatePillar(pillar.id, 'rationale', e.target.value)}
                          placeholder="Our clients are fed up with endless planning cycles. This pillar positions us as the antidote: we get them moving in weeks, not months. It speaks directly to their frustration with analysis paralysis."
                          className="w-full"
                          rows={3}
                        />
                        <div className="char-counter">{pillar.rationale.length}/500 (min 30)</div>
                      </div>

                      <div>
                        <label className="monument text-sm block mb-2">CHANNELS & TACTICS <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={pillar.channels}
                          onChange={(e) => updatePillar(pillar.id, 'channels', e.target.value)}
                          placeholder="LinkedIn thought leadership, case study emails, CEO roundtables"
                          className="w-full"
                        />
                        <div className="char-counter">{pillar.channels.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addPillar} className="btn-secondary text-sm w-full">+ ADD PILLAR</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.4s'}}>
                <label className="monument text-sm block mb-2">CONTENT STRATEGY & CADENCE <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">What content do you create? How often? What formats?</p>
                <textarea
                  value={data.contentStrategy}
                  onChange={(e) => updateData('contentStrategy', e.target.value)}
                  placeholder="Weekly LinkedIn posts (CEO voice, polarizing takes on strategy waste). Bi-weekly case studies (3-minute read, hard numbers). Monthly CEO roundtable (invite-only, 90 minutes, pure value). Quarterly brand book update (what we learned helping 50+ companies execute)."
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.contentStrategy.length}/2000 (min 100)</div>
              </div>
            </div>

        </div>
      );
    }

    // Step 5: Implementation
    function Step5Page({ data, updateData, updateAction, addAction, removeAction }) {
      return (
        <div>
            <div className="numbered-section mb-8 animate-in">05. IMPLEMENTATION PLAN</div>

            {/* Fast Track Insight */}

            {/* The Science */}
            <ScienceBox collapsible={true}>
                McKinsey's brand strength research across 1,200 companies found that brands with documented consistency guidelines achieve 33% faster revenue growth than those without. Godin's <em>Purple Cow</em> framework demonstrates that remarkable brands need implementation systems, not just ideas — the companies that build brand review checklists and audit touchpoints quarterly sustain 60% higher alignment scores over three years. The difference between a strong brand and a forgotten one is disciplined, measurable execution (McKinsey, 2021; Godin, 2003).
            </ScienceBox>


            <h3 className="riforma-bold text-5xl mb-8 animate-in" style={{animationDelay: '0.05s'}}>
              First 3 high-impact marketing actions to put brand in motion
            </h3>

            <div className="border-l-4 border-yellow-400 pl-6 mb-12 animate-in" style={{animationDelay: '0.1s'}}>
              <p className="text-2xl italic">
                &quot;Branding is strategy made visible. Marketing is strategy in motion. Both must serve your target segment&apos;s deepest pain.&quot;
              </p>
            </div>

            <div className="space-y-8 mb-12">
              <div>
                <h4 className="riforma-bold text-3xl mb-4">Marketing Actions</h4>
                {data.marketingActions.map((action, index) => (
                  <div key={action.id} className="bg-gray-50 border-2 border-gray-200 p-4 mb-4 animate-in" style={{animationDelay: `${0.15 + index * 0.03}s`}}>
                    <div className="flex justify-between items-center mb-3">
                      <span className="monument text-xs">ACTION {index + 1}</span>
                      {data.marketingActions.length > 1 && (
                        <button onClick={() => removeAction(action.id)} className="text-red-600 text-sm">REMOVE</button>
                      )}
                    </div>
                    <div className="space-y-3">
                      <div>
                        <label className="monument text-xs block mb-1">ACTION DESCRIPTION <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={action.action}
                          onChange={(e) => updateAction(action.id, 'action', e.target.value)}
                          placeholder="Launch LinkedIn thought leadership series: 10 posts on strategy execution myths"
                          className="w-full"
                        />
                        <div className="char-counter text-xs">{action.action.length}/300 (min 20)</div>
                      </div>
                      <div className="grid grid-cols-2 gap-3">
                        <div>
                          <label className="monument text-xs block mb-1">OWNER <span className="text-red-500">*</span></label>
                          <input
                            type="text"
                            value={action.owner}
                            onChange={(e) => updateAction(action.id, 'owner', e.target.value)}
                            placeholder="Sarah Chen (Marketing)"
                            className="w-full"
                          />
                          <div className="char-counter text-xs">{action.owner.length}/100 (min 5)</div>
                        </div>
                        <div>
                          <label className="monument text-xs block mb-1">DEADLINE <span className="text-red-500">*</span></label>
                          <input
                            type="text"
                            value={action.deadline}
                            onChange={(e) => updateAction(action.id, 'deadline', e.target.value)}
                            placeholder="March 30, 2025"
                            className="w-full"
                          />
                          <div className="char-counter text-xs">{action.deadline.length}/100 (min 5)</div>
                        </div>
                      </div>
                      <div>
                        <label className="monument text-xs block mb-1">EXPECTED IMPACT <span className="text-red-500">*</span></label>
                        <input
                          type="text"
                          value={action.expectedImpact}
                          onChange={(e) => updateAction(action.id, 'expectedImpact', e.target.value)}
                          placeholder="30 qualified inbound leads, 5 CEO roundtable signups, 10K profile views"
                          className="w-full"
                        />
                        <div className="char-counter text-xs">{action.expectedImpact.length}/300 (min 20)</div>
                      </div>
                    </div>
                  </div>
                ))}
                <button onClick={addAction} className="btn-secondary text-sm w-full">+ ADD ACTION</button>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.3s'}}>
                <label className="monument text-sm block mb-2">SUCCESS METRICS <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How will you measure brand and marketing impact?</p>
                <textarea
                  value={data.successMetrics}
                  onChange={(e) => updateData('successMetrics', e.target.value)}
                  placeholder="Brand: (1) 80% of prospects mention specific brand traits in discovery calls (2) Employee NPS >40 (3) 50% of new clients from referrals&#10;Marketing: (1) 100 qualified leads/quarter (2) 15% conversion to meetings (3) 10 pieces of UGC monthly"
                  className="w-full"
                  rows={6}
                />
                <div className="char-counter">{data.successMetrics.length}/2000 (min 100)</div>
              </div>

              <div className="bg-gray-50 border-2 border-gray-200 p-6 animate-in" style={{animationDelay: '0.35s'}}>
                <label className="monument text-sm block mb-2">CONSISTENCY CHECKLIST <span className="text-red-500">*</span></label>
                <p className="text-sm text-gray-600 mb-2">How will you ensure brand consistency across all touchpoints?</p>
                <textarea
                  value={data.consistencyChecklist}
                  onChange={(e) => updateData('consistencyChecklist', e.target.value)}
                  placeholder="Before publishing anything: (1) Does this sound like us? (2) Would competitors say this? If yes, kill it. (3) Does it serve our target&apos;s pain? (4) Is employee brand aligned with consumer message?"
                  className="w-full"
                  rows={5}
                />
                <div className="char-counter">{data.consistencyChecklist.length}/1000 (min 50)</div>
              </div>
            </div>

        </div>
      );
    }

    // Canvas Page
    function CanvasPage({ data, onExport, onSubmit }) {
      return (
        <div className="bg-gray-100 min-h-screen p-16">
          <div className="max-w-6xl mx-auto">
            {/* Canvas Content */}
            <div id="canvas-content" className="bg-white p-16 mb-8">
              <div className="border-b-4 border-black pb-8 mb-8">
                <h1 className="plaak text-7xl mb-2">BRAND & MARKETING STRATEGY</h1>
                <p className="text-2xl text-gray-600">Sprint 19 - Strategy Made Visible</p>
              </div>

              {/* Brand Promise */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Brand Promise</h2>
                <div className="bg-gray-50 p-6 border-l-4 border-black">
                  <p className="text-xl">{data.brandPromise}</p>
                  <p className="text-lg text-gray-600 mt-4"><strong>Emotion:</strong> {data.emotionalConnection}</p>
                </div>
              </div>

              {/* Brand Personality */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Brand Personality</h2>
                <div className="grid grid-cols-3 gap-4">
                  {data.personalityTraits.slice(0, 3).map((trait, i) => (
                    <div key={i} className="bg-gray-50 p-4 border-2 border-black">
                      <p className="riforma-bold text-xl mb-2">{trait.trait}</p>
                      <p className="text-sm">{trait.description.substring(0, 100)}...</p>
                    </div>
                  ))}
                </div>
                <div className="bg-yellow-50 p-4 border-l-4 border-yellow-400 mt-4">
                  <p className="text-lg"><strong>Voice:</strong> {data.brandVoice.substring(0, 150)}...</p>
                </div>
              </div>

              {/* Cult Brand Model */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Cult Brand Model</h2>
                <div className="grid grid-cols-2 gap-6">
                  <div className="bg-gray-50 p-6 border-l-4 border-black">
                    <p className="riforma-bold text-2xl mb-3">Employee Brand</p>
                    <p className="text-base">{data.employeeBrand.substring(0, 120)}...</p>
                  </div>
                  <div className="bg-gray-50 p-6 border-l-4 border-black">
                    <p className="riforma-bold text-2xl mb-3">Consumer Brand</p>
                    <p className="text-base">{data.consumerBrand.substring(0, 120)}...</p>
                  </div>
                </div>
                <div className="bg-yellow-50 p-4 border-4 border-yellow-400 mt-4">
                  <p className="text-lg"><strong>Shared Values:</strong> {data.sharedValues.substring(0, 150)}...</p>
                </div>
              </div>

              {/* Messaging Pillars */}
              <div className="mb-10">
                <h2 className="riforma-bold text-4xl mb-4">Messaging Pillars</h2>
                <div className="space-y-3">
                  {data.messagingPillars.slice(0, 4).map((pillar, i) => (
                    <div key={i} className="bg-gray-50 p-4 border-l-4 border-black">
                      <p className="riforma-bold text-lg">{i + 1}. {pillar.pillar}</p>
                      <p className="text-sm text-gray-600">{pillar.channels}</p>
                    </div>
                  ))}
                </div>
              </div>

              {/* Marketing Actions */}
              <div>
                <h2 className="riforma-bold text-4xl mb-4">Next Actions</h2>
                <div className="space-y-2">
                  {data.marketingActions.slice(0, 5).map((action, i) => (
                    <div key={i} className="flex items-start text-base">
                      <span className="riforma-bold mr-3">{i + 1}.</span>
                      <div>
                        <p className="riforma-bold">{action.action}</p>
                        <p className="text-sm text-gray-600">{action.owner} - {action.deadline}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="mt-12 pt-8 border-t-2 border-gray-200 text-center text-sm text-gray-500">
                <p>Generated: {new Date().toLocaleDateString()}</p>
                <p className="mt-1">Fast Track Sprint 19 - Brand and Marketing</p>
              </div>
            </div>

            {/* Action Buttons */}
            <div className="flex gap-6 mb-6">
              <button onClick={onExport} className="btn-primary flex-1">
                EXPORT PDF
              </button>
              <button onClick={onSubmit} className="btn-primary flex-1">
                SUBMIT
              </button>
            </div>

            {/* Case Study */}
            <CaseStudy
                before={"A 50-person SaaS company was spending 200K EUR per quarter on paid ads, trade shows, and content production with no unified brand message. Their website said 'innovation,' sales decks said 'reliability,' and social media said 'fun.' Lead volume was high but conversion was 4% — prospects were confused about what the company actually stood for."}
                after={"After completing the Brand and Marketing sprint, they defined a single brand promise ('We turn data chaos into decisions in 24 hours'), aligned all touchpoints to three messaging pillars, and cut marketing channels from six to two. Within 90 days: lead volume dropped 40% but qualified lead conversion jumped to 18%. Cost per acquisition fell by 62%."}
                quote={"We finally stopped trying to be the cool startup AND the trusted enterprise vendor. When we picked a lane and owned it — every email, every slide, every post sounding like us — the right customers started finding us. Our sales team said closing deals felt like a different job."}
            />
          </div>
        </div>
      );
    }

    // Wizard Sidebar
    function WizardSidebar({ currentStep, stepLabels, totalSteps }) {
      return (
        <div className="wizard-sidebar">
          <div style={{ marginBottom: '48px' }}>
            <div className="monument" style={{ fontSize: '10px', color: '#888', letterSpacing: '0.1em', marginBottom: '8px' }}>SPRINT 19</div>
            <div className="plaak" style={{ fontSize: '20px', lineHeight: '1.1', color: '#fff' }}>BRAND AND<br />MARKETING</div>
          </div>
          <div style={{ flex: 1 }}>
            {stepLabels.map((label, i) => {
              const stepNum = i + 1;
              const isActive = Math.floor(currentStep) === stepNum;
              const isCompleted = currentStep > stepNum;
              return (
                <div key={stepNum} style={{ display: 'flex', alignItems: 'flex-start', gap: '12px', marginBottom: '24px', opacity: isActive || isCompleted ? 1 : 0.4 }}>
                  <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: isCompleted ? '#FFF469' : isActive ? '#fff' : 'transparent', border: `2px solid ${isCompleted ? '#FFF469' : isActive ? '#fff' : '#555'}`, display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0, marginTop: '2px' }}>
                    {isCompleted ? (
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#000" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>
                    ) : (
                      <span style={{ fontSize: '10px', color: isActive ? '#000' : '#555', fontFamily: "'Monument', monospace" }}>{stepNum}</span>
                    )}
                  </div>
                  <div style={{ fontSize: '11px', fontFamily: "'Monument', monospace", letterSpacing: '0.05em', color: isActive ? '#fff' : isCompleted ? '#FFF469' : '#555', textTransform: 'uppercase', paddingTop: '4px' }}>{label}</div>
                </div>
              );
            })}
          </div>
          <div style={{ borderTop: '1px solid #333', paddingTop: '24px' }}>
            <div className="monument" style={{ fontSize: '10px', color: '#555', letterSpacing: '0.05em' }}>STEP {Math.floor(Math.max(1, currentStep))} OF {totalSteps}</div>
          </div>
        </div>
      );
    }

    // Progress Indicator
    function ProgressIndicator({ currentStep }) {
      const steps = [
        { number: 1, label: 'Promise' },
        { number: 2, label: 'Personality' },
        { number: 3, label: 'Cult Model' },
        { number: 4, label: 'Strategy' },
        { number: 5, label: 'Implement' }
      ];

      return (
        <div className="flex items-center justify-center gap-4 mb-12">
          {steps.map((step, index) => (
            <Fragment key={step.number}>
              <div className="flex flex-col items-center">
                <div className={`progress-dot ${step.number === currentStep ? 'active' : ''} ${step.number < currentStep ? 'completed' : ''}`}></div>
                <div className="monument text-xs mt-2">{step.label}</div>
              </div>
              {index < steps.length - 1 && <div className="progress-line w-12"></div>}
            </Fragment>
          ))}
        </div>
      );
    }

    // Help Button
    function HelpButton({ onClick }) {
      return (
        <button onClick={onClick} className="help-button">
          ?
        </button>
      );
    }

    // Render App
        ReactDOM.render(<BrandApp />, document.getElementById('root'));
  </script>
</body>
</html>