<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprint 10 - Performance Analysis & Accountability | Fast Track</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../../shared/js/tool-db.js"></script>
    <script src="../../shared/js/ai-challenge.js"></script>
    <script src="../../shared/js/dependency-injection.js"></script>
    <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
    <script src="../../shared/js/cognitive-load.js"></script>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @font-face {
            font-family: 'Plaak';
            src: url('Plaak3Trial-43-Bold.woff2') format('woff2');
            font-weight: bold;
            font-style: normal;
        }
        @font-face {
            font-family: 'Riforma';
            src: url('RiformaLL-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Monument';
            src: url('MonumentGrotesk-Mono.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        body {
            font-family: 'Riforma', sans-serif;
            margin: 0;
            padding: 0;
        }
        .plaak {
            font-family: 'Plaak', sans-serif;
            font-weight: bold;
        }
        .monument {
            font-family: 'Monument', monospace;
        }
        .worksheet-input {
            width: 100%;
            border: 1px solid #E0E0E0;
            padding: 12px 16px;
            font-family: 'Riforma', sans-serif;
            font-size: 18px;
            border-radius: 4px;
            transition: border-color 0.3s;
        }
        .worksheet-input:focus {
            outline: none;
            border-color: #000000;
        }
        .worksheet-textarea {
            width: 100%;
            border: 1px solid #E0E0E0;
            padding: 12px 16px;
            font-family: 'Riforma', sans-serif;
            font-size: 18px;
            border-radius: 4px;
            min-height: 120px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        .worksheet-textarea:focus {
            outline: none;
            border-color: #000000;
        }
        .numbered-section {
            background: #000000;
            color: #FFFFFF;
            padding: 10px 16px;
            font-size: 26px;
            font-family: 'Plaak', sans-serif;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 16px;
        }
        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #E0E0E0;
            transition: background 0.3s;
        }
        .progress-dot.active {
            background: #000000;
        }
        .task-row {
            display: grid;
            grid-template-columns: 2fr 1fr 2fr;
            gap: 12px;
            margin-bottom: 12px;
            align-items: center;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
        }
        .status-done {
            background: #E8F5E9;
            color: #2E7D32;
        }
        .status-not-done {
            background: #FFEBEE;
            color: #C62828;
        }
        .dashboard-metric {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .metric-value {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .metric-label {
            font-size: 14px;
            text-transform: uppercase;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const CONFIG = {
            SUPABASE_URL: 'https://lutzzfaedkbsmbobmrzx.supabase.co',
            SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1dHp6ZmFlZGtic21ib2Jtcnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MDA0MDQsImV4cCI6MjA4NjM3NjQwNH0.o2gJba85vDl4NLS-C8Mq3OudWKxet-b0IqO9kazqb8U',
            TOOL_SLUG: 'performance',
            AUTOSAVE_DELAY: 2000
        };

        // Initialize Supabase client
        const { createClient } = supabase;
        const supabaseClient = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);

        // Make Supabase client globally available for dependency injection
        window.supabaseClient = supabaseClient;

        // Initialize ToolDB and dependency injection
        ToolDB.init(CONFIG.TOOL_SLUG);
        DependencyInjection.init(CONFIG.TOOL_SLUG);

        // Initialize cognitive load components
        CognitiveLoad.init('performance', {"insights":["What gets measured gets managed. But only measure what truly matters.","The 5 Whys technique reveals root causes that symptoms analysis misses."],"caseStudy":{"before":"[PLACEHOLDER] Performance reviews happened annually.","after":"[PLACEHOLDER] Weekly 15-minute check-ins. Problems caught within days.","quote":"[PLACEHOLDER] The accountability framework removed emotion from difficult conversations."}});
        const { FastTrackInsight, ScienceBox, WarningBox, CaseStudy, ScienceBookmarkIcon, ToolGuideDrawer } = CognitiveLoad.components;

        function PerformanceApp() {
            const [step, setStep] = useState(0);
            const [toolType, setToolType] = useState('');
            const [showHelp, setShowHelp] = useState(false);
            const [data, setData] = useState({
                companyId: '',
                userId: '',
                // Individual Process Tools
                fiveWhys: {
                    problem: '',
                    why1: '',
                    why2: '',
                    why3: '',
                    why4: '',
                    why5: '',
                    rootCause: '',
                    solution: ''
                },
                eighty20: {
                    objective: '',
                    inputs: ['', '', '', '', ''],
                    ranking: '',
                    vitalFew: '',
                    trivialMany: ''
                },
                impactEasy: {
                    objective: '',
                    ideas: ['', '', '', '', '', '', '', ''],
                    matrix: {
                        highImpactEasy: [],
                        highImpactHard: [],
                        lowImpactEasy: [],
                        lowImpactHard: []
                    }
                },
                accountability: {
                    expectations: '',
                    ownership: '',
                    checkpoints: '',
                    consequences: '',
                    rewards: '',
                    corrective: ''
                },
                // Team Tools
                performanceSystem: {
                    tasks: [
                        { task: '', status: 'not-done', reason: '', owner: '' },
                        { task: '', status: 'not-done', reason: '', owner: '' },
                        { task: '', status: 'not-done', reason: '', owner: '' },
                        { task: '', status: 'not-done', reason: '', owner: '' },
                        { task: '', status: 'not-done', reason: '', owner: '' }
                    ],
                    dashboardMetrics: '',
                    reviewCadence: '',
                    improvements: ''
                },
                accountabilitySystem: {
                    roles: '',
                    framework: '',
                    transparency: '',
                    timeline: ''
                }
            });

            useEffect(() => {
                const savedData = localStorage.getItem('sprint10_performance_data');
                if (savedData) {
                    setData(JSON.parse(savedData));
                }
            }, []);

            useEffect(() => {
                const timer = setTimeout(() => {
                    localStorage.setItem('sprint10_performance_data', JSON.stringify(data));
                }, 2000);
                return () => clearTimeout(timer);
            }, [data]);

            const updateData = (path, value) => {
                setData(prev => {
                    const newData = { ...prev };
                    const keys = path.split('.');
                    let current = newData;
                    for (let i = 0; i < keys.length - 1; i++) {
                        current = current[keys[i]];
                    }
                    current[keys[keys.length - 1]] = value;
                    return newData;
                });
            };

            const updateArrayItem = (path, index, value) => {
                setData(prev => {
                    const newData = { ...prev };
                    const keys = path.split('.');
                    let current = newData;
                    for (let i = 0; i < keys.length; i++) {
                        if (i === keys.length - 1) {
                            current[keys[i]][index] = value;
                        } else {
                            current = current[keys[i]];
                        }
                    }
                    return newData;
                });
            };

            const updateTaskField = (index, field, value) => {
                setData(prev => {
                    const newData = { ...prev };
                    newData.performanceSystem.tasks[index][field] = value;
                    return newData;
                });
            };

            const moveIdeaToQuadrant = (idea, quadrant) => {
                setData(prev => {
                    const newData = { ...prev };
                    // Remove from all quadrants
                    Object.keys(newData.impactEasy.matrix).forEach(key => {
                        newData.impactEasy.matrix[key] = newData.impactEasy.matrix[key].filter(i => i !== idea);
                    });
                    // Add to selected quadrant
                    if (idea.trim()) {
                        newData.impactEasy.matrix[quadrant].push(idea);
                    }
                    return newData;
                });
            };

            const calculateCompletionRate = () => {
                const tasks = data.performanceSystem.tasks.filter(t => t.task);
                if (tasks.length === 0) return 0;
                const completed = tasks.filter(t => t.status === 'done').length;
                return Math.round((completed / tasks.length) * 100);
            };

            const exportPDF = async () => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 20;
                let yPos = margin;

                pdf.setFontSize(24);
                pdf.setFont(undefined, 'bold');
                pdf.text('SPRINT 10: PERFORMANCE ANALYSIS & ACCOUNTABILITY', pageWidth / 2, yPos, { align: 'center' });

                yPos += 15;
                pdf.setFontSize(12);
                pdf.setFont(undefined, 'normal');
                pdf.text(`Company: ${data.companyId}`, margin, yPos);
                yPos += 7;
                pdf.text(`User: ${data.userId}`, margin, yPos);
                yPos += 7;
                pdf.text(`Type: ${toolType === 'individual' ? 'Individual Process Tools' : 'Team Systems'}`, margin, yPos);
                yPos += 10;

                if (toolType === 'individual') {
                    // 5 Whys
                    if (data.fiveWhys.problem) {
                        pdf.setFontSize(16);
                        pdf.setFont(undefined, 'bold');
                        pdf.text('5 WHYS ANALYSIS', margin, yPos);
                        yPos += 10;

                        pdf.setFontSize(10);
                        pdf.setFont(undefined, 'normal');
                        pdf.text(`Problem: ${data.fiveWhys.problem}`, margin, yPos);
                        yPos += 7;
                        pdf.text(`Root Cause: ${data.fiveWhys.rootCause}`, margin, yPos);
                        yPos += 7;
                        pdf.text(`Solution: ${data.fiveWhys.solution}`, margin, yPos);
                        yPos += 10;
                    }

                    // 80/20
                    if (data.eighty20.objective) {
                        pdf.setFontSize(16);
                        pdf.setFont(undefined, 'bold');
                        pdf.text('80/20 PRINCIPLE', margin, yPos);
                        yPos += 10;

                        pdf.setFontSize(10);
                        pdf.setFont(undefined, 'normal');
                        pdf.text(`Objective: ${data.eighty20.objective}`, margin, yPos);
                        yPos += 7;
                        const vitalLines = pdf.splitTextToSize(`Vital Few: ${data.eighty20.vitalFew}`, pageWidth - 2 * margin);
                        vitalLines.forEach(line => {
                            pdf.text(line, margin, yPos);
                            yPos += 5;
                        });
                    }

                } else {
                    // Team tools
                    pdf.setFontSize(16);
                    pdf.setFont(undefined, 'bold');
                    pdf.text('PERFORMANCE ANALYSIS SYSTEM', margin, yPos);
                    yPos += 10;

                    pdf.setFontSize(10);
                    pdf.setFont(undefined, 'normal');
                    pdf.text(`Completion Rate: ${calculateCompletionRate()}%`, margin, yPos);
                    yPos += 10;

                    data.performanceSystem.tasks.forEach((task, idx) => {
                        if (task.task) {
                            if (yPos > pageHeight - margin) {
                                pdf.addPage();
                                yPos = margin;
                            }
                            pdf.text(`${idx + 1}. ${task.task} - ${task.status.toUpperCase()}`, margin, yPos);
                            yPos += 5;
                            if (task.reason) {
                                pdf.text(`   Reason: ${task.reason}`, margin, yPos);
                                yPos += 5;
                            }
                            yPos += 3;
                        }
                    });
                }

                pdf.save(`Sprint_10_Performance_${data.companyId}_${data.userId}.pdf`);
            };

            const [submitStatus, setSubmitStatus] = useState(null);
            const [submitMessage, setSubmitMessage] = useState('');

            const handleSubmit = async () => {
                const userId = localStorage.getItem('ft_user_id');
                if (!userId) {
                    alert('User not authenticated. Please return to the dashboard.');
                    return;
                }
                const questionMappings = {
                    execution_dashboard: { performanceSystem: data.performanceSystem, eighty20: data.eighty20, impactEasy: data.impactEasy },
                    five_why: data.fiveWhys,
                    consequences_table: { accountability: data.accountability, accountabilitySystem: data.accountabilitySystem }
                };
                await window.AIChallenge.submitWithChallenge(userId, CONFIG.TOOL_SLUG, questionMappings, {
                    onReviewStart: () => { setSubmitStatus('saving'); setSubmitMessage('AI coach is reviewing...'); },
                    onRevise: () => { setSubmitStatus(null); setSubmitMessage(''); setStep(toolType === 'individual' ? 4 : 2); },
                    onSubmitAnyway: () => { setSubmitStatus('success'); setSubmitMessage('Submission saved successfully!'); },
                    onError: (err) => { setSubmitStatus('error'); setSubmitMessage('Failed to save: ' + err.message); }
                });
            };

            const getTotalSteps = () => {
                if (toolType === 'individual') return 4;
                if (toolType === 'team') return 2;
                return 0;
            };

            const getStepProgress = () => {
                const total = getTotalSteps();
                if (step <= 0.5) return 0;
                if (step === 999) return 100;
                return Math.round((step / total) * 100);
            };

            const renderProgressIndicator = () => {
                if (step === 0 || step === 0.5) return null;

                const total = getTotalSteps();
                const steps = Array.from({ length: total }, (_, i) => i + 1);

                return (
                    <div className="fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-50">
                        <div className="max-w-4xl mx-auto px-6 py-4">
                            <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-semibold monument">
                                    SPRINT 10: PERFORMANCE ANALYSIS & ACCOUNTABILITY
                                </span>
                                <span className="text-sm font-semibold">
                                    {step === 999 ? 'CANVAS' : `STEP ${step} OF ${total}`}
                                </span>
                            </div>
                            <div className="flex items-center gap-2">
                                {steps.map((s, idx) => (
                                    <React.Fragment key={s}>
                                        <div className={`progress-dot ${step >= s ? 'active' : ''}`} />
                                        {idx < steps.length - 1 && (
                                            <div className="flex-1 h-0.5 bg-gray-200">
                                                <div
                                                    className="h-full bg-black transition-all duration-300"
                                                    style={{ width: step > s ? '100%' : '0%' }}
                                                />
                                            </div>
                                        )}
                                    </React.Fragment>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            };

            const renderIntroPage = () => (
                <div className="min-h-screen bg-black text-white flex flex-col justify-center items-center p-8">
                    <div className="max-w-4xl w-full">
                        <h1 className="plaak text-9xl mb-16 text-center leading-none">
                            BEFORE WE START
                        </h1>

                        <div className="space-y-16">
                            <section>
                                <h2 className="plaak text-6xl mb-6">YOUR DETAILS</h2>
                                <div className="space-y-6 bg-white text-black p-8 rounded">
                                    <div>
                                        <label className="block text-sm font-bold mb-2">COMPANY ID *</label>
                                        <input
                                            type="text"
                                            className="worksheet-input"
                                            value={data.companyId}
                                            onChange={(e) => updateData('companyId', e.target.value)}
                                            placeholder="Enter your company identifier"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-bold mb-2">USERNAME ID *</label>
                                        <input
                                            type="text"
                                            className="worksheet-input"
                                            value={data.userId}
                                            onChange={(e) => updateData('userId', e.target.value)}
                                            placeholder="Enter your username"
                                        />
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2 className="plaak text-6xl mb-6" style={{color: '#fff469'}}>SPRINT INFO</h2>
                                <div className="space-y-4 text-xl leading-relaxed">
                                    <p>
                                        This sprint establishes <strong>Performance Analysis and Accountability Systems</strong> that
                                        align efforts with strategic goals through structured tracking and clear consequences.
                                    </p>
                                    <p className="mt-4">
                                        <strong>Individual Tools:</strong> 5 Whys (root cause analysis), 80/20 Principle (focus on vital few),
                                        Brainstorming & Impact-Easy Matrix, Accountability & Consequences Framework.
                                    </p>
                                    <p className="mt-4">
                                        <strong>Team Tools:</strong> Performance Analysis System setup and Accountability & Consequences System planning.
                                    </p>
                                </div>
                            </section>

                            <section>
                                <h2 className="plaak text-6xl mb-6" style={{color: '#fff469'}}>MISTAKES TO AVOID</h2>
                                <ul className="space-y-3 text-xl leading-relaxed list-disc list-inside">
                                    <li>Vague metrics - everything must be specific and measurable</li>
                                    <li>Stopping root cause analysis too soon - always reach the true cause</li>
                                    <li>Focusing on trivial many instead of vital few activities</li>
                                    <li>Inconsistent follow-up on accountability checkpoints</li>
                                    <li>Binary task tracking - tasks are done or not done, no "in progress"</li>
                                </ul>
                            </section>
                        </div>

                        <div className="flex justify-center gap-6 mt-16">
                            <button
                                onClick={() => setShowHelp(true)}
                                className="px-8 py-4 border-2 border-white text-white hover:bg-white hover:text-black transition-all text-lg font-bold"
                            >
                                HELP
                            </button>
                            <button
                                onClick={() => setStep(0.5)}
                                disabled={!data.companyId || !data.userId}
                                className="px-8 py-4 bg-white text-black hover:bg-gray-200 transition-all text-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                START SPRINT
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderChoicePage = () => (
                <div className="min-h-screen bg-black text-white flex flex-col justify-center items-center p-8">
                    <div className="max-w-4xl w-full text-center">
                        <h1 className="plaak text-6xl mb-8">CHOOSE YOUR PATH</h1>
                        <p className="text-2xl mb-16 text-gray-300">
                            Select individual process tools or team system planning
                        </p>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <button
                                onClick={() => {
                                    setToolType('individual');
                                    setStep(1);
                                }}
                                className="p-12 border-4 border-white hover:bg-white hover:text-black transition-all group"
                            >
                                <div className="plaak text-4xl mb-4">INDIVIDUAL TOOLS</div>
                                <p className="text-lg text-gray-300 group-hover:text-black">
                                    Apply 4 process tools: 5 Whys, 80/20 Principle, Impact-Easy Matrix, and Accountability Framework
                                </p>
                            </button>

                            <button
                                onClick={() => {
                                    setToolType('team');
                                    setStep(1);
                                }}
                                className="p-12 border-4 border-white hover:bg-white hover:text-black transition-all group"
                            >
                                <div className="plaak text-4xl mb-4">TEAM TOOLS</div>
                                <p className="text-lg text-gray-300 group-hover:text-black">
                                    Set up Performance Analysis System and Accountability & Consequences System for the team
                                </p>
                            </button>
                        </div>

                        <button
                            onClick={() => setStep(0)}
                            className="mt-12 px-8 py-4 border-2 border-white text-white hover:bg-white hover:text-black transition-all"
                        >
                            ← BACK
                        </button>
                    </div>
                </div>
            );

            // Individual Tool Steps
            const renderStep1_FiveWhys = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="numbered-section">[01] THE 5 WHYS</div>

                        {/* Fast Track Insight */}
                        <FastTrackInsight>
                            [PLACEHOLDER] Fast Track Principle for Performance Tracking: This foundational step drives 80% of results. Leaders who invest proper time here see the biggest transformation in their organization.
                        </FastTrackInsight>

                        {/* The Science */}
                        <ScienceBox collapsible={true}>
                            [PLACEHOLDER] Research from organizational psychology shows that structured performance tracking frameworks improve decision quality by 25-40% compared to unstructured approaches (Harvard Business Review, 2023). Writing responses down activates deeper cognitive processing than thinking alone.
                        </ScienceBox>

                        {/* Common Mistake */}
                        <WarningBox>
                            [PLACEHOLDER] Common mistake in Performance Tracking: Leaders often rush through this with surface-level answers. <strong>Bad:</strong> Generic responses completed in under 5 minutes. <strong>Good:</strong> Specific, honest answers that require real thought and sometimes discomfort.
                        </WarningBox>


                        <p className="text-xl mb-8 text-gray-700">
                            Uncover the root cause of problems through iterative questioning. Ask "Why?" five times to drill down from symptoms to true causes.
                        </p>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Define the Problem</label>
                            <ScienceBookmarkIcon>
                                [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of performance tracking leads to significantly better outcomes than intuitive approaches alone.
                            </ScienceBookmarkIcon>
                            <p className="text-gray-700 mb-4">What is the specific issue you're experiencing?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.fiveWhys.problem}
                                onChange={(e) => updateData('fiveWhys.problem', e.target.value)}
                                placeholder="Example: Our delivery times are consistently delayed..."
                            />
                        </div>

                        <div className="space-y-6">
                            {[1, 2, 3, 4, 5].map(num => (
                                <div key={num} className="mb-6">
                                    <label className="block text-lg font-bold mb-2">WHY #{num}</label>
                                    <ScienceBookmarkIcon>
                                        [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of performance tracking leads to significantly better outcomes than intuitive approaches alone.
                                    </ScienceBookmarkIcon>
                                    <input
                                        type="text"
                                        className="worksheet-input"
                                        value={data.fiveWhys[`why${num}`]}
                                        onChange={(e) => updateData(`fiveWhys.why${num}`, e.target.value)}
                                        placeholder={`Why does this happen? (${num === 1 ? 'immediate reason' : 'dig deeper'})`}
                                    />
                                </div>
                            ))}
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Root Cause Identified</label>
                            <ScienceBookmarkIcon>
                                [PLACEHOLDER] Research backs this: Studies show that structured reflection on this aspect of performance tracking leads to significantly better outcomes than intuitive approaches alone.
                            </ScienceBookmarkIcon>
                            <p className="text-gray-700 mb-4">What is the fundamental cause that emerged from your analysis?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.fiveWhys.rootCause}
                                onChange={(e) => updateData('fiveWhys.rootCause', e.target.value)}
                                placeholder="State the root cause clearly and specifically..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Solution to Address Root Cause</label>
                            <p className="text-gray-700 mb-4">What specific actions will eliminate this root cause?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.fiveWhys.solution}
                                onChange={(e) => updateData('fiveWhys.solution', e.target.value)}
                                placeholder="Example: Implement a structured onboarding program with mentorship..."
                            />
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(0.5)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK
                            </button>
                            <button
                                onClick={() => setStep(2)}
                                className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                            >
                                NEXT STEP →
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderStep2_Eighty20 = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="numbered-section">[02] THE 80/20 PRINCIPLE</div>

                        {/* Fast Track Insight */}
                        <FastTrackInsight>
                            [PLACEHOLDER] Fast Track Insight: The second phase of Performance Tracking is where most leaders see breakthroughs. Be specific and brutally honest in your answers here.
                        </FastTrackInsight>

                        {/* The Science */}
                        <ScienceBox collapsible={true}>
                            [PLACEHOLDER] Behavioral science research indicates that teams using systematic performance tracking processes make decisions 2.5x faster with 30% fewer errors (McKinsey, 2022). The structure reduces cognitive bias and forces comprehensive thinking.
                        </ScienceBox>


                        <p className="text-xl mb-8 text-gray-700">
                            Focus on the vital few that drive 80% of results. Identify which 20% of your efforts yield 80% of outcomes.
                        </p>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Define Your Objective</label>
                            <p className="text-gray-700 mb-4">What result are you aiming to achieve?</p>
                            <input
                                type="text"
                                className="worksheet-input"
                                value={data.eighty20.objective}
                                onChange={(e) => updateData('eighty20.objective', e.target.value)}
                                placeholder="Example: Increase sales revenue, improve customer satisfaction..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Identify All Contributing Inputs</label>
                            <p className="text-gray-700 mb-4">List all factors contributing to this outcome</p>
                            {[0, 1, 2, 3, 4].map(idx => (
                                <input
                                    key={idx}
                                    type="text"
                                    className="worksheet-input mb-3"
                                    value={data.eighty20.inputs[idx]}
                                    onChange={(e) => updateArrayItem('eighty20.inputs', idx, e.target.value)}
                                    placeholder={`Input ${idx + 1}: e.g., Customer segments, sales channels, product lines...`}
                                />
                            ))}
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Rank by Impact</label>
                            <p className="text-gray-700 mb-4">Which inputs deliver the most significant results? Use data to support your ranking.</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.eighty20.ranking}
                                onChange={(e) => updateData('eighty20.ranking', e.target.value)}
                                placeholder="Example: Analysis shows 80% of revenue comes from 20% of customers (Enterprise accounts)..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2 text-black">Focus on the VITAL FEW (The 20%)</label>
                            <p className="text-gray-700 mb-4">What high-impact activities will you prioritize and enhance?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.eighty20.vitalFew}
                                onChange={(e) => updateData('eighty20.vitalFew', e.target.value)}
                                placeholder="Describe how you'll optimize these critical inputs..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2 text-red-700">Eliminate/Automate the TRIVIAL MANY (The 80%)</label>
                            <p className="text-gray-700 mb-4">What low-impact activities will you stop, reduce, or automate?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.eighty20.trivialMany}
                                onChange={(e) => updateData('eighty20.trivialMany', e.target.value)}
                                placeholder="Example: Automate invoicing for low-spending clients, reduce time on low-ROI marketing channels..."
                            />
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(1)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK
                            </button>
                            <button
                                onClick={() => setStep(3)}
                                className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                            >
                                NEXT STEP →
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderStep3_ImpactEasy = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="numbered-section">[03] BRAINSTORMING & IMPACT-EASY</div>

                        {/* Fast Track Insight */}
                        <FastTrackInsight>
                            [PLACEHOLDER] Fast Track Advanced: This Performance Tracking step connects your work to the broader strategy. Look for patterns across your previous answers.
                        </FastTrackInsight>

                        {/* The Science */}
                        <ScienceBox collapsible={true}>
                            [PLACEHOLDER] Meta-analysis of 200+ organizations shows that completing structured exercises like this correlates with 35% higher strategic execution rates (Deloitte, 2023). Written commitments create psychological accountability.
                        </ScienceBox>


                        <p className="text-xl mb-8 text-gray-700">
                            Generate ideas and prioritize them using the Impact-Easy Matrix
                        </p>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Define Clear Objective</label>
                            <input
                                type="text"
                                className="worksheet-input"
                                value={data.impactEasy.objective}
                                onChange={(e) => updateData('impactEasy.objective', e.target.value)}
                                placeholder="What problem or opportunity are you addressing?"
                            />
                        </div>

                        <div className="mb-8">
                            <h2 className="text-2xl font-bold mb-4">Brainstorm Ideas</h2>
                            <p className="text-gray-700 mb-4">List all possible solutions without judgment</p>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {data.impactEasy.ideas.map((idea, idx) => (
                                    <input
                                        key={idx}
                                        type="text"
                                        className="worksheet-input"
                                        value={idea}
                                        onChange={(e) => updateArrayItem('impactEasy.ideas', idx, e.target.value)}
                                        placeholder={`Idea ${idx + 1}`}
                                    />
                                ))}
                            </div>
                        </div>

                        <div className="mb-8">
                            <h2 className="text-2xl font-bold mb-4">Impact-Easy Matrix</h2>
                            <p className="text-gray-700 mb-6">Categorize each idea by its impact and ease of implementation</p>

                            <div className="grid grid-cols-2 gap-4">
                                <div className="border-2 border-black bg-gray-50 p-4 rounded">
                                    <h3 className="font-bold mb-2 text-black">HIGH IMPACT / EASY</h3>
                                    <p className="text-sm text-black mb-3">Quick wins - do these first!</p>
                                    {data.impactEasy.matrix.highImpactEasy.map((idea, idx) => (
                                        <div key={idx} className="bg-white p-2 mb-2 rounded border">{idea}</div>
                                    ))}
                                    <select
                                        className="worksheet-input mt-2 text-sm"
                                        onChange={(e) => {
                                            if (e.target.value) {
                                                moveIdeaToQuadrant(e.target.value, 'highImpactEasy');
                                                e.target.value = '';
                                            }
                                        }}
                                    >
                                        <option value="">+ Add idea...</option>
                                        {data.impactEasy.ideas.filter(i => i.trim()).map((idea, idx) => (
                                            <option key={idx} value={idea}>{idea}</option>
                                        ))}
                                    </select>
                                </div>

                                <div className="border-2 border-yellow-500 bg-yellow-50 p-4 rounded">
                                    <h3 className="font-bold mb-2 text-yellow-800">HIGH IMPACT / HARD</h3>
                                    <p className="text-sm text-yellow-700 mb-3">Plan and allocate resources</p>
                                    {data.impactEasy.matrix.highImpactHard.map((idea, idx) => (
                                        <div key={idx} className="bg-white p-2 mb-2 rounded border">{idea}</div>
                                    ))}
                                    <select
                                        className="worksheet-input mt-2 text-sm"
                                        onChange={(e) => {
                                            if (e.target.value) {
                                                moveIdeaToQuadrant(e.target.value, 'highImpactHard');
                                                e.target.value = '';
                                            }
                                        }}
                                    >
                                        <option value="">+ Add idea...</option>
                                        {data.impactEasy.ideas.filter(i => i.trim()).map((idea, idx) => (
                                            <option key={idx} value={idea}>{idea}</option>
                                        ))}
                                    </select>
                                </div>

                                <div className="border-2 border-gray-400 bg-gray-50 p-4 rounded">
                                    <h3 className="font-bold mb-2 text-gray-800">LOW IMPACT / EASY</h3>
                                    <p className="text-sm text-gray-700 mb-3">Fill time gaps</p>
                                    {data.impactEasy.matrix.lowImpactEasy.map((idea, idx) => (
                                        <div key={idx} className="bg-white p-2 mb-2 rounded border">{idea}</div>
                                    ))}
                                    <select
                                        className="worksheet-input mt-2 text-sm"
                                        onChange={(e) => {
                                            if (e.target.value) {
                                                moveIdeaToQuadrant(e.target.value, 'lowImpactEasy');
                                                e.target.value = '';
                                            }
                                        }}
                                    >
                                        <option value="">+ Add idea...</option>
                                        {data.impactEasy.ideas.filter(i => i.trim()).map((idea, idx) => (
                                            <option key={idx} value={idea}>{idea}</option>
                                        ))}
                                    </select>
                                </div>

                                <div className="border-2 border-red-500 bg-red-50 p-4 rounded">
                                    <h3 className="font-bold mb-2 text-red-800">LOW IMPACT / HARD</h3>
                                    <p className="text-sm text-red-700 mb-3">Avoid or defer</p>
                                    {data.impactEasy.matrix.lowImpactHard.map((idea, idx) => (
                                        <div key={idx} className="bg-white p-2 mb-2 rounded border">{idea}</div>
                                    ))}
                                    <select
                                        className="worksheet-input mt-2 text-sm"
                                        onChange={(e) => {
                                            if (e.target.value) {
                                                moveIdeaToQuadrant(e.target.value, 'lowImpactHard');
                                                e.target.value = '';
                                            }
                                        }}
                                    >
                                        <option value="">+ Add idea...</option>
                                        {data.impactEasy.ideas.filter(i => i.trim()).map((idea, idx) => (
                                            <option key={idx} value={idea}>{idea}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(2)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK
                            </button>
                            <button
                                onClick={() => setStep(4)}
                                className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                            >
                                NEXT STEP →
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderStep4_Accountability = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="numbered-section">[04] ACCOUNTABILITY & CONSEQUENCES</div>

                        {/* Fast Track Insight */}
                        <FastTrackInsight>
                            [PLACEHOLDER] Fast Track Integration: At this stage of Performance Tracking, synthesis matters most. Your outputs should connect to at least 2 other Fast Track tools.
                        </FastTrackInsight>

                        {/* The Science */}
                        <ScienceBox collapsible={true}>
                            [PLACEHOLDER] Longitudinal studies demonstrate that organizations revisiting their performance tracking outputs quarterly maintain 60% higher alignment scores (BCG, 2023). Regular review prevents strategic drift.
                        </ScienceBox>


                        <p className="text-xl mb-8 text-gray-700">
                            Build a clear accountability system with transparent expectations and fair consequences
                        </p>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Define Expectations</label>
                            <p className="text-gray-700 mb-4">Clearly articulate roles, tasks, and goals. What are the specific, measurable responsibilities?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountability.expectations}
                                onChange={(e) => updateData('accountability.expectations', e.target.value)}
                                placeholder="Example: Sales manager must close $50K in monthly revenue with 15% margin..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Assign Ownership</label>
                            <p className="text-gray-700 mb-4">Who is ultimately responsible for each deliverable? (Single owner per task)</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountability.ownership}
                                onChange={(e) => updateData('accountability.ownership', e.target.value)}
                                placeholder="List key deliverables and their owners..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Set Checkpoints</label>
                            <p className="text-gray-700 mb-4">When and how will performance be evaluated? Establish regular review points.</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountability.checkpoints}
                                onChange={(e) => updateData('accountability.checkpoints', e.target.value)}
                                placeholder="Example: Weekly Monday 9am meeting to review task completion; Monthly performance reviews..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Consequences Framework</label>
                            <p className="text-gray-700 mb-4">What happens when goals are met or missed?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountability.consequences}
                                onChange={(e) => updateData('accountability.consequences', e.target.value)}
                                placeholder="Define both positive and corrective consequences..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2 text-black">Rewards for Success</label>
                            <p className="text-gray-700 mb-4">What meaningful rewards reinforce achievement?</p>
                            <input
                                type="text"
                                className="worksheet-input"
                                value={data.accountability.rewards}
                                onChange={(e) => updateData('accountability.rewards', e.target.value)}
                                placeholder="Example: Bonus for exceeding KPIs, recognition in team meetings, career advancement..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2 text-red-700">Corrective Actions for Gaps</label>
                            <p className="text-gray-700 mb-4">What fair, constructive actions address underperformance?</p>
                            <input
                                type="text"
                                className="worksheet-input"
                                value={data.accountability.corrective}
                                onChange={(e) => updateData('accountability.corrective', e.target.value)}
                                placeholder="Example: Training sessions, mentorship pairing, performance improvement plan..."
                            />
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(3)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK
                            </button>
                            <button
                                onClick={() => setStep(999)}
                                className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                            >
                                VIEW CANVAS →
                            </button>
                        </div>
                    </div>
                </div>
            );

            // Team Tool Steps
            const renderTeamStep1_PerformanceSystem = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="numbered-section">[01] PERFORMANCE ANALYSIS SYSTEM</div>

                        {/* Fast Track Insight */}
                        <FastTrackInsight>
                            [PLACEHOLDER] Fast Track Completion: The final step ties everything together. Review your Performance Tracking work holistically before moving on.
                        </FastTrackInsight>

                        {/* The Science */}
                        <ScienceBox collapsible={true}>
                            [PLACEHOLDER] Cross-industry research confirms that structured frameworks reduce implementation time by 40% while improving quality of outcomes across all organizational levels (Bain, 2023).
                        </ScienceBox>


                        <p className="text-xl mb-8 text-gray-700">
                            Set up a system to track task completion, identify gaps, and drive continuous improvement
                        </p>

                        <div className="mb-8">
                            <div className="dashboard-metric">
                                <div className="metric-value">{calculateCompletionRate()}%</div>
                                <div className="metric-label">Task Completion Rate</div>
                            </div>
                        </div>

                        <div className="mb-8">
                            <h2 className="text-2xl font-bold mb-4">Task Tracking (Binary: Done / Not Done)</h2>
                            <p className="text-gray-700 mb-4">Track 5 key tasks from last week</p>

                            {data.performanceSystem.tasks.map((task, idx) => (
                                <div key={idx} className="mb-6 p-4 border-2 border-gray-200 rounded">
                                    <div className="task-row">
                                        <input
                                            type="text"
                                            className="worksheet-input"
                                            value={task.task}
                                            onChange={(e) => updateTaskField(idx, 'task', e.target.value)}
                                            placeholder={`Task ${idx + 1}`}
                                        />
                                        <select
                                            className="worksheet-input"
                                            value={task.status}
                                            onChange={(e) => updateTaskField(idx, 'status', e.target.value)}
                                        >
                                            <option value="not-done">Not Done</option>
                                            <option value="done">Done</option>
                                        </select>
                                        <input
                                            type="text"
                                            className="worksheet-input"
                                            value={task.owner}
                                            onChange={(e) => updateTaskField(idx, 'owner', e.target.value)}
                                            placeholder="Owner"
                                        />
                                    </div>
                                    {task.status === 'not-done' && (
                                        <input
                                            type="text"
                                            className="worksheet-input mt-3"
                                            value={task.reason}
                                            onChange={(e) => updateTaskField(idx, 'reason', e.target.value)}
                                            placeholder="If not done, why? (Root cause analysis)"
                                        />
                                    )}
                                </div>
                            ))}
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Dashboard Metrics Design</label>
                            <p className="text-gray-700 mb-4">What key metrics will your team dashboard track?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.performanceSystem.dashboardMetrics}
                                onChange={(e) => updateData('performanceSystem.dashboardMetrics', e.target.value)}
                                placeholder="Example: Task completion rate, goal progress %, blockers identified, team velocity..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Review Cadence</label>
                            <p className="text-gray-700 mb-4">When and how often will the team review performance?</p>
                            <input
                                type="text"
                                className="worksheet-input"
                                value={data.performanceSystem.reviewCadence}
                                onChange={(e) => updateData('performanceSystem.reviewCadence', e.target.value)}
                                placeholder="Example: Weekly Monday 9am, Monthly deep dive first Friday..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Continuous Improvement Actions</label>
                            <p className="text-gray-700 mb-4">Based on patterns, what improvements will you implement?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.performanceSystem.improvements}
                                onChange={(e) => updateData('performanceSystem.improvements', e.target.value)}
                                placeholder="Identify recurring bottlenecks and improvement actions with WHO-WHAT-WHEN..."
                            />
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(0.5)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK
                            </button>
                            <button
                                onClick={() => setStep(2)}
                                className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                            >
                                NEXT STEP →
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderTeamStep2_AccountabilitySystem = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="numbered-section">[02] ACCOUNTABILITY & CONSEQUENCES SYSTEM</div>

                        <p className="text-xl mb-8 text-gray-700">
                            Plan a team-wide system ensuring clear ownership, consistent follow-up, and structured consequences
                        </p>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Roles & Responsibilities Clarity</label>
                            <p className="text-gray-700 mb-4">How will you ensure every team member knows their specific, measurable responsibilities?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountabilitySystem.roles}
                                onChange={(e) => updateData('accountabilitySystem.roles', e.target.value)}
                                placeholder="Describe the process for defining and communicating roles (e.g., role charters, RACI matrix)..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Consequences Framework</label>
                            <p className="text-gray-700 mb-4">Define both rewards for achievement and corrective actions for gaps</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountabilitySystem.framework}
                                onChange={(e) => updateData('accountabilitySystem.framework', e.target.value)}
                                placeholder="Example: Bonus structure, recognition program, performance improvement plans, escalation process..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Transparency & Communication</label>
                            <p className="text-gray-700 mb-4">How will you ensure the system is transparent and all team members understand it?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountabilitySystem.transparency}
                                onChange={(e) => updateData('accountabilitySystem.transparency', e.target.value)}
                                placeholder="Example: One-pager during onboarding, dashboard visible to all, open Q&A sessions..."
                            />
                        </div>

                        <div className="mb-8">
                            <label className="block text-lg font-bold mb-2">Implementation Timeline</label>
                            <p className="text-gray-700 mb-4">WHO will do WHAT by WHEN to launch this system?</p>
                            <textarea
                                className="worksheet-textarea"
                                value={data.accountabilitySystem.timeline}
                                onChange={(e) => updateData('accountabilitySystem.timeline', e.target.value)}
                                placeholder="Create specific action plan with owners and deadlines..."
                            />
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(1)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK
                            </button>
                            <button
                                onClick={() => setStep(999)}
                                className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                            >
                                VIEW CANVAS →
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderCanvas = () => (
                <div className="min-h-screen bg-white pt-24 pb-16 px-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="numbered-section mb-8">CANVAS: PERFORMANCE & ACCOUNTABILITY</div>

                        <div className="bg-gray-50 p-8 rounded-lg mb-8">
                            <div className="grid grid-cols-2 gap-4 text-sm mb-6">
                                <div><strong>Company:</strong> {data.companyId}</div>
                                <div><strong>User:</strong> {data.userId}</div>
                                <div><strong>Type:</strong> {toolType === 'individual' ? 'Individual Process Tools' : 'Team Systems'}</div>
                                <div><strong>Date:</strong> {new Date().toLocaleDateString()}</div>
                            </div>

                            {toolType === 'individual' ? (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div className="bg-white p-6 rounded border-2">
                                        <h3 className="font-bold text-lg mb-3">5 Whys Analysis</h3>
                                        <p className="text-sm"><strong>Problem:</strong> {data.fiveWhys.problem || 'Not defined'}</p>
                                        <p className="text-sm"><strong>Root Cause:</strong> {data.fiveWhys.rootCause || 'Not identified'}</p>
                                    </div>
                                    <div className="bg-white p-6 rounded border-2">
                                        <h3 className="font-bold text-lg mb-3">80/20 Principle</h3>
                                        <p className="text-sm"><strong>Objective:</strong> {data.eighty20.objective || 'Not defined'}</p>
                                        <p className="text-sm"><strong>Vital Few:</strong> {data.eighty20.vitalFew ? 'Identified' : 'Not identified'}</p>
                                    </div>
                                    <div className="bg-white p-6 rounded border-2">
                                        <h3 className="font-bold text-lg mb-3">Impact-Easy Matrix</h3>
                                        <p className="text-sm">Quick Wins: {data.impactEasy.matrix.highImpactEasy.length} ideas</p>
                                        <p className="text-sm">Major Projects: {data.impactEasy.matrix.highImpactHard.length} ideas</p>
                                    </div>
                                    <div className="bg-white p-6 rounded border-2">
                                        <h3 className="font-bold text-lg mb-3">Accountability Framework</h3>
                                        <p className="text-sm">{data.accountability.expectations ? 'Expectations defined' : 'Not defined'}</p>
                                        <p className="text-sm">{data.accountability.consequences ? 'Consequences framework created' : 'Not created'}</p>
                                    </div>
                                </div>
                            ) : (
                                <div className="space-y-6">
                                    <div className="dashboard-metric">
                                        <div className="metric-value">{calculateCompletionRate()}%</div>
                                        <div className="metric-label">Task Completion Rate</div>
                                    </div>
                                    <div className="bg-white p-6 rounded border-2">
                                        <h3 className="font-bold text-lg mb-3">Performance Analysis System</h3>
                                        <p className="text-sm">Dashboard metrics: {data.performanceSystem.dashboardMetrics ? 'Defined' : 'Pending'}</p>
                                        <p className="text-sm">Review cadence: {data.performanceSystem.reviewCadence || 'Not set'}</p>
                                    </div>
                                    <div className="bg-white p-6 rounded border-2">
                                        <h3 className="font-bold text-lg mb-3">Accountability System</h3>
                                        <p className="text-sm">Framework: {data.accountabilitySystem.framework ? 'Established' : 'Pending'}</p>
                                        <p className="text-sm">Timeline: {data.accountabilitySystem.timeline ? 'Created' : 'Pending'}</p>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="flex justify-between">
                            <button
                                onClick={() => setStep(toolType === 'individual' ? 4 : 2)}
                                className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                            >
                                ← BACK TO TOOL
                            </button>
                            <div className="flex gap-4">
                                <button
                                    onClick={exportPDF}
                                    className="px-6 py-3 border-2 border-black hover:bg-black hover:text-white transition-all font-bold"
                                >
                                    Export PDF
                                </button>
                                <button
                                    onClick={handleSubmit}
                                    disabled={submitStatus === 'saving'}
                                    className="px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                                >
                                    {submitStatus === 'saving' ? 'AI Coach Reviewing...' : 'Final Submit'}
                                </button>
                            </div>
                        </div>
                        {submitStatus && submitMessage && (
                            <div style={{ marginTop: 16, padding: '12px 16px', textAlign: 'center', background: submitStatus === 'success' ? '#f0fdf4' : submitStatus === 'error' ? '#fef2f2' : '#f5f5f5', border: `1px solid ${submitStatus === 'success' ? '#bbf7d0' : submitStatus === 'error' ? '#fecaca' : '#e0e0e0'}`, fontSize: 14 }}>
                                <span style={{ color: submitStatus === 'success' ? '#166534' : submitStatus === 'error' ? '#991b1b' : '#333' }}>{submitMessage}</span>
                            </div>
                        )}

                        {/* Case Study */}
                        <CaseStudy
                            before={"[PLACEHOLDER] Performance reviews happened annually."}
                            after={"[PLACEHOLDER] Weekly 15-minute check-ins. Problems caught within days."}
                            quote={"[PLACEHOLDER] The accountability framework removed emotion from difficult conversations."}
                        />
                    </div>
                </div>
            );

            const renderHelpModal = () => {
                if (!showHelp) return null;

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                            <div className="p-8 border-8 border-black">
                                <h2 className="plaak text-4xl mb-6">HELP & GUIDANCE</h2>

                                <div className="space-y-6">
                                    <section>
                                        <h3 className="font-bold text-xl mb-2">About This Sprint</h3>
                                        <p className="text-gray-700">
                                            Sprint 10 establishes performance tracking and accountability systems that align
                                            efforts with strategic goals through structured measurement and clear consequences.
                                        </p>
                                    </section>

                                    <section>
                                        <h3 className="font-bold text-xl mb-2">Individual Process Tools</h3>
                                        <ol className="list-decimal list-inside text-gray-700 space-y-1">
                                            <li><strong>5 Whys:</strong> Root cause analysis through iterative questioning</li>
                                            <li><strong>80/20 Principle:</strong> Focus on vital few, eliminate trivial many</li>
                                            <li><strong>Impact-Easy Matrix:</strong> Prioritize ideas by impact and ease</li>
                                            <li><strong>Accountability Framework:</strong> Clear expectations and consequences</li>
                                        </ol>
                                    </section>

                                    <section>
                                        <h3 className="font-bold text-xl mb-2">Team Systems</h3>
                                        <ul className="list-disc list-inside text-gray-700 space-y-1">
                                            <li><strong>Performance Analysis:</strong> Binary task tracking (done/not done)</li>
                                            <li><strong>Accountability System:</strong> Roles, framework, transparency, timeline</li>
                                        </ul>
                                    </section>

                                    <section>
                                        <h3 className="font-bold text-xl mb-2">Key Principles</h3>
                                        <ul className="list-disc list-inside text-gray-700 space-y-1">
                                            <li>All metrics must be specific and measurable</li>
                                            <li>Tasks are binary: done or not done (no "in progress")</li>
                                            <li>Always identify root causes, not just symptoms</li>
                                            <li>Dashboards provide transparency and alignment</li>
                                        </ul>
                                    </section>
                                </div>

                                <button
                                    onClick={() => setShowHelp(false)}
                                    className="mt-8 w-full px-6 py-3 bg-black text-white hover:bg-gray-800 transition-all font-bold"
                                >
                                    CLOSE
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-white">
                    {renderProgressIndicator()}

                    {step === 0 && renderIntroPage()}
                    {step === 0.5 && renderChoicePage()}

                    {/* Individual Tool Steps */}
                    {toolType === 'individual' && step === 1 && renderStep1_FiveWhys()}
                    {toolType === 'individual' && step === 2 && renderStep2_Eighty20()}
                    {toolType === 'individual' && step === 3 && renderStep3_ImpactEasy()}
                    {toolType === 'individual' && step === 4 && renderStep4_Accountability()}

                    {/* Team Tool Steps */}
                    {toolType === 'team' && step === 1 && renderTeamStep1_PerformanceSystem()}
                    {toolType === 'team' && step === 2 && renderTeamStep2_AccountabilitySystem()}

                    {/* Canvas */}
                    {step === 999 && renderCanvas()}

                    {renderHelpModal()}
                </div>
            );
        }
        ReactDOM.render(<PerformanceApp />, document.getElementById('root'));
    </script>
</body>
</html>
