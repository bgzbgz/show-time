<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Value Proposition Testing | Fast Track Program</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="../../shared/js/tool-db.js"></script>
  <script src="../../shared/js/ai-challenge.js"></script>
  <script src="../../shared/js/dependency-injection.js"></script>
  <link rel="stylesheet" href="../../shared/css/cognitive-load.css">
  <script src="../../shared/js/cognitive-load.js"></script>
  <script src="../../js/tool-access-control.js"></script>
  <script src="../../shared/js/transition-screen.js"></script>

  <style>
    /* === FONT FACES === */
    @font-face { font-family: 'Plaak'; src: url('Plaak3Trial-43-Bold.woff2') format('woff2'); font-weight: bold; }
    @font-face { font-family: 'Riforma'; src: url('RiformaLL-Regular.woff2') format('woff2'); font-weight: normal; }
    @font-face { font-family: 'Riforma'; src: url('RiformaLL-Regular.woff2') format('woff2'); font-weight: 600; }
    @font-face { font-family: 'Monument'; src: url('MonumentGrotesk-Mono.woff2') format('woff2'); }

    /* === BASE RESET === */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Riforma', -apple-system, sans-serif;
      font-size: 16px;
      color: #000;
      background: #000;
      -webkit-font-smoothing: antialiased;
    }

    /* === CUSTOM SCROLLBAR === */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #000; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #333; }
    * { scrollbar-width: thin; scrollbar-color: #000 transparent; }

    /* === TYPOGRAPHY HELPERS === */
    .plaak { font-family: 'Plaak', sans-serif; font-weight: bold; letter-spacing: -0.01em; line-height: 1.2; }
    .monument { font-family: 'Monument', monospace; letter-spacing: 0.05em; }

    /* === LAYOUT FRAME === */
    .tool-frame { background: #fff; min-height: 100vh; }
    .tool-inner { background: #fff; min-height: 100vh; }

    /* === WIZARD LAYOUT === */
    .wizard-layout { display: flex; min-height: 100vh; }
    .wizard-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      background: #fff;
    }
    .wizard-content { flex: 1; padding: 48px 32px; max-width: 720px; width: 100%; margin: 0 auto; }

    /* === SIDEBAR === */
    .wizard-sidebar { width: 280px; background: #1a1a1a; min-height: 100vh; padding: 48px 32px; display: flex; flex-direction: column; position: sticky; top: 0; align-self: flex-start; height: 100vh; overflow-y: auto; }
    .wizard-sidebar-inner {
      padding: 32px 24px;
      height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
    }
    .sidebar-step-item {
      padding: 12px;
      margin-bottom: 8px;
      border-left: 3px solid transparent;
      transition: all 0.2s ease;
    }
    .sidebar-step-item.active { border-left-color: #FFF469; background: #222; }
    .sidebar-step-item.completed { background: #fff; color: #000; border-left-color: #fff; cursor: pointer; }
    .sidebar-step-item.completed:hover { background: #E0E0E0; }
    .sidebar-step-item.locked { opacity: 0.5; }
    .sidebar-step-item .step-num { font-family: 'Riforma', sans-serif; font-size: 14px; }
    .sidebar-step-item .step-name { font-family: 'Riforma', sans-serif; font-size: 14px; }
    .sidebar-snippet { font-size: 12px; margin-top: 4px; opacity: 0.7; line-height: 1.3; }

    /* === STEP HEADER === */
    .step-indicator {
      font-family: 'Monument', monospace;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #6B7280;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .step-heading {
      font-family: 'Plaak', sans-serif;
      font-weight: bold;
      font-size: 32px;
      text-transform: uppercase;
      letter-spacing: -0.01em;
      line-height: 1.2;
      color: #000;
      margin-bottom: 6px;
    }
    .step-hint {
      font-size: 16px;
      color: #6B7280;
      line-height: 1.5;
      margin: 0 0 32px 0;
    }
    .opening-box { margin-bottom: 32px; }

    /* === FORM ELEMENTS === */
    .field-label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: 'Monument', monospace;
      font-size: 14px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #000;
      margin-bottom: 8px;
    }
    .field-input {
      width: 100%;
      height: 44px;
      padding: 8px 16px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      color: #000;
      background: #fff;
      border: 1px solid #E5E7EB;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .field-input:focus {
      outline: none;
      border-color: #000;
      box-shadow: 0 0 0 3px #FFF469;
    }
    .field-textarea {
      width: 100%;
      min-height: 120px;
      padding: 12px 16px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      color: #000;
      background: #fff;
      border: 1px solid #E5E7EB;
      resize: none !important;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .field-textarea:focus {
      outline: none;
      border-color: #000;
      box-shadow: 0 0 0 3px #FFF469;
    }
    .field-help {
      font-size: 14px;
      color: #6B7280;
      margin-top: 4px;
      line-height: 1.5;
    }
    .field-group { margin-bottom: 24px; }
    .field-group:last-child { margin-bottom: 0; }

    /* === LEARN MORE === */
    .learn-more-toggle {
      font-family: 'Monument', monospace;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #000;
      background: #F3F4F6;
      border: 1px solid #E5E7EB;
      cursor: pointer;
      padding: 10px 14px;
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 32px;
      transition: background 0.15s ease;
    }
    .learn-more-toggle:hover { background: #E5E7EB; }
    .learn-more-content {
      border-left: 3px solid #000;
      background: #F3F4F6;
      padding: 16px 20px;
      margin-bottom: 24px;
      font-size: 14px;
      color: #374151;
      line-height: 1.7;
    }

    /* === YELLOW INSIGHT BOX === */
    .ft-insight {
      background: #FFF469;
      border: 3px solid #000;
      padding: 16px;
      margin-bottom: 32px;
    }

    /* === CLOSING MESSAGE === */
    .closing-box {
      border-top: 1px solid #E5E7EB;
      padding: 20px 0 0 0;
      margin-top: 8px;
      text-align: center;
    }
    .closing-box p { font-size: 14px; color: #6B7280; }

    /* === BUTTON FOOTER === */
    .btn-footer {
      position: sticky;
      bottom: 0;
      z-index: 10;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 32px;
      border-top: 1px solid #E5E7EB;
      background: #fff;
      width: 100%;
    }
    .btn-back {
      background: #fff;
      color: #000;
      border: 2px solid #000;
      padding: 12px 24px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 44px;
    }
    .btn-back:hover { background: #F3F4F6; }
    .btn-next {
      background: #000;
      color: #fff;
      border: 2px solid #000;
      padding: 12px 24px;
      font-family: 'Riforma', sans-serif;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      min-height: 44px;
    }
    .btn-next:hover:not(:disabled) { transform: scale(1.02); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .btn-next:disabled { background: #E5E7EB; color: #9CA3AF; border-color: #E5E7EB; cursor: not-allowed; }

    /* === DOT NAV === */
    .dot-nav { display: flex; gap: 8px; align-items: center; justify-content: center; margin-bottom: 24px; }
    .dot-nav-dot { width: 10px; height: 10px; border-radius: 50%; border: 2px solid #000; background: #fff; cursor: pointer; transition: all 0.2s; }
    .dot-nav-dot.active { background: #000; }
    .dot-nav-dot.filled { background: #4ade80; border-color: #4ade80; }

    /* === MOBILE === */
    .mobile-step-bar { display: none; padding: 12px 16px; border-bottom: 1px solid #E5E7EB; background: #F3F4F6; }
    .mobile-step-bar .bar-text { font-family: 'Monument', monospace; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em; color: #6B7280; margin-bottom: 6px; }
    .mobile-progress { height: 3px; background: #E5E7EB; width: 100%; }
    .mobile-progress-fill { height: 100%; background: #000; transition: width 0.3s ease; }

    /* === INTERVIEW CARD === */
    .interview-card { border: 1px solid #E5E7EB; padding: 20px; margin-bottom: 16px; }
    .interview-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .interview-card-num { font-family: 'Monument', monospace; font-size: 12px; color: #6B7280; text-transform: uppercase; letter-spacing: 0.05em; }
    .btn-remove { background: none; border: 1px solid #DC2626; color: #DC2626; padding: 4px 10px; font-size: 12px; cursor: pointer; font-family: 'Monument', monospace; }
    .btn-remove:hover { background: #DC2626; color: #fff; }
    .btn-add { background: #F3F4F6; border: 1px dashed #9CA3AF; padding: 12px; width: 100%; cursor: pointer; font-family: 'Monument', monospace; font-size: 12px; text-transform: uppercase; letter-spacing: 0.05em; color: #6B7280; transition: all 0.2s; }
    .btn-add:hover { background: #E5E7EB; border-color: #000; color: #000; }

    /* === VALIDATION ITEM === */
    .validation-item { padding: 16px 0; border-bottom: 1px solid #E5E7EB; }
    .validation-item:last-child { border-bottom: none; }
    .validation-q { font-size: 15px; font-weight: 600; margin-bottom: 8px; }
    .validation-radios { display: flex; gap: 16px; }
    .validation-radios label { display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 14px; }

    /* === CANVAS === */
    .canvas-section { margin-bottom: 32px; }
    .canvas-section-title { font-family: 'Monument', monospace; font-size: 12px; text-transform: uppercase; letter-spacing: 0.05em; color: #6B7280; border-bottom: 2px solid #000; padding-bottom: 8px; margin-bottom: 16px; }
    .canvas-stat { text-align: center; background: #F3F4F6; padding: 20px; }
    .canvas-stat-num { font-family: 'Plaak', sans-serif; font-size: 36px; margin-bottom: 4px; }
    .canvas-stat-label { font-size: 13px; color: #6B7280; }

    /* === ANIMATIONS === */
    @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
    .animate-in { animation: fadeSlideIn 0.3s ease-out; }

    /* === PRINT === */
    @media print { .no-print { display: none !important; } }

    /* === RESPONSIVE === */
    @media (max-width: 768px) {
      .wizard-sidebar { display: none; }
      .mobile-step-bar { display: block; }
      .wizard-content { padding: 24px 16px; }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const CONFIG = {
      TOOL_SLUG: 'value-proposition-testing',
      AUTOSAVE_DELAY: 2000,
      STEPS: [
        { num: 1, label: 'Test Setup' },
        { num: 2, label: 'Round 1 Interviews' },
        { num: 3, label: 'Analyze & Refine' },
        { num: 4, label: 'Round 2 Validation' },
        { num: 5, label: 'Final Decision' }
      ],
      TRANSITION_CONTENT: {
        1: {
          title: 'PLAN SET.',
          text: "You've defined what you're testing and who you'll test it with. Now it's time to hear what real customers think.",
          brutalTruth: "80% of failed product launches trace back to untested assumptions about customer value. Your testing plan eliminates guesswork — every interview must produce actionable insights, not polite conversation.",
          peerProof: "Osterwalder et al. (2014) found that companies using structured customer testing processes are 48% more likely to achieve product-market fit within the first year."
        },
        2: {
          title: 'DISCOVERY DONE.',
          text: "You've heard real customer reactions. Now analyze the patterns and fix what's broken.",
          brutalTruth: "One customer's opinion is noise. Three saying the same thing is a pattern. Five confirming it is a fact. Stick to patterns — the 20% of feedback that appears in 80% of conversations.",
          peerProof: "Maurya (2012) found that value propositions refined through evidence-based iteration outperform the original by 3.2x in conversion."
        },
        3: {
          title: 'REFINED.',
          text: "Your message is sharper. Time to validate that the fixes actually work with real customers.",
          brutalTruth: "Round 2 is validation, not discovery. If reactions still vary widely after refinement, the problem isn't the customers — it's the message.",
          peerProof: "Ries (2011) demonstrated that two-round testing — discover then validate — reduces false positives by 65% compared to single-round approaches."
        },
        4: {
          title: 'VALIDATED.',
          text: "The evidence is in. Time to lock it in and plan the rollout.",
          brutalTruth: "A great value proposition is not debated forever — it's tested, refined, and executed. After two rounds of customer interviews, commit with conviction.",
          peerProof: "Bain & Company (2022) found that companies with a single, validated value proposition used consistently across all channels achieve 31% higher revenue growth."
        },
        5: {
          title: 'LOCKED IN.',
          text: "Your value proposition is validated and ready for rollout. Every department speaks it consistently from today.",
          brutalTruth: "McKinsey shows teams using validation checklists before committing reduce post-launch pivots by 55%. You've done the work — now execute.",
          peerProof: "Companies that maintain message consistency after structured validation achieve 2.4x faster market penetration than those who continue iterating post-launch."
        }
      },
      CLOSING_MESSAGES: {
        1: { title: 'SETUP COMPLETE', text: 'Plan set. Next: hear what real customers think.' },
        2: { title: 'ROUND 1 DONE', text: 'Discovery complete. Next: analyze patterns and refine.' },
        3: { title: 'REFINED', text: 'Message sharpened. Next: validate with Round 2.' },
        4: { title: 'ROUND 2 DONE', text: 'Validation complete. Next: make your final decision.' },
        5: { title: 'DECISION MADE', text: 'VP locked in. View your results canvas.' }
      }
    };

    ToolDB.init(CONFIG.TOOL_SLUG);
    ToolAccessControl.init(CONFIG.TOOL_SLUG);

    CognitiveLoad.init('vp-testing', {"insights":["An untested value proposition is just a hypothesis.","Real validation requires real customers and real commitment signals."],"caseStudy":{"before":"A B2B software company launched their new product based on internal assumptions about what customers valued. Marketing emphasized technical features the engineering team was proud of. After six months, conversion rates were below 2% and sales cycles averaged 90 days.","after":"Using the VP Testing process, they interviewed 15 target customers across two rounds. Round 1 revealed customers cared about implementation speed, not features. Round 2 validated a refined message focused on '48-hour deployment with zero IT required.' Conversion rates jumped to 11%, sales cycles dropped to 30 days.","quote":"We spent a year building features nobody asked for. Two weeks of structured customer interviews told us more than 12 months of guessing."}});
    const { CaseStudy } = CognitiveLoad.components;

    /* ============================================================
       SHARED COMPONENTS
       ============================================================ */

    function CheckIcon({ color = "#fff", size = 16 }) {
      return <svg width={size} height={size} viewBox="0 0 24 24" fill={color}><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>;
    }

    function MobileStepBar({ currentStep, totalSteps }) {
      return (
        <div className="mobile-step-bar">
          <div className="bar-text">Step {Math.min(currentStep, totalSteps)} of {totalSteps}</div>
          <div className="mobile-progress"><div className="mobile-progress-fill" style={{ width: `${(currentStep / totalSteps) * 100}%` }} /></div>
        </div>
      );
    }

    function DependencyContext({ deps }) {
      const [open, setOpen] = useState(false);
      if (!deps || deps.length === 0) return null;
      return (
        <div style={{ marginBottom: 24 }}>
          <button onClick={() => setOpen(!open)} style={{ background: '#F3F4F6', border: '1px solid #E5E7EB', padding: '8px 12px', cursor: 'pointer', fontSize: 13, fontFamily: "'Monument', monospace", letterSpacing: '0.05em', textTransform: 'uppercase', color: '#6B7280' }}>
            {open ? '▾' : '▸'} Previous Sprint Data ({deps.length})
          </button>
          {open && (
            <div style={{ background: '#F9FAFB', border: '1px solid #E5E7EB', borderTop: 'none', padding: 16 }}>
              {deps.map((d, i) => (
                <div key={i} style={{ marginBottom: 12 }}>
                  <div className="monument" style={{ fontSize: 10, color: '#6B7280', marginBottom: 4 }}>{d.label}</div>
                  <div style={{ fontSize: 14, whiteSpace: 'pre-wrap' }}>{d.value}</div>
                </div>
              ))}
            </div>
          )}
        </div>
      );
    }

    function LearnMore({ children }) {
      const [open, setOpen] = useState(false);
      return (
        <>
          <button className="learn-more-toggle" onClick={() => setOpen(!open)}>
            {open ? '▾' : '▸'} Science Behind It
          </button>
          {open && <div className="learn-more-content">{children}</div>}
        </>
      );
    }

    function WizardSidebar({ currentStep, data, onNavigate }) {
      const getSnippet = (n) => {
        if (n === 1 && data.valuePropBeingTested) return '"' + data.valuePropBeingTested.substring(0, 50) + '..."';
        if (n === 2) return (data.round1Interviews || []).filter(i => i.customerName).length + ' interview(s)';
        if (n === 3 && data.refinedValueProp) return '"' + data.refinedValueProp.substring(0, 50) + '..."';
        if (n === 4) return (data.round2Interviews || []).filter(i => i.customerName).length + ' interview(s)';
        if (n === 5 && data.finalValueProp) return '"' + data.finalValueProp.substring(0, 50) + '..."';
        return null;
      };
      const effectiveStep = Math.ceil(currentStep);
      return (
        <div className="wizard-sidebar no-print">
          <div className="wizard-sidebar-inner">
            <div style={{ marginBottom: 24 }}>
              <div className="monument" style={{ fontSize: 12, textTransform: 'uppercase', color: '#fff', marginBottom: 4 }}>VP TESTING</div>
              <div style={{ fontSize: 13, color: '#999' }}>~38 min</div>
            </div>
            <div style={{ marginBottom: 16, fontFamily: "'Monument', monospace", fontSize: 10, textTransform: 'uppercase', letterSpacing: '0.05em', color: '#999' }}>Your progress</div>
            {CONFIG.STEPS.map(s => {
              const isCompleted = effectiveStep > s.num, isActive = effectiveStep === s.num, isLocked = effectiveStep < s.num;
              const snippet = isCompleted ? getSnippet(s.num) : null;
              return (
                <div key={s.num} className={`sidebar-step-item ${isCompleted ? 'completed' : ''} ${isActive ? 'active' : ''} ${isLocked ? 'locked' : ''}`}
                  onClick={() => isCompleted && onNavigate(s.num)} title={isCompleted ? 'Click to review' : ''}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>
                    {isCompleted ? <CheckIcon color="#000" size={14} /> : <span className="step-num" style={{ color: isActive ? '#fff' : '#ccc' }}>{String(s.num).padStart(2, '0')}</span>}
                    <span className="step-name" style={{ color: isLocked ? '#666' : isCompleted ? '#000' : '#fff' }}>{s.label}</span>
                  </div>
                  {snippet && <div className="sidebar-snippet">{snippet}</div>}
                </div>
              );
            })}
          </div>
        </div>
      );
    }

    /* ============================================================
       INTRO PAGE
       ============================================================ */
    function IntroPage({ onBegin }) {
      return (
        <div style={{ background: '#000', color: '#fff', minHeight: '100vh', padding: 64 }}>
          <div style={{ maxWidth: 1000, margin: '0 auto' }}>
            <h1 className="plaak animate-in" style={{ fontSize: 100, marginBottom: 64 }}>BEFORE WE START</h1>

            <div className="animate-in" style={{ marginBottom: 48, animationDelay: '0.08s' }}>
              <h2 className="plaak" style={{ fontSize: 48, color: '#FFF469', marginBottom: 24 }}>SPRINT INFO</h2>
              <div style={{ background: '#fff', color: '#000', padding: 32 }}>
                <p style={{ fontSize: 22, fontWeight: 'bold', marginBottom: 16 }}>Sprint 16: Value Proposition Testing</p>
                <p style={{ fontSize: 18, lineHeight: 1.6, marginBottom: 16 }}>
                  This sprint cuts through assumptions and turns customer insights into a clear, powerful message your market cannot ignore. It is focused on quickly validating and locking in your value proposition with real customer reactions, not guesswork.
                </p>
                <div style={{ borderLeft: '4px solid #000', paddingLeft: 16, fontStyle: 'italic', fontSize: 16 }}>
                  "A value proposition only works if it lands the first time with customers. This process ensures predictability — if multiple customers react the same way, it's a pattern."
                </div>
              </div>
            </div>

            <div className="animate-in" style={{ marginBottom: 48, animationDelay: '0.1s' }}>
              <h2 className="plaak" style={{ fontSize: 48, marginBottom: 24 }}>PURPOSE</h2>
              <div style={{ borderLeft: '4px solid #fff', paddingLeft: 24, marginBottom: 24 }}>
                <p style={{ fontSize: 28, fontStyle: 'italic', marginBottom: 8 }}>
                  "The best value proposition isn't what you think sounds good — it's what customers can't ignore."
                </p>
                <p style={{ fontSize: 18, color: '#999' }}>— Fast Track Testing Principle</p>
              </div>
              <p style={{ fontSize: 22, lineHeight: 1.6 }}>
                Test your value proposition with real customers in two rounds: Round 1 identifies confusion points, Round 2 validates your refined message. The goal is consistency — if multiple customers react the same way, you have a bulletproof value proposition.
              </p>
            </div>

            <div className="animate-in" style={{ marginBottom: 48, animationDelay: '0.2s' }}>
              <h2 className="plaak" style={{ fontSize: 48, color: '#FFF469', marginBottom: 24 }}>MISTAKES TO AVOID</h2>
              <ul style={{ fontSize: 20, listStyle: 'none', padding: 0 }}>
                {[
                  'Accepting polite but unclear feedback — never settle for vague responses. Push for specifics.',
                  'Over-explaining during tests — if they don\'t get it immediately, the message still needs work.',
                  'Leading them to the answer you want — your job is to listen, not to get validation.',
                  'Defending your original idea — the point is to improve, not justify what exists.',
                  'Jumping to conclusions too fast — one person\'s reaction doesn\'t make a pattern. Need 3+ consistent reactions.',
                ].map((m, i) => (
                  <li key={i} style={{ display: 'flex', alignItems: 'flex-start', marginBottom: 16 }}>
                    <span style={{ fontSize: 32, marginRight: 16, lineHeight: 1, flexShrink: 0 }}>•</span>
                    <span>{m}</span>
                  </li>
                ))}
              </ul>
            </div>

            <div className="animate-in" style={{ marginBottom: 64, animationDelay: '0.3s' }}>
              <h2 className="plaak" style={{ fontSize: 48, marginBottom: 32 }}>THE JOURNEY</h2>
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: 16, textAlign: 'center' }}>
                {[
                  ['01', 'SETUP', 'Define your VP and testing plan'],
                  ['02', 'ROUND 1', 'Interview customers, capture reactions'],
                  ['03', 'REFINE', 'Analyze patterns, sharpen the message'],
                  ['04', 'ROUND 2', 'Validate the refined VP'],
                  ['05', 'DECIDE', 'Lock in and plan rollout'],
                ].map(([num, title, sub]) => (
                  <div key={num} style={{ border: '2px solid #fff', padding: '20px 12px' }}>
                    <div className="plaak" style={{ fontSize: 52, marginBottom: 12 }}>{num}</div>
                    <p style={{ fontWeight: 'bold', marginBottom: 6, fontSize: 13 }}>{title}</p>
                    <p style={{ fontSize: 12, color: '#999' }}>{sub}</p>
                  </div>
                ))}
              </div>
            </div>

            <button onClick={onBegin} className="plaak"
              style={{ width: '100%', padding: 32, background: '#FFF469', color: '#000', border: 'none', fontSize: 28, cursor: 'pointer', letterSpacing: '0.05em', transition: 'opacity 0.2s' }}>
              LET'S START →
            </button>
          </div>
        </div>
      );
    }

    /* ============================================================
       STEP 1: TEST SETUP — 4 fields, one per screen
       ============================================================ */
    const STEP1_FIELDS = [
      { key: 'valuePropBeingTested', label: 'Value Proposition Being Tested', hint: 'Paste the exact VP statement you want to test with customers.', placeholder: 'e.g. "For mid-market SaaS companies struggling with customer churn, we provide an AI-powered retention platform that predicts at-risk accounts 30 days before cancellation, unlike reactive analytics tools that only report after the fact."', minLen: 30 },
      { key: 'testingObjective', label: 'Testing Objective', hint: 'What specific question are you trying to answer with this round of testing?', placeholder: 'e.g. "Does our target customer immediately understand the pain we solve and believe our solution is different enough to switch?"', minLen: 30 },
      { key: 'targetCustomerProfile', label: 'Target Customer Profile', hint: 'Who exactly will you interview? Be specific about role, company size, and current situation.', placeholder: 'e.g. "VP of Customer Success at B2B SaaS companies with 500-2000 customers, currently using manual churn tracking or basic NPS surveys."' },
      { key: 'interviewPlan', label: 'Interview Plan', hint: 'How many interviews will you conduct? Where and when? Aim for 5-8 per round.', placeholder: 'e.g. "Round 1: 6 interviews over 2 weeks. Sourced from LinkedIn outreach (3) and existing network (3). 30-minute video calls."' },
    ];

    function Step1({ data, updateData, fieldIndex }) {
      const f = STEP1_FIELDS[fieldIndex];
      const val = data[f.key] || '';
      const isLast = fieldIndex === STEP1_FIELDS.length - 1;
      return (
        <div className="animate-in" key={fieldIndex}>
          <div className="opening-box">
            <p className="step-indicator">STEP 1 OF 5 · FIELD {fieldIndex + 1} OF {STEP1_FIELDS.length}</p>
            <h1 className="step-heading">TEST SETUP</h1>
            <p className="step-hint">{f.hint}</p>
          </div>
          <div className="field-group">
            <label className="field-label">{f.label}{f.minLen && <span style={{ color: '#DC2626', fontWeight: 700 }}> *</span>}</label>
            <textarea className="field-textarea" style={{ minHeight: 160 }} value={val} onChange={e => updateData(f.key, e.target.value)} placeholder={f.placeholder} />
            {f.minLen && <p className="field-help">{val.length}/{f.minLen} min characters</p>}
          </div>
          {isLast && (
            <LearnMore>
              An untested value proposition is just a hypothesis. Companies that validate their VP with real customers before launch are 48% more likely to achieve product-market fit (Osterwalder, 2014). The key is structured testing — not casual conversations, but deliberate interviews with clear objectives and measurable outcomes.
            </LearnMore>
          )}
        </div>
      );
    }

    /* ============================================================
       STEP 2: ROUND 1 INTERVIEWS — one interview card at a time
       ============================================================ */
    const R1_FIELDS = [
      { key: 'customerName', label: 'Customer Name', type: 'input', required: true, placeholder: 'e.g. Sarah Chen, VP Customer Success' },
      { key: 'customerProfile', label: 'Customer Profile', type: 'textarea', placeholder: 'e.g. B2B SaaS, 800 customers, manual churn tracking, 8% monthly churn' },
      { key: 'date', label: 'Interview Date', type: 'input', placeholder: 'e.g. 2026-03-15' },
      { key: 'problemReconfirm', label: 'Problem Reconfirmation', type: 'textarea', placeholder: 'Did they confirm the pain is real? What words did they use?' },
      { key: 'valueReaction', label: 'Value Proposition Reaction', type: 'textarea', required: true, minLen: 30, placeholder: 'Read your VP aloud. What was their immediate, unfiltered reaction?' },
      { key: 'whatWorked', label: 'What Worked', type: 'textarea', required: true, minLen: 20, placeholder: 'Which parts of the message resonated most? What made them lean in?' },
      { key: 'whatUnclear', label: 'What Was Unclear', type: 'textarea', placeholder: 'Where did they hesitate, ask questions, or look confused?' },
      { key: 'concerns', label: 'Concerns Raised', type: 'textarea', placeholder: 'Any objections, doubts, or pushback?' },
      { key: 'theirWords', label: 'Their Exact Words', type: 'textarea', placeholder: 'Capture 2-3 direct quotes. These are gold for refining your message.' },
      { key: 'callToActionResponse', label: 'Call to Action Response', type: 'textarea', placeholder: 'When you asked "Would you want to learn more?" — what happened?' },
    ];

    function Step2({ data, updateData, addRound1Interview, removeRound1Interview, updateRound1Interview, interviewIndex, fieldIndex }) {
      const interviews = data.round1Interviews || [];
      const iv = interviews[interviewIndex] || {};
      const f = R1_FIELDS[fieldIndex];
      const val = iv[f.key] || '';
      const isLastField = fieldIndex === R1_FIELDS.length - 1;
      const isLastInterview = interviewIndex === interviews.length - 1;

      return (
        <div className="animate-in" key={`${interviewIndex}-${fieldIndex}`}>
          <div className="opening-box">
            <p className="step-indicator">STEP 2 OF 5 · INTERVIEW {interviewIndex + 1} · FIELD {fieldIndex + 1} OF {R1_FIELDS.length}</p>
            <h1 className="step-heading">ROUND 1 INTERVIEWS</h1>
            <p className="step-hint">Capture real customer reactions to your value proposition. Don't explain or defend — just listen.</p>
          </div>

          <div className="interview-card">
            <div className="interview-card-header">
              <span className="interview-card-num">Interview {interviewIndex + 1} of {interviews.length}</span>
              {interviews.length > 1 && isLastField && <button className="btn-remove" onClick={() => removeRound1Interview(interviewIndex)}>Remove</button>}
            </div>
            <div className="field-group">
              <label className="field-label">{f.label}{f.required && <span style={{ color: '#DC2626', fontWeight: 700 }}> *</span>}</label>
              {f.type === 'input' ? (
                <input className="field-input" value={val} onChange={e => updateRound1Interview(interviewIndex, f.key, e.target.value)} placeholder={f.placeholder} />
              ) : (
                <textarea className="field-textarea" value={val} onChange={e => updateRound1Interview(interviewIndex, f.key, e.target.value)} placeholder={f.placeholder} />
              )}
              {f.minLen && <p className="field-help">{val.length}/{f.minLen} min characters</p>}
            </div>
          </div>

          {isLastField && isLastInterview && (
            <>
              <button className="btn-add" onClick={addRound1Interview} style={{ marginBottom: 24 }}>+ Add Another Interview</button>
              <LearnMore>
                Maurya (2012) found that value propositions refined through evidence-based iteration outperform the original by 3.2x in conversion. The magic number is 5-8 interviews per round — enough to spot patterns without drowning in data. Focus on what surprised you, not what confirmed your existing beliefs.
              </LearnMore>
            </>
          )}
        </div>
      );
    }

    /* ============================================================
       STEP 3: ANALYZE & REFINE — 6 fields, one per screen
       ============================================================ */
    const STEP3_FIELDS = [
      { key: 'round1Patterns', label: 'Overall Patterns', hint: 'Look across all interviews. What themes emerged?', placeholder: 'e.g. "4 of 6 interviewees immediately understood the churn prediction angle. 5 of 6 said \'30 days\' was the most compelling number."' },
      { key: 'positivePatterns', label: 'What Consistently Worked', hint: 'Which parts of your VP got the strongest positive reactions across multiple interviews?', placeholder: 'e.g. "The \'predict before cancellation\' framing resonated with everyone. The word \'AI-powered\' triggered positive reactions in 5/6 interviews."', minLen: 50 },
      { key: 'confusionPoints', label: 'Consistent Confusion Points', hint: 'Where did multiple customers stumble or ask for clarification?', placeholder: 'e.g. "3 of 6 asked what \'reactive analytics tools\' meant. 2 were confused about the \'30 days\' claim — is it guaranteed?"', minLen: 30 },
      { key: 'objections', label: 'Common Objections', hint: 'What pushback or concerns appeared in multiple interviews?', placeholder: 'e.g. "2 customers worried about data integration complexity. 1 questioned accuracy of predictions."' },
      { key: 'refinedValueProp', label: 'Refined Value Proposition', hint: 'Rewrite your VP incorporating the feedback. Fix what was unclear, double down on what worked.', placeholder: 'e.g. "For customer success teams losing revenue to surprise cancellations, our platform flags at-risk accounts 30 days early — so you can save them before they leave."', minLen: 30 },
      { key: 'changesJustification', label: 'Changes & Justification', hint: 'What did you change and why? Link each change to specific customer feedback.', placeholder: 'e.g. "Removed \'AI-powered\' — customers cared about outcomes, not tech. Changed \'mid-market SaaS\' to \'customer success teams\' — more specific."' },
    ];

    function Step3({ data, updateData, fieldIndex }) {
      const f = STEP3_FIELDS[fieldIndex];
      const val = data[f.key] || '';
      const isLast = fieldIndex === STEP3_FIELDS.length - 1;
      return (
        <div className="animate-in" key={fieldIndex}>
          <div className="opening-box">
            <p className="step-indicator">STEP 3 OF 5 · FIELD {fieldIndex + 1} OF {STEP3_FIELDS.length}</p>
            <h1 className="step-heading">ANALYZE & REFINE</h1>
            <p className="step-hint">{f.hint}</p>
          </div>

          {fieldIndex === 4 && data.valuePropBeingTested && (
            <div style={{ background: '#F3F4F6', borderLeft: '3px solid #000', padding: 16, marginBottom: 24 }}>
              <div className="monument" style={{ fontSize: 10, color: '#6B7280', marginBottom: 4 }}>ORIGINAL VP (FOR REFERENCE)</div>
              <p style={{ fontSize: 14, lineHeight: 1.6 }}>{data.valuePropBeingTested}</p>
            </div>
          )}

          <div className="field-group">
            <label className="field-label">{f.label}{f.minLen && <span style={{ color: '#DC2626', fontWeight: 700 }}> *</span>}</label>
            <textarea className="field-textarea" style={{ minHeight: 160 }} value={val} onChange={e => updateData(f.key, e.target.value)} placeholder={f.placeholder} />
            {f.minLen && <p className="field-help">{val.length}/{f.minLen} min characters</p>}
          </div>
          {isLast && (
            <LearnMore>
              Nielsen Norman Group confirms that retesting after refinement provides the strongest signal of genuine improvement. The key principle: change only what the data tells you to change. If 3+ customers said the same thing, fix it. If only 1 person mentioned something, note it but don't overreact.
            </LearnMore>
          )}
        </div>
      );
    }

    /* ============================================================
       STEP 4: ROUND 2 VALIDATION — one interview card at a time
       ============================================================ */
    const R2_FIELDS = [
      { key: 'customerName', label: 'Customer Name', type: 'input', required: true, placeholder: 'e.g. David Park, Head of Operations' },
      { key: 'customerProfile', label: 'Customer Profile', type: 'input', placeholder: 'e.g. B2B SaaS, 1200 customers, uses basic NPS' },
      { key: 'date', label: 'Interview Date', type: 'input', placeholder: 'e.g. 2026-04-01' },
      { key: 'problemStillValid', label: 'Is the Problem Still Valid?', type: 'textarea', placeholder: 'Did they confirm the pain without you leading them? What words did they use?' },
      { key: 'valueReaction', label: 'Reaction to Refined VP', type: 'textarea', placeholder: 'Read the refined VP. Was the reaction stronger, weaker, or similar to Round 1?' },
      { key: 'clarity', label: 'Clarity Score (1-5)', type: 'select', required: true, options: ['1','2','3','4','5'], placeholder: 'How clearly did they understand the message?' },
      { key: 'enthusiasm', label: 'Enthusiasm Score (1-5)', type: 'select', required: true, options: ['1','2','3','4','5'], placeholder: 'How excited were they about the proposition?' },
      { key: 'differentiation', label: 'Differentiation Score (1-5)', type: 'select', options: ['1','2','3','4','5'], placeholder: 'How clearly did they see what makes you different?' },
      { key: 'actionability', label: 'Actionability Score (1-5)', type: 'select', options: ['1','2','3','4','5'], placeholder: 'Would they take action based on this message?' },
      { key: 'concerns', label: 'Remaining Concerns', type: 'textarea', placeholder: 'Any lingering doubts or questions after hearing the refined VP?' },
      { key: 'recommendation', label: 'Would They Recommend?', type: 'textarea', placeholder: 'If they had a colleague with this problem, would they recommend you? Why or why not?' },
    ];

    function Step4({ data, updateRound2Interview, addRound2Interview, removeRound2Interview, interviewIndex, fieldIndex }) {
      const interviews = data.round2Interviews || [];
      const iv = interviews[interviewIndex] || {};
      const f = R2_FIELDS[fieldIndex];
      const val = iv[f.key] || '';
      const isLastField = fieldIndex === R2_FIELDS.length - 1;
      const isLastInterview = interviewIndex === interviews.length - 1;

      return (
        <div className="animate-in" key={`${interviewIndex}-${fieldIndex}`}>
          <div className="opening-box">
            <p className="step-indicator">STEP 4 OF 5 · INTERVIEW {interviewIndex + 1} · FIELD {fieldIndex + 1} OF {R2_FIELDS.length}</p>
            <h1 className="step-heading">ROUND 2 VALIDATION</h1>
            <p className="step-hint">Validate your refined VP. This round is about confirmation, not discovery.</p>
          </div>

          {fieldIndex === 0 && data.refinedValueProp && (
            <div style={{ background: '#000', color: '#fff', padding: 16, marginBottom: 24 }}>
              <div className="monument" style={{ fontSize: 10, color: '#FFF469', marginBottom: 4 }}>REFINED VP BEING TESTED</div>
              <p style={{ fontSize: 15, lineHeight: 1.6 }}>{data.refinedValueProp}</p>
            </div>
          )}

          <div className="interview-card">
            <div className="interview-card-header">
              <span className="interview-card-num">Interview {interviewIndex + 1} of {interviews.length}</span>
              {interviews.length > 1 && isLastField && <button className="btn-remove" onClick={() => removeRound2Interview(interviewIndex)}>Remove</button>}
            </div>
            <div className="field-group">
              <label className="field-label">{f.label}{f.required && <span style={{ color: '#DC2626', fontWeight: 700 }}> *</span>}</label>
              {f.type === 'input' ? (
                <input className="field-input" value={val} onChange={e => updateRound2Interview(interviewIndex, f.key, e.target.value)} placeholder={f.placeholder} />
              ) : f.type === 'select' ? (
                <select className="field-input" value={val} onChange={e => updateRound2Interview(interviewIndex, f.key, e.target.value)}>
                  <option value="">Select score...</option>
                  {f.options.map(o => <option key={o} value={o}>{o}</option>)}
                </select>
              ) : (
                <textarea className="field-textarea" value={val} onChange={e => updateRound2Interview(interviewIndex, f.key, e.target.value)} placeholder={f.placeholder} />
              )}
            </div>
          </div>

          {isLastField && isLastInterview && (
            <>
              <button className="btn-add" onClick={addRound2Interview} style={{ marginBottom: 24 }}>+ Add Another Interview</button>
              <LearnMore>
                Ries (2011) demonstrated that two-round testing — discover then validate — reduces false positives by 65%. In Round 2, you're looking for consistency. If clarity and enthusiasm scores average 4+ across interviews, your VP is working. Below 3? You have more work to do.
              </LearnMore>
            </>
          )}
        </div>
      );
    }

    /* ============================================================
       STEP 5: FINAL DECISION — validation checklist then fields
       ============================================================ */
    const VALIDATION_ITEMS = [
      { key: 'mainNeedsSatisfied', q: 'Does your VP address the main customer needs identified in testing?' },
      { key: 'factsNotOpinions', q: 'Are your conclusions based on consistent patterns (3+ customers), not individual opinions?' },
      { key: 'generalToSpecific', q: 'Did you move from general to specific — drilling down with follow-up questions?' },
      { key: 'askedWhy', q: 'Did you ask "why" at least 3 times per interview to get to root motivations?' },
      { key: 'notLeading', q: 'Did you avoid leading questions? (No "Don\'t you think this is great?")' },
      { key: 'sharedFindings', q: 'Have you shared findings with your team and incorporated their perspective?' },
      { key: 'updatedAddressesFeedback', q: 'Does your updated VP directly address the feedback from both rounds?' },
    ];

    const STEP5_FIELDS = [
      { key: 'finalValueProp', label: 'Final Value Proposition', hint: 'Write the final, locked-in version of your VP. This is the version that ships.', placeholder: 'Your polished, customer-validated value proposition statement...', minLen: 30 },
      { key: 'consistentReactions', label: 'Consistent Reactions', hint: 'What reactions appeared consistently across both rounds?', placeholder: 'e.g. "Clarity improved from 3.2 to 4.6 average. Enthusiasm jumped when we mentioned \'30 days early\'."' },
      { key: 'strongestDifferentiator', label: 'Strongest Differentiator', hint: 'What single element made customers see you as different from alternatives?', placeholder: 'e.g. "The predictive element. No competitor offers early warning — they only report after cancellation."' },
      { key: 'remainingAdjustments', label: 'Remaining Adjustments', hint: 'Any minor tweaks needed before full rollout?', placeholder: 'e.g. "Need to test shortened version for social media. Consider industry-specific variants for healthcare vs SaaS."' },
      { key: 'rolloutPlan', label: 'Rollout Plan', hint: 'How will you embed this VP across your organization?', placeholder: 'e.g. "Week 1: Update website homepage + all landing pages. Week 2: Sales deck + email templates. Week 3: Team training session. Week 4: Social media + PR messaging."' },
    ];

    function Step5({ data, updateData, updateValidation, fieldIndex }) {
      // fieldIndex 0 = validation checklist, 1-5 = text fields
      if (fieldIndex === 0) {
        const yesCount = Object.values(data.validation || {}).filter(v => v === 'yes').length;
        // Show R2 averages
        const r2 = data.round2Interviews || [];
        const avgC = r2.filter(i => i.clarity).length > 0 ? (r2.reduce((s, i) => s + (parseInt(i.clarity) || 0), 0) / r2.filter(i => i.clarity).length).toFixed(1) : '—';
        const avgE = r2.filter(i => i.enthusiasm).length > 0 ? (r2.reduce((s, i) => s + (parseInt(i.enthusiasm) || 0), 0) / r2.filter(i => i.enthusiasm).length).toFixed(1) : '—';

        return (
          <div className="animate-in" key="checklist">
            <div className="opening-box">
              <p className="step-indicator">STEP 5 OF 5 · VALIDATION CHECKLIST</p>
              <h1 className="step-heading">FINAL DECISION</h1>
              <p className="step-hint">Before locking in your VP, confirm you've followed a rigorous testing process. Need 5+ "Yes" to proceed.</p>
            </div>

            {avgC !== '—' && (
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 16, marginBottom: 24 }}>
                <div style={{ background: '#F3F4F6', padding: 16, textAlign: 'center' }}>
                  <div className="monument" style={{ fontSize: 10, color: '#6B7280', marginBottom: 4 }}>AVG CLARITY</div>
                  <div style={{ fontSize: 28, fontWeight: 700 }}>{avgC}/5</div>
                </div>
                <div style={{ background: '#F3F4F6', padding: 16, textAlign: 'center' }}>
                  <div className="monument" style={{ fontSize: 10, color: '#6B7280', marginBottom: 4 }}>AVG ENTHUSIASM</div>
                  <div style={{ fontSize: 28, fontWeight: 700 }}>{avgE}/5</div>
                </div>
              </div>
            )}

            {VALIDATION_ITEMS.map(item => (
              <div key={item.key} className="validation-item">
                <div className="validation-q">{item.q}</div>
                <div className="validation-radios">
                  <label><input type="radio" name={item.key} value="yes" checked={(data.validation || {})[item.key] === 'yes'} onChange={() => updateValidation(item.key, 'yes')} /> Yes</label>
                  <label><input type="radio" name={item.key} value="no" checked={(data.validation || {})[item.key] === 'no'} onChange={() => updateValidation(item.key, 'no')} /> No</label>
                </div>
              </div>
            ))}

            <div style={{ marginTop: 16, padding: '12px 16px', background: yesCount >= 5 ? '#f0fdf4' : '#fef2f2', borderLeft: `3px solid ${yesCount >= 5 ? '#059669' : '#DC2626'}`, fontSize: 14 }}>
              {yesCount}/7 validated — {yesCount >= 5 ? 'Ready to proceed' : 'Need at least 5 to continue'}
            </div>
          </div>
        );
      }

      const f = STEP5_FIELDS[fieldIndex - 1];
      const val = data[f.key] || '';
      const isLast = fieldIndex === STEP5_FIELDS.length;
      return (
        <div className="animate-in" key={fieldIndex}>
          <div className="opening-box">
            <p className="step-indicator">STEP 5 OF 5 · FIELD {fieldIndex} OF {STEP5_FIELDS.length}</p>
            <h1 className="step-heading">FINAL DECISION</h1>
            <p className="step-hint">{f.hint}</p>
          </div>
          <div className="field-group">
            <label className="field-label">{f.label}{f.minLen && <span style={{ color: '#DC2626', fontWeight: 700 }}> *</span>}</label>
            <textarea className="field-textarea" style={{ minHeight: 160 }} value={val} onChange={e => updateData(f.key, e.target.value)} placeholder={f.placeholder} />
            {f.minLen && <p className="field-help">{val.length}/{f.minLen} min characters</p>}
          </div>
          {isLast && (
            <LearnMore>
              Bain &amp; Company (2022) found that companies with a single, validated value proposition used consistently across all channels achieve 31% higher revenue growth. The biggest risk now is not an imperfect message — it's endless tweaking that delays execution.
            </LearnMore>
          )}
        </div>
      );
    }

    /* ============================================================
       CANVAS PAGE
       ============================================================ */
    function CanvasPage({ data, onBack, onExport, onSubmit, submitStatus, submitMessage }) {
      const yesCount = Object.values(data.validation || {}).filter(v => v === 'yes').length;
      const r2 = data.round2Interviews || [];
      const avgC = r2.filter(i => i.clarity).length > 0 ? (r2.reduce((s, i) => s + (parseInt(i.clarity) || 0), 0) / r2.filter(i => i.clarity).length).toFixed(1) : '—';
      const avgE = r2.filter(i => i.enthusiasm).length > 0 ? (r2.reduce((s, i) => s + (parseInt(i.enthusiasm) || 0), 0) / r2.filter(i => i.enthusiasm).length).toFixed(1) : '—';

      return (
        <div style={{ background: '#fff', minHeight: '100vh', padding: '48px 32px' }}>
          <div style={{ maxWidth: 900, margin: '0 auto' }}>
            <h1 className="plaak animate-in" style={{ fontSize: 48, textAlign: 'center', marginBottom: 48 }}>VALUE PROPOSITION TESTING RESULTS</h1>

            <div id="canvas-content" style={{ border: '4px solid #000', padding: 48, marginBottom: 32 }}>
              {/* Header */}
              <div style={{ textAlign: 'center', marginBottom: 40 }}>
                <div className="monument" style={{ fontSize: 12, color: '#6B7280', letterSpacing: '0.1em', marginBottom: 8 }}>FAST TRACK · SPRINT 16</div>
                <h2 className="plaak" style={{ fontSize: 32, marginBottom: 4 }}>VALUE PROPOSITION TESTING</h2>
                <p style={{ fontSize: 14, color: '#6B7280' }}>Customer Validation Results</p>
              </div>

              {/* Final VP */}
              <div style={{ background: '#FFF469', border: '3px solid #000', padding: 24, marginBottom: 32, textAlign: 'center' }}>
                <div className="monument" style={{ fontSize: 10, marginBottom: 8 }}>FINAL VALUE PROPOSITION</div>
                <p style={{ fontSize: 20, fontWeight: 700, lineHeight: 1.5 }}>{data.finalValueProp}</p>
              </div>

              {/* Stats */}
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 16, marginBottom: 32 }}>
                <div className="canvas-stat">
                  <div className="canvas-stat-num">{(data.round1Interviews || []).length}</div>
                  <div className="canvas-stat-label">Round 1 Interviews</div>
                </div>
                <div className="canvas-stat">
                  <div className="canvas-stat-num">{(data.round2Interviews || []).length}</div>
                  <div className="canvas-stat-label">Round 2 Interviews</div>
                </div>
                <div className="canvas-stat">
                  <div className="canvas-stat-num">{yesCount}/7</div>
                  <div className="canvas-stat-label">Validation Score</div>
                </div>
              </div>

              {/* R2 Performance */}
              {avgC !== '—' && (
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 16, marginBottom: 32 }}>
                  <div className="canvas-stat">
                    <div className="canvas-stat-num">{avgC}/5</div>
                    <div className="canvas-stat-label">Avg Clarity</div>
                  </div>
                  <div className="canvas-stat">
                    <div className="canvas-stat-num">{avgE}/5</div>
                    <div className="canvas-stat-label">Avg Enthusiasm</div>
                  </div>
                </div>
              )}

              {/* Key Insights */}
              <div className="canvas-section">
                <div className="canvas-section-title">Key Insights</div>
                {data.positivePatterns && (
                  <div style={{ marginBottom: 12 }}>
                    <div className="monument" style={{ fontSize: 10, color: '#059669', marginBottom: 4 }}>WHAT WORKED</div>
                    <p style={{ fontSize: 15, lineHeight: 1.6 }}>{data.positivePatterns}</p>
                  </div>
                )}
                {data.confusionPoints && (
                  <div style={{ marginBottom: 12 }}>
                    <div className="monument" style={{ fontSize: 10, color: '#D97706', marginBottom: 4 }}>WHAT WAS FIXED</div>
                    <p style={{ fontSize: 15, lineHeight: 1.6 }}>{data.confusionPoints}</p>
                  </div>
                )}
                {data.strongestDifferentiator && (
                  <div style={{ marginBottom: 12 }}>
                    <div className="monument" style={{ fontSize: 10, color: '#000', marginBottom: 4 }}>STRONGEST DIFFERENTIATOR</div>
                    <p style={{ fontSize: 15, lineHeight: 1.6 }}>{data.strongestDifferentiator}</p>
                  </div>
                )}
              </div>

              {/* VP Evolution */}
              <div className="canvas-section">
                <div className="canvas-section-title">Value Proposition Evolution</div>
                <div style={{ background: '#F3F4F6', padding: 16, marginBottom: 12 }}>
                  <div className="monument" style={{ fontSize: 10, color: '#6B7280', marginBottom: 4 }}>ORIGINAL (PRE-TESTING)</div>
                  <p style={{ fontSize: 15 }}>{data.valuePropBeingTested}</p>
                </div>
                {data.refinedValueProp && data.refinedValueProp !== data.finalValueProp && (
                  <div style={{ background: '#F3F4F6', padding: 16, marginBottom: 12 }}>
                    <div className="monument" style={{ fontSize: 10, color: '#6B7280', marginBottom: 4 }}>REFINED (AFTER ROUND 1)</div>
                    <p style={{ fontSize: 15 }}>{data.refinedValueProp}</p>
                  </div>
                )}
                <div style={{ background: '#FFF469', border: '2px solid #000', padding: 16 }}>
                  <div className="monument" style={{ fontSize: 10, marginBottom: 4 }}>FINAL (LOCKED IN)</div>
                  <p style={{ fontSize: 15, fontWeight: 700 }}>{data.finalValueProp}</p>
                </div>
              </div>

              {/* Rollout */}
              {data.rolloutPlan && (
                <div className="canvas-section">
                  <div className="canvas-section-title">Rollout Plan</div>
                  <p style={{ fontSize: 15, lineHeight: 1.6, whiteSpace: 'pre-line' }}>{data.rolloutPlan}</p>
                </div>
              )}

              <div style={{ textAlign: 'center', fontSize: 12, color: '#9CA3AF', marginTop: 32, paddingTop: 16, borderTop: '1px solid #E5E7EB' }}>
                Generated on {new Date().toLocaleDateString()} · Fast Track Program Sprint 16
              </div>
            </div>

            {/* Actions */}
            <div className="no-print" style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: 16, marginBottom: 32 }}>
              <button onClick={onBack} style={{ padding: '14px 24px', border: '2px solid #000', background: '#fff', cursor: 'pointer', fontFamily: "'Riforma', sans-serif", fontSize: 16 }}>← EDIT</button>
              <button onClick={onExport} style={{ padding: '14px 24px', border: '2px solid #000', background: '#000', color: '#fff', cursor: 'pointer', fontFamily: "'Riforma', sans-serif", fontSize: 16 }}>EXPORT PDF</button>
              <button onClick={onSubmit} disabled={submitStatus === 'saving'} style={{ padding: '14px 24px', border: '2px solid #000', background: '#000', color: '#fff', cursor: 'pointer', fontFamily: "'Riforma', sans-serif", fontSize: 16 }}>
                {submitStatus === 'saving' ? 'SAVING...' : submitStatus === 'success' ? '✓ SUBMITTED' : 'SUBMIT'}
              </button>
            </div>
            {submitMessage && <div style={{ padding: 12, background: submitStatus === 'success' ? '#f0fdf4' : '#fef2f2', borderLeft: `3px solid ${submitStatus === 'success' ? '#059669' : '#DC2626'}`, fontSize: 14, marginBottom: 24 }}>{submitMessage}</div>}

            <CaseStudy
              before={"A B2B software company launched their new product based on internal assumptions about what customers valued. Marketing emphasized technical features the engineering team was proud of. After six months, conversion rates were below 2% and sales cycles averaged 90 days."}
              after={"Using the VP Testing process, they interviewed 15 target customers across two rounds. Round 1 revealed customers cared about implementation speed, not features. Round 2 validated a refined message focused on '48-hour deployment with zero IT required.' Conversion rates jumped to 11%, sales cycles dropped to 30 days."}
              quote={"We spent a year building features nobody asked for. Two weeks of structured customer interviews told us more than 12 months of guessing."}
            />
          </div>
        </div>
      );
    }

    /* ============================================================
       MAIN APP
       ============================================================ */
    function TestingApp() {
      const [deps, setDeps] = useState([]);
      const [step, setStep] = useState(0);
      const [fieldIndex, setFieldIndex] = useState(0);
      const [interviewIndex, setInterviewIndex] = useState(0);
      const [aiReviewing, setAiReviewing] = useState(false);
      const [aiMessage, setAiMessage] = useState('');
      const [authState, setAuthState] = useState({ loading: false, authenticated: true });
      const [submitStatus, setSubmitStatus] = useState(null);
      const [submitMessage, setSubmitMessage] = useState('');

      const [data, setData] = useState({
        valuePropBeingTested: '', testingObjective: '', targetCustomerProfile: '', interviewPlan: '',
        round1Interviews: [{ customerName: '', customerProfile: '', date: '', problemReconfirm: '', valueReaction: '', whatWorked: '', whatUnclear: '', concerns: '', theirWords: '', callToActionResponse: '' }],
        round1Patterns: '', positivePatterns: '', confusionPoints: '', objections: '', refinedValueProp: '', changesJustification: '',
        round2Interviews: [{ customerName: '', customerProfile: '', date: '', problemStillValid: '', valueReaction: '', clarity: '', enthusiasm: '', differentiation: '', actionability: '', concerns: '', recommendation: '' }],
        validation: { mainNeedsSatisfied: '', factsNotOpinions: '', generalToSpecific: '', askedWhy: '', notLeading: '', sharedFindings: '', updatedAddressesFeedback: '' },
        finalValueProp: '', consistentReactions: '', strongestDifferentiator: '', remainingAdjustments: '', rolloutPlan: ''
      });

      const autosaveTimer = useRef(null);
      const updateData = (field, value) => setData(prev => ({ ...prev, [field]: value }));
      const updateValidation = (field, value) => setData(prev => ({ ...prev, validation: { ...prev.validation, [field]: value } }));

      // Reset fieldIndex when step changes
      useEffect(() => {
        setFieldIndex(0);
        setInterviewIndex(0);
      }, [step]);

      // Load deps
      useEffect(() => {
        async function loadDeps() {
          const userId = localStorage.getItem('ft_user_id');
          if (!userId || !window.ToolDB || !window.DependencyInjection) return;
          try {
            await ToolDB.whenReady();
            const config = DependencyInjection.getDependenciesConfig();
            const toolConfig = config[CONFIG.TOOL_SLUG];
            if (!toolConfig || !toolConfig.fields) return;
            const loaded = [];
            for (const field of toolConfig.fields) {
              const val = await ToolDB.getDependency(userId, field.source_field);
              if (val) loaded.push({ label: field.display_label || field.source_field, value: window.DependencyInjection ? DependencyInjection.formatValue(val) : (typeof val === 'object' ? JSON.stringify(val, null, 2) : String(val)) });
            }
            setDeps(loaded);
          } catch (err) { console.warn('[' + CONFIG.TOOL_SLUG + '] Failed to load dependencies:', err); }
        }
        loadDeps();
      }, []);

      // Autosave
      useEffect(() => {
        if (step < 1) return;
        clearTimeout(autosaveTimer.current);
        autosaveTimer.current = setTimeout(() => {
          localStorage.setItem(`ft_${CONFIG.TOOL_SLUG}_autosave`, JSON.stringify({ step, fieldIndex, interviewIndex, data, savedAt: new Date().toISOString() }));
        }, CONFIG.AUTOSAVE_DELAY);
        return () => clearTimeout(autosaveTimer.current);
      }, [data, step, fieldIndex, interviewIndex]);

      // Load saved
      useEffect(() => {
        try {
          const saved = localStorage.getItem(`ft_${CONFIG.TOOL_SLUG}_autosave`);
          if (saved) {
            const parsed = JSON.parse(saved);
            if (parsed.data) {
              setData(prev => ({ ...prev, ...parsed.data }));
              if (parsed.step) setStep(parsed.step);
              if (parsed.fieldIndex) setFieldIndex(parsed.fieldIndex);
              if (parsed.interviewIndex) setInterviewIndex(parsed.interviewIndex);
            }
          }
        } catch (e) { console.warn('Failed to restore auto-save:', e); }
      }, []);

      // Interview CRUD
      const addRound1Interview = () => setData(prev => ({ ...prev, round1Interviews: [...(prev.round1Interviews || []), { customerName: '', customerProfile: '', date: '', problemReconfirm: '', valueReaction: '', whatWorked: '', whatUnclear: '', concerns: '', theirWords: '', callToActionResponse: '' }] }));
      const removeRound1Interview = (idx) => { if ((data.round1Interviews || []).length > 1) setData(prev => ({ ...prev, round1Interviews: prev.round1Interviews.filter((_, i) => i !== idx) })); };
      const updateRound1Interview = (idx, field, value) => setData(prev => ({ ...prev, round1Interviews: prev.round1Interviews.map((iv, i) => i === idx ? { ...iv, [field]: value } : iv) }));

      const addRound2Interview = () => setData(prev => ({ ...prev, round2Interviews: [...(prev.round2Interviews || []), { customerName: '', customerProfile: '', date: '', problemStillValid: '', valueReaction: '', clarity: '', enthusiasm: '', differentiation: '', actionability: '', concerns: '', recommendation: '' }] }));
      const removeRound2Interview = (idx) => { if ((data.round2Interviews || []).length > 1) setData(prev => ({ ...prev, round2Interviews: prev.round2Interviews.filter((_, i) => i !== idx) })); };
      const updateRound2Interview = (idx, field, value) => setData(prev => ({ ...prev, round2Interviews: prev.round2Interviews.map((iv, i) => i === idx ? { ...iv, [field]: value } : iv) }));

      // AI-gated step navigation
      const handleStepNext = async (nextStepValue, stepAnswers, stepName) => {
        const userId = localStorage.getItem('ft_user_id');
        if (!userId) { setStep(nextStepValue); return; }
        setAiReviewing(true);
        try {
          const canProceed = await window.AIChallenge.reviewStep(userId, CONFIG.TOOL_SLUG, stepAnswers, stepName);
          if (canProceed) { setAiMessage(''); setStep(nextStepValue); }
          else { setAiMessage(window.AIChallenge?.getLastFeedback?.()?.suggestion || 'Please expand your answer before continuing.'); }
        } catch (err) { console.warn('[AIChallenge] Error, allowing passage:', err); setAiMessage(''); setStep(nextStepValue); }
        finally { setAiReviewing(false); }
      };

      // Validation
      const canProceedStep1 = data.valuePropBeingTested.length >= 30 && data.testingObjective.length >= 30;
      const canProceedStep2 = (data.round1Interviews || []).every(i => (i.customerName || '').length >= 3 && (i.valueReaction || '').length >= 30 && (i.whatWorked || '').length >= 20);
      const canProceedStep3 = data.positivePatterns.length >= 50 && data.confusionPoints.length >= 30 && data.refinedValueProp.length >= 30;
      const canProceedStep4 = (data.round2Interviews || []).every(i => (i.customerName || '').length >= 3 && (i.clarity || '').length > 0 && (i.enthusiasm || '').length > 0);
      const yesCount = Object.values(data.validation || {}).filter(v => v === 'yes').length;
      const canProceedStep5 = yesCount >= 5 && (data.finalValueProp || '').length >= 30;

      // Field counts per step
      const step1Total = STEP1_FIELDS.length;
      const step2Total = R1_FIELDS.length;
      const step3Total = STEP3_FIELDS.length;
      const step4Total = R2_FIELDS.length;
      const step5Total = STEP5_FIELDS.length + 1; // +1 for validation checklist

      // Navigation logic
      const getMaxField = () => {
        if (step === 1) return step1Total - 1;
        if (step === 2) return step2Total - 1;
        if (step === 3) return step3Total - 1;
        if (step === 4) return step4Total - 1;
        if (step === 5) return step5Total - 1;
        return 0;
      };

      const handleNext = () => {
        const maxField = getMaxField();

        // For interview steps, handle interview + field pagination
        if (step === 2) {
          const interviews = data.round1Interviews || [];
          if (fieldIndex < step2Total - 1) { setFieldIndex(fieldIndex + 1); return; }
          if (interviewIndex < interviews.length - 1) { setInterviewIndex(interviewIndex + 1); setFieldIndex(0); return; }
          // All interviews done, advance step
          if (!canProceedStep2) return;
          handleStepNext(step + 0.5, { customer_feedback_r1: { round1Interviews: data.round1Interviews } }, 'Round 1 Interviews');
          return;
        }
        if (step === 4) {
          const interviews = data.round2Interviews || [];
          if (fieldIndex < step4Total - 1) { setFieldIndex(fieldIndex + 1); return; }
          if (interviewIndex < interviews.length - 1) { setInterviewIndex(interviewIndex + 1); setFieldIndex(0); return; }
          if (!canProceedStep4) return;
          handleStepNext(step + 0.5, { customer_feedback_r2: { round2Interviews: data.round2Interviews } }, 'Round 2 Interviews');
          return;
        }

        // For non-interview steps, just paginate fields
        if (fieldIndex < maxField) { setFieldIndex(fieldIndex + 1); return; }

        // Last field — advance step with AI gate
        if (step === 1) {
          if (!canProceedStep1) return;
          handleStepNext(step + 0.5, { setup: { valuePropBeingTested: data.valuePropBeingTested, testingObjective: data.testingObjective, targetCustomerProfile: data.targetCustomerProfile, interviewPlan: data.interviewPlan } }, 'Setup');
        } else if (step === 3) {
          if (!canProceedStep3) return;
          handleStepNext(step + 0.5, { comparison_results: { round1Patterns: data.round1Patterns, positivePatterns: data.positivePatterns, confusionPoints: data.confusionPoints, objections: data.objections, refinedValueProp: data.refinedValueProp, changesJustification: data.changesJustification } }, 'Refinement');
        } else if (step === 5) {
          if (!canProceedStep5) return;
          handleStepNext(step + 0.5, { final_vp: { finalValueProp: data.finalValueProp }, reality_log: { validation: data.validation, consistentReactions: data.consistentReactions, strongestDifferentiator: data.strongestDifferentiator }, next_steps: { remainingAdjustments: data.remainingAdjustments, rolloutPlan: data.rolloutPlan } }, 'Final Decision');
        }
      };

      const handleBack = () => {
        // For interview steps, go back through fields then interviews
        if (step === 2 || step === 4) {
          if (fieldIndex > 0) { setFieldIndex(fieldIndex - 1); return; }
          if (interviewIndex > 0) {
            setInterviewIndex(interviewIndex - 1);
            setFieldIndex(step === 2 ? step2Total - 1 : step4Total - 1);
            return;
          }
          setStep(step === 2 ? 1 : 3);
          return;
        }

        if (fieldIndex > 0) { setFieldIndex(fieldIndex - 1); return; }
        if (step === 1) setStep(0.5);
        else setStep(step - 1);
      };

      // Can proceed for current field (enable/disable Next)
      const canProceedField = () => {
        if (aiReviewing) return false;
        const maxField = getMaxField();
        const isLast = fieldIndex === maxField && (step !== 2 && step !== 4 || interviewIndex === (step === 2 ? data.round1Interviews : data.round2Interviews).length - 1);

        if (isLast) {
          if (step === 1) return canProceedStep1;
          if (step === 2) return canProceedStep2;
          if (step === 3) return canProceedStep3;
          if (step === 4) return canProceedStep4;
          if (step === 5) return canProceedStep5;
        }
        return true; // intermediate fields always allow Next
      };

      const getNextLabel = () => {
        if (aiReviewing) return 'AI Coach Reviewing...';
        const maxField = getMaxField();
        const interviews = step === 2 ? data.round1Interviews : step === 4 ? data.round2Interviews : [];
        const isLastInterview = step === 2 || step === 4 ? interviewIndex === interviews.length - 1 : true;
        if (fieldIndex === maxField && isLastInterview) {
          if (step === 5) return 'View Canvas →';
          return 'Next Step →';
        }
        return 'Next →';
      };

      // PDF Export
      const exportPDF = async () => {
        try {
          if (!window.jspdf || !window.html2canvas) { alert('PDF library not loaded.'); return; }
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const canvas = document.getElementById('canvas-content');
          if (!canvas) { alert('Canvas not found.'); return; }
          const images = canvas.querySelectorAll('img');
          const states = []; images.forEach(img => { states.push({ img, display: img.style.display }); img.style.display = 'none'; });
          const canvasImg = await html2canvas(canvas, { scale: 2, logging: false, allowTaint: false, useCORS: false });
          states.forEach(({ img, display }) => { img.style.display = display; });
          const imgData = canvasImg.toDataURL('image/png');
          const w = 190, h = (canvasImg.height * w) / canvasImg.width;
          if (h <= 277) { pdf.addImage(imgData, 'PNG', 10, 10, w, h); }
          else {
            let srcY = 0;
            while (srcY < canvasImg.height) {
              const sliceH = Math.min(canvasImg.height - srcY, (canvasImg.width * 277) / w);
              const sc = document.createElement('canvas'); sc.width = canvasImg.width; sc.height = sliceH;
              sc.getContext('2d').drawImage(canvasImg, 0, srcY, canvasImg.width, sliceH, 0, 0, canvasImg.width, sliceH);
              pdf.addImage(sc.toDataURL('image/png'), 'PNG', 10, 10, w, (sliceH * w) / canvasImg.width);
              srcY += sliceH; if (srcY < canvasImg.height) pdf.addPage();
            }
          }
          pdf.save(`VP-Testing-${new Date().toISOString().split('T')[0]}.pdf`);
        } catch (err) { alert('PDF export failed: ' + err.message); }
      };

      // Submit
      const handleSubmit = async () => {
        try {
          setSubmitStatus('saving'); setSubmitMessage('');
          const userId = localStorage.getItem('ft_user_id');
          if (!userId) { setSubmitStatus('error'); setSubmitMessage('User not authenticated.'); return; }
          const questionMappings = {
            customer_feedback: { round1Interviews: data.round1Interviews, round2Interviews: data.round2Interviews },
            comparison_results: { round1Patterns: data.round1Patterns, positivePatterns: data.positivePatterns, confusionPoints: data.confusionPoints, objections: data.objections },
            reality_log: { validation: data.validation, consistentReactions: data.consistentReactions, strongestDifferentiator: data.strongestDifferentiator },
            final_vp: { finalValueProp: data.finalValueProp, refinedValueProp: data.refinedValueProp, changesJustification: data.changesJustification },
            next_steps: { remainingAdjustments: data.remainingAdjustments, rolloutPlan: data.rolloutPlan }
          };
          await window.AIChallenge.submitWithChallenge(userId, CONFIG.TOOL_SLUG, questionMappings, {
            onReviewStart: () => { setSubmitMessage('AI coach is reviewing...'); },
            onRevise: () => { setSubmitStatus(null); setSubmitMessage(''); setStep(5); setFieldIndex(1); },
            onSubmitAnyway: () => { setSubmitStatus('success'); setSubmitMessage('Value proposition testing results submitted successfully!'); },
            onError: (err) => { setSubmitStatus('error'); setSubmitMessage('Failed to save: ' + err.message); }
          });
        } catch (error) { setSubmitStatus('error'); setSubmitMessage('Submission failed: ' + error.message); }
      };

      /* ── RENDER ── */

      // Transition screens
      if ([1.5, 2.5, 3.5, 4.5, 5.5].includes(step)) {
        return window.renderTransitionScreen(step, CONFIG, 5, setStep);
      }

      return (
        <div className="tool-frame">
          <div className="tool-inner">

            {/* Cover */}
            {step === 0 && (
              <div style={{ position: 'relative', width: '100%', minHeight: '100vh', background: '#000', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', overflow: 'hidden' }}>
                <div style={{ position: 'absolute', inset: 0, backgroundImage: 'url("https://images.unsplash.com/photo-1556761175-b413da4baf72?w=1920&q=80")', backgroundSize: 'cover', backgroundPosition: 'center', opacity: 0.35 }} />
                <div style={{ position: 'relative', zIndex: 2, textAlign: 'center', padding: '0 32px', maxWidth: 800 }} className="animate-in">
                  <div className="monument" style={{ fontSize: 11, color: '#FFF469', letterSpacing: '0.15em', textTransform: 'uppercase', marginBottom: 24 }}>SPRINT 16</div>
                  <h1 className="plaak animate-in" style={{ fontSize: 'clamp(48px, 8vw, 96px)', color: '#fff', marginBottom: 24, lineHeight: 1 }}>VP TESTING</h1>
                  <p style={{ fontSize: 18, color: '#ccc', marginBottom: 48, lineHeight: 1.6 }}>Turn customer feedback into a bulletproof message</p>
                  <button onClick={() => setStep(0.5)} className="plaak animate-in"
                    style={{ background: '#FFF469', color: '#000', border: 'none', padding: '20px 56px', fontSize: 20, cursor: 'pointer' }}>
                    START →
                  </button>
                </div>
              </div>
            )}

            {/* Intro */}
            {step === 0.5 && <IntroPage onBegin={() => setStep(1)} />}

            {/* Wizard Steps 1-5 */}
            {step >= 1 && step <= 5 && Number.isInteger(step) && (
              <div className="wizard-layout">
                <div className="wizard-main">
                  <MobileStepBar currentStep={step} totalSteps={5} />
                  <div className="wizard-content animate-in">
                    {step === 1 && <><DependencyContext deps={deps} /><Step1 data={data} updateData={updateData} fieldIndex={fieldIndex} /></>}
                    {step === 2 && <Step2 data={data} updateData={updateData} addRound1Interview={addRound1Interview} removeRound1Interview={removeRound1Interview} updateRound1Interview={updateRound1Interview} interviewIndex={interviewIndex} fieldIndex={fieldIndex} />}
                    {step === 3 && <Step3 data={data} updateData={updateData} fieldIndex={fieldIndex} />}
                    {step === 4 && <Step4 data={data} updateRound2Interview={updateRound2Interview} addRound2Interview={addRound2Interview} removeRound2Interview={removeRound2Interview} interviewIndex={interviewIndex} fieldIndex={fieldIndex} />}
                    {step === 5 && <Step5 data={data} updateData={updateData} updateValidation={updateValidation} fieldIndex={fieldIndex} />}
                  </div>
                  {aiMessage && <div style={{ color: '#dc2626', fontSize: 13, padding: '8px 12px', background: '#fef2f2', margin: '0 32px 8px' }}>{aiMessage}</div>}
                  <div className="btn-footer">
                    <button className="btn-back" onClick={handleBack}>← Back</button>
                    <button className="btn-next" disabled={!canProceedField()} onClick={handleNext}>{getNextLabel()}</button>
                  </div>
                </div>
                <WizardSidebar currentStep={step} data={data} onNavigate={setStep} />
              </div>
            )}

            {/* Canvas */}
            {step === 6 && <CanvasPage data={data} onBack={() => { setStep(5); setFieldIndex(STEP5_FIELDS.length); }} onExport={exportPDF} onSubmit={handleSubmit} submitStatus={submitStatus} submitMessage={submitMessage} />}

          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<TestingApp />);
  </script>
</body>
</html>
